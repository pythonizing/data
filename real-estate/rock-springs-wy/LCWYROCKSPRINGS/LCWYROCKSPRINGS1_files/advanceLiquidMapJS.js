




/*
     FILE ARCHIVED ON 4:12:37 Jan 27, 2016 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 21:29:42 Aug 11, 2016.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
*/
var Track=(function(){this.initOffsiteLinks=function(){if(window.disableGATracking==true){return}var e;if(document.getElementsByTagName){var l=document.getElementsByTagName("a");var k=l.length;for(var d=0;d<k;d++){if(l[d].href){e=a(l[d].getAttribute("href"));if(e.length>0){if(!b(e)){var g=l[d].getAttribute("linktype");var j=l[d].className;var f=false;if(j!=null&&j.indexOf("ignoreOffsiteTitle")>-1){f=true}if(!f){var c=l[d].getAttribute("title");var h=g_internationalization.getString("You have selected a link to a website that is not owned or maintained by Century21.com. Different terms of use and privacy policies will apply.");if(c&&c.indexOf(h)<0){h+=" "+c}l[d].setAttribute("title",h)}l[d].setAttribute("target","_BLANK")}}}}}};function a(e){var d;var c;d=e.toLowerCase();c=d.indexOf("?");if(c>=0){d=d.substring(0,c)}if(d.indexOf("http")==0){c=d.indexOf("https://");if(c>=0){d=d.substring((c+8),d.length)}c=d.indexOf("http://");if(c>=0){d=d.substring((c+7),d.length)}c=d.indexOf("/");if(c>=0){d=d.substring(0,c)}}else{d=""}return d}function b(d){var c=document.location.host.toLowerCase();if(d.indexOf(".c21.com")>=0){return true}if(d=="c21.com"){return true}if(d.indexOf(".century21.com")>=0){return true}if(d=="century21.com"){return true}if(d.indexOf(".netmovein.com")>=0){return true}if(d.indexOf(".century21mortgage.com")>=0){return false}if(d==c){return true}return false}this.c21Reporting=function(g,e,f){if(window.disableGATracking==true){return}if(f.charAt(0)>="A"&&f.charAt(0)<="Z"){return}var d=document.getElementById("messagequeueiframe");if(d){var c=""+(Math.random()*10000000000000);d.src="/reporting/"+g+"?id="+f+"&type="+e+"&rnd="+c}return true};gaEventTrack=function(e,c,f,g){if(window.disableGATracking==true){return}if(window.websiteCode=="ESP"){c="ESP "+c}aEvent=["_trackEvent",e,c];if(f){aEvent.push(f)}if((g!=null&&g!="")||(g==0)){var d=/^\d+$/;if(!isNaN(g)&&d.test(g)){aEvent.push(g)}}_gaq.push(aEvent)};gaPageTrack=function(c){if(window.disableGATracking==true){return}_gaq.push(["_trackPageview",c])};this.doEvent=function(d,c,e,f){if(window.disableGATracking==true){return}gaEventTrack(d,c,e,f);c21Helpers.stopEvent()};this.doEventByPropTypeLabel=function(d,c,f){var e="";if(f!=null&&f!=""&&f!="undefined"){if(f=="REN"||f=="C21"){e=f}else{e="sister"}}if(e!=""){Track.doEvent(d,c,e)}else{Track.doEvent(d,c)}};this.doTracking=function(c){if(window.disableGATracking==true){return}switch(c){default:gaPageTrack("/conversions/"+c);break}};return this}());$(document).ready(function(){Track.initOffsiteLinks()});window.VerticalChart=function(m){var n;var k;var i;var h;var f;var e;var j;var c;var l;var o=this;var b="";var a=null;this.setNoDataText=function(p){a=p};this.setBarLabelPostFix=function(p){b=p};this.setMargin=function(p){i=p};this.setBarWidth=function(p){h=p};this.setMinMaxHeight=function(q,p){f=q;e=p};this.setMinValue=function(p){j=p};this.setMinMaxValue=function(q,p){j=q;c=p};this.setBarSameHeight=function(p){l=p};this.resetData=function(){m.html("");n=[];k=[];o.setMargin(5);o.setBarWidth(0);o.setMinMaxValue(0,0)};var g=function(){var q,r,p=this;p.setTitle=function(s){q=s};p.setValue=function(s){r=s};p.getValue=function(){return r};p.getElementFromIndex=function(B){var y=(r-j)/(c-j),A=(i+(B*h)),D=((e-f)*y)+f,x="#FADE3E",u="#EEB111",t=$('<p class="title" />').html(q),v=$('<p class="value" />').html(r+b),s=$('<li class="bar" />').css({backgroundColor:(l)?"#ffecae":x,left:A,height:(l)?e:f}).append(t).append(v),z=(l)?$('<div class="barAnim" />').css({height:f}):s,w=800,E=s.getGradientAtPercent("backgroundColor",u,y);var C={height:Math.round(D).toString()+"px",backgroundColor:E};if(l){s.append(z)}z.css(C);return s}};var d=function(){var q,p=this;p.setValue=function(r){q=r};p.getValue=function(){return q};p.getElement=function(){var s=(q-j)/(c-j),r=((e-f)*s)+f,t=$('<li class="bar"><p class="title"></p><p class="value"></p></li>').css({backgroundColor:"transparent",left:0,height:Math.round(r.toString())+"px"});t.find(".value").append($('<div class="line chartWidth"></div>'));return t}};this.addBar=function(p,r){var q=new g();q.setTitle(p);q.setValue(r);n.push(q)};this.addLine=function(p){var q=new d();q.setValue(p);k.push(q)};this.autoAdjustViewport=function(){var p=n.concat(k);j=p[0].getValue();c=j;$.each(p.slice(1),function(t,s){var u=s.getValue();if(u<j){j=u}else{if(u>c){c=u}}});var q=m.width(),r=(q-i)/n.length;o.setBarWidth(r)};this.renderBars=function(){if(a!==null){m.append("<div class='NoDataText' style='position:relative;top:50%;text-align:center;'>"+a+"</div>");return}else{m.remove(".NoDataText")}var p,q;$.each(n,function(s,r){q=r.getElementFromIndex(s);m.append(q)});$.each(k,function(r,s){q=s.getElement();m.append(q)});m.find("li.bar, p.title, p.value").css({width:(h-i).toString()+"px"})};this.resetData()};window.ChartMaster=(function(){var c;function b(f,e,d){if(e===undefined){f.each(function(i,k){var h=$(k),j=h.parent(),g=j.find(".nearbyNumber"),l=parseInt(g.html().replace(/,/g,""));if(i==0){e=0;d=l}else{if(d<l){d=l}}})}f.each(function(n,j){var r=$(j),h=r.parent(),i=h.find(".nearbyNumber"),l=i.parent(),m=(parseInt(i.html().replace(/,/g,""))-e)/d,p=170,q=5,k=800,g=((p-q)*m)+q,o={width:Math.round(g).toString()+"px"};r.width(0);r.css(o)})}function a(d){return d.replace(/(\d)(?=(\d{3})+$)/g,"$1,")}return{initialize:function(){if(c){$("#ei01").parent().find(".nearbyNumber").html(a(c.dwlvacnt));$("#ei02").parent().find(".nearbyNumber").html(a(c.dwlowned));$("#ei03").parent().find(".nearbyNumber").html(a(c.dwlrent));var j=parseInt(c.trwself);var f=parseInt(c.trwhome);var l=parseInt(c.trwpublic);var g=parseInt(c.trwdrive);var i=parseInt(c.trwcpool);var e=parseInt(c.trwmoto);var k=parseInt(c.trwbyc);var d=parseInt(c.trwother);var o=j+f+l+g+i+e+k+d;l=(l/o)*100;f=(f/o)*100;g=((g+i+e)/o)*100;j=((k+j+d)/o)*100;$("#bc01").parent().find(".nearbyNumber").html(g.toFixed(0)+"%");$("#bc02").parent().find(".nearbyNumber").html(l.toFixed(0)+"%");$("#bc03").parent().find(".nearbyNumber").html(j.toFixed(0)+"%");$("#bc04").parent().find(".nearbyNumber").html(f.toFixed(0)+"%");var n=(parseInt(c.popmale)+parseInt(c.popfemale));var m=(c.popmale/n)*100;var h=(c.popfemale/n)*100;if($("#mf01")){$("#mf01").parent().find(".nearbyNumber").html(m.toFixed(2)+"%");$("#mf02").parent().find(".nearbyNumber").html(h.toFixed(2)+"%")}if($("#co01")){$("#co01").parent().find(".nearbyNumber").html(c.occwhtco+"%");$("#co02").parent().find(".nearbyNumber").html(c.occbluco+"%")}b($("#ei01, #ei02, #ei03"));b($("#bc01, #bc02, #bc03, #bc04"),0,100);if($("#mf01")){b($("#mf01, #mf02"))}if($("#co01")){b($("#co01, #co02"))}LocalAreaDataChart.initialize(c);LocalAreaIndexChart.initialize(c);CrimeChart.initialize(c);$(window).scroll()}},setData:function(d){c=d}}}());window.WeatherChart=function(a,k,c,g){if(a===undefined){var d=new WeatherChart();return}var j=new VerticalChart(a);var e=null;var l=function(s,q){j.resetData();j.addBar("Jan",q(s.jan));j.addBar("Feb",q(s.feb));j.addBar("Mar",q(s.mar));j.addBar("Apr",q(s.apr));j.addBar("May",q(s.may));j.addBar("Jun",q(s.jun));j.addBar("Jul",q(s.jul));j.addBar("Aug",q(s.aug));j.addBar("Sep",q(s.sep));j.addBar("Oct",q(s.oct));j.addBar("Nov",q(s.nov));j.addBar("Dec",q(s.dec));var m=false;var n=null;for(var r in s){if(n===null){n=s[r]}if(n!==s[r]){m=true}}if(m===false){j.setNoDataText("No Data Available")}else{j.setNoDataText(null)}j.autoAdjustViewport();j.renderBars()};var f=function(){j.setBarLabelPostFix("&deg;");l(e.high,parseInt);c.html("(in Degrees Fahrenheit)")};var h=function(){j.setBarLabelPostFix("&deg;");l(e.low,parseInt);c.html("(in Degrees Fahrenheit)")};var i=function(){j.setBarLabelPostFix('"');l(e.precipitation,function(m){return parseFloat(parseFloat(m).toFixed(2))});c.html("(in Inches)")};var b=function(){j.setBarLabelPostFix("%");l(e.relative_humidity,parseInt);c.html("(in Saturation Percentage)")};k.change(function(){switch($(this).val()){case"high":f();break;case"low":h();break;case"precipitation":i();break;case"relative_humidity":b();break;default:alert($(this).val()+" is not a valid chart type.")}});this.setData=function(m){e=m;g.html("Weather Data Source: "+e.source_name)};this.showChartTemperatureHigh=f;this.showChartTemperatureLow=h;this.showChartPrecipitation=i;this.showChartRelativeHumidity=b;j.setMinMaxHeight(5,120)};window.CrimeChart=(function(){var c,a;function d(h){var g=c[h],f=parseInt(g);return f}function b(f,g){a.addBar(f,d(g))}function e(){a.resetData();a.addLine(100);b("Total","crmcytotc");b("Personal","crmcyperc");b("Murder","crmcymurd");b("Rape","crmcyrape");b("Robbery","crmcyrobb");b("Assault","crmcyasst");b("Property","crmcyproc");b("Burglary","crmcyburg");b("Larceny","crmcylarc");b("Vehicle Theft","crmcymveh");a.autoAdjustViewport();a.setMinValue(0);a.renderBars()}return{initialize:function(f){c=f;a=new VerticalChart($("#crimeChart"));a.setMinMaxHeight(5,120);e()}}}());window.LocalAreaIndexChart=(function(){var d,i,f,g;function h(m){g.html(m)}function c(o){var n=d[o],m=parseInt(n);return m}function l(m,n){i.addBar(m,c(n))}function k(){h("");i.resetData();i.addLine(100);l("Total","crmcytotc");l("Personal","crmcyperc");l("Murder","crmcymurd");l("Rape","crmcyrape");l("Robbery","crmcyrobb");l("Assault","crmcyasst");l("Property","crmcyproc");l("Burglary","crmcyburg");l("Larceny","crmcylarc");l("Vehicle Theft","crmcymveh");i.autoAdjustViewport();i.renderBars()}function a(){h("");i.resetData();i.addLine(100);l("Total","idxexptotal");l("Insurance","expinsur");l("Apparel","expappar");l("Education","expeduc");l("Entertainment","expent");l("Food","expfoodbev");l("Healthcare","exphealth");l("Housing","exphh");l("Transportation","exptransport");l("Utilities","exputil");i.autoAdjustViewport();i.renderBars()}function e(){h("");i.resetData();i.addLine(100);l("Earthquake","rskcyquak");l("Total Weather","rskcyrisk");l("Hail","rskcyhanx");l("Hurricane","rskcyhunx");l("Tornado","rskcytonx");l("Wind","rskcywinx");i.autoAdjustViewport();i.renderBars()}function b(){h("");i.resetData();i.addLine(100);l("Air","airx");l("Ozone","ozone");l("Carbon Monoxide","carbmono");l("Lead","lead");l("NO<sub>2</sub>","no2");l("Particulates(PM10)","pm10");i.autoAdjustViewport();i.renderBars()}function j(){var m=f.val();if(m=="crime"){k()}else{if(m=="expenses"){a()}else{if(m=="disasters"){e()}else{if(m=="pollution"){b()}}}}}return{initialize:function(m){d=m;g=$("#localAreaIndexSubLabel");f=$("#localAreaIndexSelect");f.change(j);i=new VerticalChart($("#localAreaIndexChart"));i.setMinMaxHeight(5,120);j()}}}());window.LocalAreaDataChart=(function(){var e,k,f,i;function j(q){i.html(q)}function d(s){var r=e[s],q=parseInt(r);return q}function o(q,r){k.addBar(q,d(r))}function n(){j("");k.resetData();o("0-4","age00_04");o("5-9","age05_09");o("10-14","age10_14");o("15-19","age15_19");o("20-24","age20_24");o("25-29","age25_29");o("30-34","age30_34");o("35-39","age35_39");o("40-44","age40_44");o("45-49","age45_49");o("50-54","age50_54");o("55-59","age55_59");o("60-64","age60_64");o("65-69","age65_69");o("70-74","age70_74");o("75-79","age75_79");o("80-84","age80_84");o("85+","agegt85");k.autoAdjustViewport();k.renderBars()}function g(){j("&nbsp;(in thousands of dollars)");k.resetData();k.setMargin(1);o("0-10","hincy00_10");o("10-15","hincy10_15");o("15-20","hincy15_20");o("20-25","hincy20_25");o("25-30","hincy25_30");o("30-35","hincy30_35");o("35-40","hincy35_40");o("40-45","hincy40_45");o("45-50","hincy45_50");o("50-60","hincy50_60");o("60-75","hincy60_75");o("75-100","hincy75_100");o("100-125","hincy100_125");o("125-150","hincy125_150");o("150-200","hincy150_200");o("200-250","hincy200_250");o("250-500","hincy250_500");o("500+","hincygt_500");k.autoAdjustViewport();k.renderBars()}function p(){j("");k.resetData();o("Less than 9th Grade","edultgr9");o("Some High School","edushsch");o("Some College","eduscoll");o("Associates Degree","eduassoc");o("Bachelors Degree","edubach");o("Graduate","edugrad");k.autoAdjustViewport();k.renderBars()}function b(){j("");k.resetData();o("White","racewhite");o("Hispanic","hisp");o("Black","raceblack");o("Asian","raceasian");o("Native American","raceamerind");o("Hawian","racehawai");o("Other","raceother");k.autoAdjustViewport();k.renderBars()}function c(){j("");k.resetData();o("< 25","aimcylt_25");o("25 - 44","aimcy25_44");o("45 - 64","aimcy45_64");o("> 65","aimcygt_65");k.autoAdjustViewport();k.renderBars()}function a(){j("");k.resetData();o("Management","occyexec");o("Construction","occcons");o("Protective Services","occprot");o("Agriculture","occprim");o("Transportation","occmater");o("Labor","occlabor");o("Education","occeduc");o("Food","occfood");o("Computer","occcomp");o("Arts","occarts");o("Legal","occlegal");k.autoAdjustViewport();k.renderBars()}function h(){j("");k.resetData();o("Agriculture","empagric");o("Mining","empmine");o("Construction","empconst");o("Manufacturing","empmanuf");o("Transportation","emptrans");o("Wholesale","empwtrad");o("Retail","emprtrad");o("Finance & Real Estate","empfire");o("Service","empsrv");o("Public","emppubad");k.autoAdjustViewport();k.renderBars()}function m(){j("(in dollars) Estimate includes shelter + utilities");k.resetData();o("Studio","studio_county");o("1 Bedroom","one_bed_county");o("2 Bedroom","two_bed_county");o("3 Bedroom","three_bed_county");o("4 Bedroom","four_bed_county");k.autoAdjustViewport();k.renderBars()}function l(){var q=f.val();if(q=="age"){n()}else{if(q=="ethnicity"){b()}else{if(q=="education"){p()}else{if(q=="income"){g()}else{if(q=="inc_age"){c()}else{if(q=="emp_occ"){a()}else{if(q=="emp_ind"){h()}else{if(q=="rent"){m()}}}}}}}}}return{initialize:function(q){e=q;i=$("#localAreaDataSubLabel");f=$("#localAreaDataSelect");f.change(l);k=new VerticalChart($("#localAreaChart"));k.setMinMaxHeight(5,120);l()}}}());window.GreatSchoolsData=(function(){var d,f,e,g,c;function b(){if(f){m_jShowMoreSchools.html(c);g.animate({opacity:0},function(){$(this).slideUp(function(){});f=false})}else{m_jShowMoreSchools.hide();m_jShowFewerSchools.show();g.slideDown(function(){$(this).animate({opacity:1});f=true})}}function a(){d=$("#schoolDataBody tr");if(d.length>5){g=d.slice(5);g.hide();g.css({opacity:0});m_jShowMoreSchools=$("#showMoreSchools");m_jShowFewerSchools=$("#showFewerSchools");c=m_jShowMoreSchools.html();m_jShowMoreSchools.parent().show();m_jShowMoreSchools.click(function(){$(this).hide();m_jShowFewerSchools.show();var h="";if($("#TRACKING_PROPERTY_ID").val()!=null&&$("#TRACKING_PROPERTY_ID").val()!=""){h="PDP Hybrid Page"}else{h="Local Area Page"}Track.doEvent("Schools",h,"Show all onboard schools");b();return false});m_jShowFewerSchools.click(function(){$(this).hide();m_jShowMoreSchools.show();var h="";if($("#TRACKING_PROPERTY_ID").val()!=null&&$("#TRACKING_PROPERTY_ID").val()!=""){h="PDP Hybrid Page"}else{h="Local Area Page"}Track.doEvent("Schools",h,"Show fewer onboard schools");b();return false})}}return{initialize:a}}());var portalResults=(function(){var j=function(t,s){Track.doEvent("Hybrid Mapping","Property Refine","Refine and Update Price")},i=function(t,s){Track.doEvent("Hybrid Mapping","Property Refine","Refine and Update Beds")},a=function(t,s){Track.doEvent("Hybrid Mapping","Property Refine","Refine and Update Baths")},p=function(t,s){Track.doEvent("Hybrid Mapping","Property Refine","Refine and Update Square Footage")};function d(s,t){switch(t){case"ContactSA":case"ContactOff":listHub.doTrackingC21(s,"QUESTION");break;case"Detail":listHub.doTrackingC21(s,"VIEWED_ON_CHANNEL");break;case"Dir":listHub.doTrackingC21(s,"DRIVING_DIRECTIONS_CLICKED");break;case"RetSearch":listHub.doTrackingC21(s,"SEARCH_DISPLAY");break;case"Saved":listHub.doTrackingC21(s,"LISTING_SAVED");break;case"Virtual":listHub.doTrackingC21(s,"VIRTUAL_TOUR_CLICKED");break;case"Slides":listHub.doTrackingC21(s,"SLIDESHOW_CLICKED");break;case"Floor":listHub.doTrackingC21(s,"FLOORPLANS_CLICKED");break;case"Email":listHub.doTrackingC21(s,"SHARED");break;case"PropPrinted":listHub.doTrackingC21(s,"PRINT_MEDIA_CLICKED");break}}function n(s,t){switch(t){case"ContactSA":case"ContactOff":listHub.doTracking(s,"QUESTION");break;case"Detail":listHub.doTracking(s,"VIEWED_ON_CHANNEL");break;case"Dir":listHub.doTracking(s,"DRIVING_DIRECTIONS_CLICKED");break;case"RetSearch":listHub.doTracking(s,"SEARCH_DISPLAY");break;case"Saved":listHub.doTracking(s,"LISTING_SAVED");break;case"Virtual":listHub.doTracking(s,"VIRTUAL_TOUR_CLICKED");break;case"Slides":listHub.doTracking(s,"SLIDESHOW_CLICKED");break;case"Floor":listHub.doTracking(s,"FLOORPLANS_CLICKED");break;case"Email":listHub.doTracking(s,"SHARED");break;case"PropPrinted":listHub.doTracking(s,"PRINT_MEDIA_CLICKED");break}}function f(s,t,v){var u=s;if(s.indexOf("CBR")<0&&s.indexOf("ERA")<0&&s.indexOf("LCE")<0){s=s.replace("C21","");portalAjax.report({url:"/reporting/listing",data:"id="+s+"&type="+t});if(u.indexOf("C21")>=0){d(v,t)}else{n(v,t)}}}function k(s,t){portalAjax.report({url:"/reporting/agent",data:"id="+s+"&type="+t})}function o(s,t){portalAjax.report({url:"/reporting/office",data:"id="+s+"&type="+t})}function b(t,s){var u={t:s};if(t.l){u.l=t.l}if(t.lid){u.lid=t.lid}if(s!=1&&t.of){u.of=t.of}return u}function r(){$("#searchNavTop").hide();$("#searchNavBottom").hide();$("#innerContent").css("background-color","#ebebeb")}function q(){$("#searchNavTop").show();$("#searchNavBottom").show()}function e(s){if(!$("body").hasClass("liquidLayout")){var t=portalAjax.getParameters(),v=$.param({lid:t.lid}),s={loadingIndicator:new LoadingIndicator("#refineSearch")};portalAjax.doViewEngineAjax("listview","/surroundingAreas.c21",v,s)}else{var u=portalAjax.getParameters();u.submitted=true;u.v=3;var v=$.param(u);s=$.extend({cache:true,loadingIndicator:new LoadingIndicator("#refineSearch")},s);portalAjax.doViewEngineAjax("defaultview","/surroundingAreas.c21",v,s)}}function c(s,t,v){var x=new PortalParams();x.remove("sr");x.remove("sa");if(s&&s>0){x.set("sr",s)}else{if(t){var w="";for(var u=0;u<t.length;u++){if(w.length>0){w+=c21Helpers.GS}w+=t[u]}x.set("sa",w)}}portalResults.doPortalResults(x.get(),(v)?"searchView.Refine":undefined);return false}function m(x,s,u){var w=new PortalParams();w.remove("sl");w.remove("sn");w.remove("sk");w.remove("s");if(s&&s>0){w.set("sn",s)}if(x){var v="";for(var t=0;t<x.length;t++){if(v.length>0){v+=c21Helpers.GS}v+=x[t]}w.set("sl",v)}if(u!=null&&u!=""){w.set("sk",u)}portalResults.doPortalResults(w.get(),"searchView.Refine");return false}function l(s){var t=portalAjax.getParameters();t.v=s;portalResults.doPortalResults(t,"searchView.Paginate");return false}function h(s){return s.toFixed(5).toString()}function g(){var s=$("#searchNavTop .TitleColspan");s.css({zIndex:1})}$(document).ready(g);return{setView:l,changeSurroundingAreas:c,changeSchools:m,lazyLoadSurroundingAreas:e,showNavBars:q,hideNavBars:r,trackListing:f,trackAgent:k,trackOffice:o,clearLiquidMapFacets:function(){var s=new PortalParams();$.each(s.get(),function(u,v){switch(u){case"t":case"l":case"lid":case"of":case"ag":case"te":case"h":case"o":case"r":case"feed":case"officekey":break;default:s.remove(u);break}});schoolSearch.removeAllSchools();if($("#surroundingAreasLiqMap").hasClass("selected")){surroundingAreasMapping.clearSurroundingAreas();surroundingAreasMapping.closeWindow()}var t=s.get();t.v=3;Track.doEvent("Hybrid Mapping","Left Lane","Clear all search criteria");portalResults.doPortalResults(t);return false},clearAllFacets:function(){var s=new PortalParams();$.each(s.get(),function(u,v){switch(u){case"t":case"q":case"l":case"lid":case"of":case"ag":case"te":case"h":break;default:s.remove(u);break}});var t=s.get();t.v=0;portalResults.doPortalResults(t);return false},setPage:function(w,t){var x=portalAjax.getParameters();var v=$("#rppActual").html();x.s=(v*(w-1));if($("body").hasClass("liquidLayout")){if(t!=false){var s="Center Lane";var u=$("#lqSearchType").val();if(u=="PROPERTIES"){Track.doEvent("Hybrid Mapping","Property "+s,"Paginate",parseInt(w))}else{if(u=="AGENTS"){Track.doEvent("Hybrid Mapping","Agent "+s,"Paginate",parseInt(w))}else{if(u=="OFFICES"){Track.doEvent("Hybrid Mapping","Office "+s,"Paginate",parseInt(w))}}}}}else{if($("#PageBody").hasClass("locationSearchLayout")){w=w+"";Track.doEvent("Location Search Results","Paginate",w)}}portalResults.doPortalResults(x,"searchView.Paginate");return false},createResultsPage:function(v,t,s,u){SearchNavExtension.refreshNavigation(v,t,s);if(u){$(document.body).attr("id",u)}$(".collapse").each(function(){new Collapsasaurus($(this),1,{onBeforeExpand:function(y){var w=y.parents(".listDetails").find(".agentLink"),x=w.attr("href");window.location=x+"&xp=1";return false}})})},resizeResults:function(){},resizeHandoff:function(t){var s=$("#handoffFrame");s.height(t)},swapToLocation:function(t,s){var u=new PortalParams().get();u.l=t;u.lid=s;portalResults.doPortalResults(u);return false},swapToAgents:function(t,v){var s=new PortalParams().get();var u=b(s,2);if(t&&t.length>0){delete u.lid;u.of=t}u.v=0;if(v&&v.length>0){u.q=v;if(window.websiteCode=="ESP"){document.location="/busqueda-inmobiliaria/?"+$.param(u)}else{document.location="/agent-name-search/?"+$.param(u)}}else{document.location="/search.c21?"+$.param(u)}return false},swapToOffices:function(s){var t=new PortalParams().get();var u=b(t,1);u.v=0;if(s&&s.length>0){u.q=s;if(window.websiteCode=="ESP"){document.location="/busqueda-oficinas/?"+$.param(u)}else{document.location="/office-name-search/?"+$.param(u)}}else{document.location="/search.c21?"+$.param(u)}return false},swapToProperties:function(s,t){console.log("swapToProperties");var u=new PortalParams().get();var v=b(u,0);v.v=0;if(s&&s.length>0){v.q=s;if(window.websiteCode=="ESP"){document.location="/mls-busqueda/?"+$.param(v)}else{document.location="/mls-address-search/?"+$.param(v)}}else{if((v.lid==null||v.lid=="")&&(t&&t.length>0)){v.lid=t}document.location="/search.c21?"+$.param(v)}return false},removeFacet:function(t){var s=new PortalParams();s.removeParam(t);if($("body").hasClass("liquidLayout")){Track.doEvent("Hybrid Mapping","Left Lane","Remove Search Criteria")}portalResults.doPortalResults(s.getParams(),"searchView.Refine");return false},removeListFacet:function(x,u){var w=new PortalParams();var s=w.getParam(x).split(c21Helpers.GS);var v="";for(var t=0;t<s.length;t++){if(s[t]!=u){if(v.length>0){v+=c21Helpers.GS}v+=s[t]}}if(v==""){w.removeParam(x)}else{w.setParam(x,v)}if($("body").hasClass("liquidLayout")){Track.doEvent("Hybrid Mapping","Left Lane","Remove Search Criteria")}if($("body").hasClass("liquidLayout")&&x=="sa"){if($("#surroundingAreasLiqMap").hasClass("selected")){surroundingAreasMapping.removeAreaFromAllSearchTypes(u);surroundingAreasMapping.closeWindow()}else{portalResults.doPortalResults(w.getParams(),"searchView.Refine")}}else{portalResults.doPortalResults(w.getParams(),"searchView.Refine")}return false},addListFacet:function(v,s){var u=new PortalParams();var t=u.get(v);if("undefined"==typeof t||(t.length>0&&t[0]==c21Helpers.NULL)){t=s}else{t+=(c21Helpers.GS+s)}u.set(v,t);u.removeParam("s");if($("body").hasClass("liquidLayout")&&v=="sp"){Track.doEvent("Hybrid Mapping","Office Refine","Refine and Update Market Speciality")}portalResults.doPortalResults(u.getParams(),"searchView.Refine");return false},addFacet:function(u,s){var t=new PortalParams();t.setParam(u,s);t.removeParam("s");portalResults.doPortalResults(t.getParams(),"searchView.Refine");return false},gaTrackRefinement:function(t,s){if(t!=null&&t!=""&&s!=null&&s!=""){Track.doEvent(t,"Refinement Clicked",s)}},changeSearchLocationByValue:function(t){var u=new PortalParams();if(!c21Helpers.nullSafeStrEquals(t,u.l)){if(!c21Helpers.nullSafeStrEquals(null,t)){u.setParam("l",t)}else{var t=$.trim($("#searchText").val());if(c21Helpers.nullSafeStrEquals(null,t)){return}u.setParam("l",t)}if($("body").hasClass("liquidLayout")){var s=portalResults.getMapBoundaries();u.setParam("px",s);u.remove("sl");u.remove("sn");u.remove("sk");u.remove("sa")}u.setParam("c",1);u.removeParam("s");portalResults.doPortalResults(u.getParams())}},changeSearchLocation:function(t){var s=$.trim(t.val());return portalResults.changeSearchLocationByValue(s)},changeSearchName:function(v,t){if(!t){t="na"}var u=$.trim(v.val());var w=new PortalParams();w.removeParam("s");if(!c21Helpers.nullSafeStrEquals(u,w.getParam(t))){w.removeParam(t);if(!c21Helpers.nullSafeStrEquals(null,u)){w.setParam(t,u)}if($("body").hasClass("liquidLayout")){var s=portalResults.getMapBoundaries();w.setParam("px",s)}portalResults.doPortalResults(w.getParams(),"searchView.Refine")}},stripNull:function(t){for(var s in t){if(t[s]===null){delete t[s]}if(t[s]===""){delete t[s]}if(t[s]===c21Helpers.GS2){delete t[s]}}return t},updateLiquidFacets:function(){var v=new PortalParams(),z=portalResults.getMapBoundaries(),w=$("#lqMinPriceHidden").val(),E=$("#lqMaxPriceHidden").val(),D=$("#lqbedroomsFrom").val(),t=$("#lqbedroomsTo").val(),s=$("#lqbathroomsFrom").val(),x=$("#lqbathroomsTo").val(),B=$("#lqstructureSizeFrom").val(),F=$("#lqstructureSizeTo").val(),A={s:null,pr:w+c21Helpers.GS2+E,be:D+c21Helpers.GS2+t,ba:s+c21Helpers.GS2+x,sf:B+c21Helpers.GS2+F,px:z},y=v.getParams(),u=$.extend({},y,A),C=portalResults.stripNull(u);if(y.pr!=C.pr){j(w,E)}if(y.be!=C.be){i(D,t)}if(y.ba!=C.ba){a(s,x)}if(y.sf!=C.sf){p(B,F)}portalResults.doPortalResults(C,"searchView.Refine")},changePriceFacet:function(v){var w=new PortalParams(),u=$("#lowPrice").val(),s=$("#highPrice").val(),t=u+c21Helpers.GS2+s;if(t==c21Helpers.GS2){t=""}if(!c21Helpers.nullSafeStrEquals(t,w.getParam("pr"))){if(!c21Helpers.nullSafeStrEquals(null,t)){w.setParam("pr",t)}else{w.removeParam("pr")}w.removeParam("s");portalResults.doPortalResults(w.getParams(),"searchView.Refine")}},getMapBoundaries:function(t){var s=(t||window.g_pageLiquidLayout.getMap().getBounds()),x=h(parseFloat(s.mx)),v=h(parseFloat(s.my)),w=h(parseFloat(s.xx)),u=h(parseFloat(s.xy));return[x,v,w,u].join(",")},changeMorePropertySearchOptions:function(t,u){var s=portalResults.getMapBoundaries();u.setParam("px",s);u.removeParam("s");portalResults.doPortalResults(u.getParams(),"searchView.Refine")},removePropertySpecificParams:function(s){s.removeParam("o");s.removeParam("ba");s.removeParam("be");s.removeParam("sf");s.removeParam("sr");s.removeParam("pr");s.removeParam("mn");s.removeParam("of");s.removeParam("te");s.removeParam("ag");s.removeParam("co");s.removeParam("sp");s.removeParam("fe");s.removeParam("ty");s.removeParam("oh");s.removeParam("pt");s.removeParam("rr");s.removeParam("rl");s.removeParam("fo");s.removeParam("ac");s.removeParam("yb");s.removeParam("q");s.removeParam("sm");return s},removeAgentSpecificParams:function(s){s.removeParam("o");s.removeParam("of");s.removeParam("la");s.removeParam("na");s.removeParam("sr");s.removeParam("sm");return s},removeOfficeSpecificParams:function(s){s.removeParam("o");s.removeParam("sp");s.removeParam("la");s.removeParam("na");s.removeParam("sr");s.removeParam("sm");return s},switchLiquidMappingToPropertyType:function(t){var u=new PortalParams(),s=portalResults.getMapBoundaries();u.setParam("px",s);u.setParam("t",0);u.setParam("s",0);u=portalResults.removeAgentSpecificParams(u);u=portalResults.removeOfficeSpecificParams(u);portalResults.doPortalResults(u.getParams(),"searchView.AllSubView")},switchLiquidMappingToAgentType:function(t){var u=new PortalParams(),s=portalResults.getMapBoundaries();u.setParam("px",s);u.setParam("t",2);u.setParam("s",0);u=portalResults.removePropertySpecificParams(u);u=portalResults.removeOfficeSpecificParams(u);portalResults.doPortalResults(u.getParams(),"searchView.AllSubView")},switchLiquidMappingToOfficeType:function(t){var u=new PortalParams(),s=portalResults.getMapBoundaries();u.setParam("px",s);u.setParam("t",1);u.setParam("s",0);u=portalResults.removePropertySpecificParams(u);u=portalResults.removeAgentSpecificParams(u);portalResults.doPortalResults(u.getParams(),"searchView.AllSubView")},changeLiquidMapSearchWithinMapFacet:function(t){var u=new PortalParams(),s=portalResults.getMapBoundaries();if(!c21Helpers.nullSafeStrEquals(null,s)){u.setParam("px",s);u.setParam("sm",true)}else{u.removeParam("sm")}if(t!=true){u.removeParam("s")}u.removeParam("sl");u.removeParam("sn");u.removeParam("sk");u.removeParam("sa");portalResults.doPortalResults(u.getParams(),"searchView.Refine")},removeLiquidMapSearchWithinMapFacet:function(t){var v=new PortalParams();v.removeParam("sm");v.removeParam("sa");var s=surroundingAreasMapping.getSelectedSurroundingAreas();if(s.length!=0){var u=s.join(c21Helpers.GS);v.setParam("sa",u)}portalResults.doPortalResults(v.getParams(),"searchView.Refine");return false},changeLiquidMapDrawingToolFacet:function(u,t){var x=new PortalParams(),s=portalResults.getMapBoundaries(),w=[];$.each(t,function(z,y){var A=h(y);w.push(A)});var v=w.join(",");x.removeParam("sl");x.removeParam("sn");x.removeParam("sk");x.removeParam("sa");if(!c21Helpers.nullSafeStrEquals(v,x.getParam("dt"))){if(!c21Helpers.nullSafeStrEquals(null,v)){x.setParam("px",s);x.setParam("dt",v)}else{x.removeParam("dt")}x.removeParam("s");x.removeParam("sm");portalResults.doPortalResults(x.getParams(),"searchView.Refine")}},removeLiquidMapDrawingToolFacet:function(t){var v=new PortalParams();v.removeParam("dt");v.removeParam("sa");var s=surroundingAreasMapping.getSelectedSurroundingAreas();if(s.length!=0){var u=s.join(c21Helpers.GS);v.setParam("sa",u)}portalResults.doPortalResults(v.getParams(),"searchView.Refine");return false},loadMoreSearchOptions:function(s){var t=portalAjax.getParameters();t.submitted=true;portalAjax.doViewEngineAjax("SearchMoreOptions","/moresearchoptions.c21",$.param(t),{cache:true})},loadLanguageSearchOptions:function(s){var t=portalAjax.getParameters();t.submitted=true;portalAjax.doViewEngineAjax("SearchLanguageOptions","/moresearchoptions.c21",$.param(t),{cache:true})},changeMoreLanguageSearchOptions:function(t,u){var s=portalResults.getMapBoundaries();u.setParam("px",s);u.removeParam("s");portalResults.doPortalResults(u.getParams(),"searchView.Refine")},getAgentSearchListForOffice:function(s,t,v){var u=portalAjax.getParameters();u.of=t;portalAjax.doViewEngineAjax("AgentsSearchOverlay","/agentsearch.c21",$.param(u),{cache:true,callback:v})},handleHash:function(s){portalResults.doPortalResults(portalAjax.getParameters())},doPortalResults:function(w,u){var s,t,v;if(window.websiteCode=="IDX"){w.reqid=$("#idxRequestID").val();w.reqts=$("#idxRequestTS").val();w.prevSort=$("#prevSort").val()}switch(u){case"searchView.Paginate":if(!$("body").hasClass("liquidLayout")){portalAjax.scrollToTop()}s=$("#BodyCenterLane");break;case undefined:s=$("#BodyLeftLane, #BodyCenterLane, #BodyRightLane, #BodyTopHeader");break;case"searchView.Refine":if(!$("body").hasClass("liquidLayout")){portalAjax.scrollToTop()}else{g_pageLiquidLayout.getMap().resetFirstViewLoad()}default:if($("body").hasClass("liquidLayout")){if(g_pageLiquidLayout&&g_pageLiquidLayout.getMap()){g_pageLiquidLayout.getMap().resetFirstViewLoad()}}s=$("#BodyLeftLane, #BodyCenterLane, #BodyTopHeader")}if(window.location.pathname=="/localArea.c21"){v="/localArea.c21"}else{if(window.location.pathname=="/school.c21"){v="/school.c21"}else{if(window.location.pathname=="/locationsearch.c21"){v="/locationsearch.c21"}else{if(window.websiteCode=="IDX"){v="/idxsearch.c21"}else{v="/search.c21"}}}}$("#searchNavTop .TitleColspan").css({zIndex:1000000});t={updateHash:true,loadingIndicator:new LoadingIndicator(s,g),cache:true};portalAjax.doViewEngineAjax(u||"searchView.AllSubView",v,$.param(w),t)},doGeoIPSearch:function(u){var s="lid";var t=portalAjax.getCookie("LAST_LOCATION");if(t==null){t=""}var v="";portalAjax.doViewEngineAjax("geoipsearch","/geoip.c21",$.param({type:u,lid:t,ipaddress:v,submitted:true}),{cache:false})},getSearchPageType:function(){var v,t,u,s={"0":"property","1":"office","2":"agent"};if(window.location.pathname!=="/search.c21"){return false}t=portalAjax.getParameters();return s[t.t]}}}());var SurroundingAreasRefine=(function(){var o,h=null,a,j,b,i,l;function k(){o.toggle();a.toggle();return false}function c(){o.toggle();a.toggle();if(!h||h.length==0){portalResults.lazyLoadSurroundingAreas()}return false}function g(p){if(p===true){portalResults.changeSurroundingAreas()}else{if(b.attr("checked")){portalResults.changeSurroundingAreas(j.val())}else{if(i.attr("checked")){aAreas=[];l.find("input").each(function(){if($(this).attr("checked")){aAreas.push($(this).val())}});if(aAreas.length>0){portalResults.changeSurroundingAreas(null,aAreas)}}}}}function e(){j.val(5);k();g(true);return false}function n(){if(b.attr("checked")){j.attr("disabled",false)}else{j.attr("disabled",true)}if(i.attr("checked")){l.find("label").each(function(){$(this).removeClass("disabled")});l.find("input").each(function(){$(this).attr("disabled",false)})}else{l.find("label").each(function(){$(this).addClass("disabled")});l.find("input").each(function(){$(this).attr("disabled",true)})}}function f(){l=$("#surroundingCheckContainer");b=$("#surroundingRadiusRadio");i=$("#surroundingAreasRadio");h=$("#surroundingAreasShow");h.click(k);j=$("#surroundingRadiusSelect");var q=portalAjax.getParameters();j.val(5);if(q.sa){i.attr("checked",true);var p=q.sa.split(",");l.find("input").each(function(t,s){for(var r=0;r<p.length;r++){if($(this).val()==p[r]){$(this).attr("checked",true)}}})}else{b.attr("checked",true);if(q.sr){j.val(q.sr)}}b.click(n);i.click(n);n();j.change(d);$("#surroundingAreasUpdateButton").click(g);$("#surroundingAreasUpdateCancel").click(e)}function d(){}function m(){o=$("#surroundingAreasHide");a=$("#surroundingAreas");o.click(c);portalAjax.bindLoadEvent(a,f)}return{resultsLoad:m}}());var PriceRangeRefine=(function(){function a(){var d=$("#lowPrice, #highPrice"),b=$("#priceUpdateButtonContainer"),c=new ShowHideButtons(d,b);c.setUpdateButton("#priceUpdateButton",portalResults.changePriceFacet);c.setCancelButton("#priceUpdateCancel",function(){d.val("");portalResults.changePriceFacet()})}return{resultsLoad:a}}());var MLSNumberRefine=(function(){var c;function b(){if($("body").hasClass("liquidLayout")){Track.doEvent("Hybrid Mapping","Property Refine","Refine and Update MLS #")}portalResults.changeSearchName(c,"mn")}function a(){c=$("#mlsSearch");var d=$("#mlsUpdateButtonContainer"),e=new ShowHideButtons(c,d);e.setUpdateButton("#mlsUpdateButton",b);e.setCancelButton("#mlsUpdateCancel",function(){c.val("");b()})}return{resultsLoad:a}}());var KeywordRefine=(function(){var a;function c(){if($("body").hasClass("liquidLayout")){Track.doEvent("Hybrid Mapping","Property Refine","Refine and Update Keyword")}portalResults.changeSearchName(a,"kw")}function b(){a=$("#keywordText");var d=$("#mlsOrAddressUpdateButtonContainer"),e=new ShowHideButtons(a,d);e.setUpdateButton("#keywordUpdateButton",c);e.setCancelButton("#keywordUpdateCancel",function(){a.val("");c()})}return{resultsLoad:b}}());var MLSNumberOrAddressRefine=(function(){var b;function c(){portalResults.changeSearchName(b,"q")}function a(){b=$("#mlsOrAddressSearch");var d=$("#mlsOrAddressUpdateButtonContainer"),e=new ShowHideButtons(b,d);e.setUpdateButton("#mlsOrAddressUpdateButton",c);e.setCancelButton("#mlsOrAddressUpdateCancel",function(){b.val("");c()})}return{resultsLoad:a}}());var LocationRefine=(function(){var c;function b(){if($("body").hasClass("liquidLayout")){var d=$("#selectedSchoolIds").val();if(d!=null&&d!=""){schoolSearch.showSchoolDeletionModal();return}else{schoolSearch.clearSchoolSearchCriteria();schoolSearch.closeWindow()}Track.doEvent("Hybrid Mapping","Left Lane","Refine and Update Location");window.g_pageLiquidLayout.getMap().resetFirstViewLoad()}else{if($("#PageBody").hasClass("locationSearchLayout")){Track.doEvent("Location Search Results","Left Lane","Refine and Update Location")}}portalResults.changeSearchLocation(c)}function a(){c=$("#refineText");var d=$("#locationUpdateButtonContainer"),e=new ShowHideButtons(c,d);e.setUpdateButton("#locationUpdateButton",b);e.setCancelButton("#locationUpdateCancel",function(){c.val("");b()})}return{resultsLoad:a}}());var OfficeNameRefine=(function(){var c;function b(){if($("body").hasClass("liquidLayout")){Track.doEvent("Hybrid Mapping","Office Refine","Refine and Update Office name")}portalResults.changeSearchName(c)}function a(){c=$("#officeSearch");var d=$("#officeUpdateButtonContainer"),e=new ShowHideButtons(c,d);e.setUpdateButton("#officeUpdateButton",b);e.setCancelButton("#officeUpdateCancel",function(){c.val("");b()})}return{resultsLoad:a}}());var AgentNameRefine=(function(){var c;function b(){if($("body").hasClass("liquidLayout")){Track.doEvent("Hybrid Mapping","Agent Refine","Refine and Update Agent name")}portalResults.changeSearchName(c)}function a(){c=$("#agentSearch");var d=$("#agentUpdateButtonContainer"),e=new ShowHideButtons(c,d);e.setUpdateButton("#agentUpdateButton",b);e.setCancelButton("#agentUpdateCancel",function(){c.val("");b()})}return{resultsLoad:a}}());window.ShowHideButtons=function(g,h){var j=100,a,d;function f(){if(a){return}a=true;d=setTimeout(function(){h.stop(true).css({opacity:1}).fadeOut(j,function(){a=false})},100)}function b(){a=false;clearTimeout(d);h.stop(true).css({opacity:1}).fadeIn(j)}function e(){g.focusout(f).focusin(b);f()}function i(l,k){g.each(function(m,n){if(n.tagName.toLowerCase()=="input"){$(n).enter(k)}});$(l).focusout(f).focusin(b).click(function(){k();f();return false})}function c(l,k){$(l).focusout(f).focusin(b).click(function(){k();f();return false})}this.initialize=e;this.showContainer=b;this.hideContainer=f;this.setUpdateButton=i;this.setCancelButton=c;e()};var ResultsPortalExtension=(function(){var c,l,m,h,n;function k(s){l.css({zIndex:1000});$("#PageHeader").removeClass("behind");m.stop(true,true).hide()}function i(){k($(this).parents(".CardWrapper"))}function f(v){var u=$(this).parents(".CardWrapper"),t=u.children(".flyOut");u.addClass("hover");var s=t.find("a.thumbs");s.each(function(y,w){var x=$(w);var z=x.find("img");z.attr("src",x.attr("rev"))});this.iHoverTimeout=setTimeout(function(){l.css({zIndex:1});t.show("slide",{direction:"down"},300);$("#PageHeader").addClass("behind")},300)}function q(){if(this.iHoverTimeout){clearTimeout(this.iHoverTimeout)}}function e(){var s;s=$(this);s.addClass("hover")}function o(){var s=$(this);s.removeClass("hover");k(s)}function b(){location.href=$(this).find(".listPrice a").attr("href")}function j(t){var s=t.index(),v=t.parents(".CardWrapper");var u=v.find(".CardThumb a").attr("href");if(u.indexOf("?")>=0){u+="&"}else{u+="?"}return u+"g="+escape(s)}function g(){var s=$(this),t=s.attr("rel");if(t){s.parents(".flyOut").find("a.bigImage").find("img").attr("src",t)}}function d(t){var s=$(this);location.href=j(s);t.stopPropagation();return false}function p(){PriceRangeRefine.resultsLoad();var s=$("#textSearched").val();if(s&&s.length>0){MLSNumberOrAddressRefine.resultsLoad()}else{MLSNumberRefine.resultsLoad()}AgentNameRefine.resultsLoad();OfficeNameRefine.resultsLoad();LocationRefine.resultsLoad();KeywordRefine.resultsLoad()}function r(){var t=$("#alert");if(t.length>0){portalResults.hideNavBars()}else{portalResults.showNavBars()}if($("body").hasClass("liquidLayout")){portalResults.showNavBars()}h=c.find(".CardWrapper");m=c.find(".flyOut");if(!$("body").hasClass("liquidLayout")){h.hover(e,o)}c.find(".CardThumb").hover(f,q);m.hover(function(){},i);c.find("a.thumbs").hover(g).click(d);var s=$("#refineSearch").find(">:first-child").get(0);if(s!=n){n=s;p()}if(!$("body").hasClass("liquidLayout")){SurroundingAreasRefine.resultsLoad()}ImageLazyLoader.loadImages()}function a(){l=$("#searchBox");c=$("#listContainer");portalAjax.bindLoadEvent(c,r)}$(document).ready(a)}());window.PortalResultMap=function(e,s){var m=this,g=new VEMapOptions(),l=new VEShapeLayer(),d={},b=null,p=5,t=[],h=$(".TopPagination").length<1?$("#searchNavTop"):$(".TopPagination"),n=30,x=$("#resultMap"),u=$(window),f=h.offset().top,q=-1,c=function(y){e.height(y);b.Resize(x.width(),y);q=y},o=function(){var z=Math.max(1000,$("#BodyLeftLane").contentHeight()),y=u.height()-p-n;if(b&&y>=q){c(y)}var A=u.scrollTop(),B=Math.max(0,Math.min(z-y,f>A?0:A-f));h.stop().animate({marginTop:B})},j=function(A){var C="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",B="";for(var z=0;z<A;z++){var y=Math.floor(Math.random()*C.length);B+=C.substring(y,y+1)}return B},r=function(){g.UseEnhancedRoadStyle=true;g.DashboardColor="black";b=new VEMap("resultMap");b.LoadMap(null,0,VEMapStyle.Road,false,VEMapMode.Mode2D,false,3,g);b.ClearInfoBoxStyles();var y=new VEClusteringOptions(),z=$("#clusterDetails"),A=$("#clusterIcon");y.Callback=function(B){$.each(B,function(E,D){var C=D.GetClusterShape(),G=D.Shapes.length,F="cluster_"+j(8);d[F]=D;A.children("div").attr("id",F).children("div").html(s!="Properties"?("<b>"+G+"</b>C21 "+s.toUpperCase()+"<br/>HERE&hellip;"):(G+" HERE"));z.children("div").attr("id",F).attr("lat",D.LatLong.Latitude).attr("lon",D.LatLong.Longitude).find(".ClusterCardCount").text(G+" "+s);C.SetCustomIcon(A.html());C.SetDescription(z.html());C.SetTitle("")})};b.AttachEvent("onclick",function(D){var B=$("#"+D.elementID),C=B.find(".PropertyClusterPushPin, .ClusterCard");if(C.length>0){w(C)}});l.SetClusteringConfiguration(VEClusteringType.Grid,y);b.AddShapeLayer(l)},w=function(z){var A=$(z),B=A.attr("id"),y=d[B];b.SetMapView(y.Shapes)},v=function(){b.SetMapView(t)},i=function(y,A,B,C){if(!C){C=1}var z=new VELatLong(A,B);t.push(z);var D=new VEShape(VEShapeType.Pushpin,z);D.SetCustomIcon($("#icon"+y).html());D.SetDescription($("#description"+y).html());D.clusterCount=C;l.AddShape(D)},a=function(){if(x.length==0){return}u.scroll(o);o();r();o()},k=function(y,z){b.SetCenterAndZoom(new VELatLong(y,z),b.GetZoomLevel()+1)};a();this.doMove=o;this.addPushPin=i;this.zoomCluster=w;this.mapObject=b;this.autoZoom=v;this.zoomTo=k};var SearchNavExtension=(function(){function a(){var g=$(this),d=g.val(),f;if(d!=null){f=new PortalParams();f.setParam("o",d);f.removeParam("s");if($("body").hasClass("liquidLayout")){var e=$("#lqSearchType").val();if(e=="PROPERTIES"){Track.doEvent("Hybrid Mapping","Property Center Lane","Sort",parseInt($("#sortSelect option:selected").index()))}else{if(e=="AGENTS"){Track.doEvent("Hybrid Mapping","Agent Center Lane","Sort",parseInt($("#sortSelect option:selected").index()))}else{if(e=="OFFICES"){Track.doEvent("Hybrid Mapping","Office Center Lane","Sort",parseInt($("#sortSelect option:selected").index()))}}}}portalResults.doPortalResults(f.getParams(),"searchView.Paginate")}}function c(){var f,h,d=$(this),e=d.val();if(e){f=parseInt(e,10);h=new PortalParams();h.setParam("r",f);h.removeParam("s");if($("body").hasClass("liquidLayout")){var g=$("#lqSearchType").val();if(g=="PROPERTIES"){Track.doEvent("Hybrid Mapping","Property Center Lane","Select Results/Page",parseInt(f))}else{if(g=="AGENTS"){Track.doEvent("Hybrid Mapping","Agent Center Lane","Select Results/Page",parseInt(f))}else{if(g=="OFFICES"){Track.doEvent("Hybrid Mapping","Office Center Lane","Select Results/Page",parseInt(f))}}}}else{if($("#PageBody").hasClass("locationSearchLayout")){Track.doEvent("Location Search Results","Select Results/Page",e)}}portalResults.doPortalResults(h.getParams(),"searchView.Paginate")}}function b(f,e,d){$("#rppSelect, #rppSelectBottom").change(c).val(f);$("#sortSelect, #sortSelectBottom").change(a).val(e);if(!$("#sortSelect").val()){$("#sortSelect, #sortSelectBottom").val("")}$("#viewAction"+d).addClass("Active").unbind("click");if($("body").hasClass("liquidLayout")){$.uniform.update()}}return{refreshNavigation:b}}());function sendHandoff(c){clearTimeout(window.handoffTimeout);handoffLoading.stop();if(c.call=="resize"){portalResults.resizeHandoff(c.height)}else{if(c.call=="showContactForm"){$("#contactCard").html(window.handoffContactForm);$("#handoffPropertyRightLane").show();$("#handoffResultsRightLane").hide();var b=$("#handoffOfficeId").text();if(c.associationKey){b=c.associationKey}var a=$("#officeContactForm");a.find("#id").val(b);a.find("#lidxurl").val(c.lidxurl);a.find("#lmls").val(c.lmls);a.find("#laddress").val(c.laddress);a.find("#lcity").val(c.lcity);a.find("#lstate").val(c.lstate);a.find("#lzip").val(c.lzip);a.find("#ltype").val(c.ltype);a.find("#lid").val(c.lid);a.find("#lmlsid").val(c.lmlsid)}else{if(c.call=="setComments"){$("#comments").val(c.comments)}else{if(c.call=="showSeeAllLink"){$("#handoffPropertyRightLane").hide();$("#handoffResultsRightLane").show()}}}}}window.handoffTimeout=null;window.performHandoffTimeout=function(){Track.doEvent("IDX2.0","Handoff Page","eN Timeout");document.location.href=(document.location.href+(document.location.search?"&h=0":"?h=0"))};$(document).ready(function(){var f=$("#handoffFrame"),c=f.length>0;if(c){window.handoffTimeout=setTimeout("window.performHandoffTimeout();",60000);window.handoffContactForm=$("#contactCard").html();Track.doEvent("IDX2.0","Handoff Page","Show handoff landing page")}if(window.viewEngineName=="search"||window.viewEngineName=="locationsearch"){var e=(c)?24:24,d=(c)?8:8,a=(c?"searchView.HandoffRightRail":"searchView.RightRail"),b={};if(c){b.h=$("#handoffOfficeId").text()}new NavigationExtension("agent","a",{iChunkSize:e,iMaxItemDisplay:d,oAdditionalParams:b,strSubview:a});new NavigationExtension("office","f");new NavigationExtension("property","p")}else{if(window.viewEngineName=="school"){new NavigationExtension("agent","a");new NavigationExtension("office","f");new NavigationExtension("property","p")}else{if(window.viewEngineName=="wiki"){new NavigationExtension("property","p")}else{if(window.viewEngineName=="localArea"||window.viewEngineName=="findahomemapdetail"){new NavigationExtension("property","p")}}}}});$(document).ready(function(){function a(){var c=$(window).height(),d=$("#PageBody"),f=$("#PageFooter").outerHeight(),b=$("#PageBreadcrumbs").outerHeight(),g=$("#PageHeader").outerHeight(),e=d.outerHeight()-d.height();d.css({minHeight:c-f-b-g-e})}$(window).resize(a);a();$("#websiteFeedbackLink").click(function(){portalAjax.doViewEngineAjax("LoadFeedbackForm","/feedback.c21",$.param({submitted:"true"}),{cache:true})});$(".expandoContainer").each(function(e,f){var b=$(f),d=b.find("a");jItems=b.parent().find("div");jItems.splice(-1,1);if(jItems.length>5){var c=jItems.slice(-1*(jItems.length-5)),g=true;c.hide().find("a").css({color:"#f3f3f3"});b.show();d.click(function(h){h.preventDefault();g=!g;if(g){d.text(window.internationalization.getString("Show More"));d.attr("title",window.internationalization.getString("Show More"));c.find("a").animate({color:"#f3f3f3"},300);setTimeout(function(){c.slideUp()},300)}else{d.text(window.internationalization.getString("Hide"));d.attr("title",window.internationalization.getString("Hide"));c.slideDown(300);setTimeout(function(){c.find("a").animate({color:"#898989"},300,function(){$(this).css({color:""})})},300)}})}});$("#showLeftRail").on("click",function(){var b=$("body");if(b.hasClass("showRefine")){b.removeClass("showRefine")}else{b.addClass("showRefine")}})});var g_bInMove=false;function MoveSliderLeft(d){if(g_bInMove){return}if(d==null||d<=0){d=205}g_bInMove=true;var j=document.getElementById("photoselectioncontainer");if(j){var f=0;var b=0;if(!j.style.width||j.style.width==""){var a=j.getElementsByTagName("div");if(a&&a.length>0){for(var e=0;e<a.length;e++){var g=a[e].className;if(g.search("slide")>0){b+=CyberCoreFindWidth(a[e])}}}j.style.width=b+"px"}else{b=parseInt(j.style.width)}if(j.style.marginLeft!=null&&j.style.marginLeft!=""){f=parseInt(j.style.marginLeft)}j.style.marginLeft=f+"px";if(f<0){var c=f+d;var h=new SmoothMovement(f,c,-7);window.setTimeout(function(){UpdateSlider(j,h,c,d)},20)}else{g_bInMove=false}}}function MoveSliderRight(e){if(g_bInMove){return}if(e==null||e<=0){e=205}g_bInMove=true;var k=document.getElementById("photoselectioncontainer");if(k){var g=0;var c=0;if(!k.style.width||k.style.width==""){var a=k.getElementsByTagName("div");if(a&&a.length>0){for(var f=0;f<a.length;f++){var h=a[f].className;if(h.search("slide")>0){c+=CyberCoreFindWidth(a[f])}}}k.style.width=c+"px"}else{c=parseInt(k.style.width)}if(k.style.marginLeft!=null&&k.style.marginLeft!=""){g=parseInt(k.style.marginLeft)}k.style.marginLeft=g+"px";var d=g-e;if(Math.abs(d)<c){var j=new SmoothMovement(g,d,7);window.setTimeout(function(){UpdateSlider(k,j,d,e)},20)}else{g_bInMove=false;var b=document.getElementById("collectionnextbtn");b.src="/images/detail/nextphoto_disabled.gif"}}}function InitSlider(h){if(h==null||h<=0){h=205}var b=document.getElementById("photoselectioncontainer");if(b){var g=0;if(!b.style.width||b.style.width==""){var f=b.getElementsByTagName("div");if(f&&f.length>0){for(var d=0;d<f.length;d++){var e=f[d].className;if(e.search("slide")>0){g+=CyberCoreFindWidth(f[d])}}}b.style.width=g+"px"}else{g=parseInt(b.style.width)}var a=document.getElementById("collectionnextbtn");if(h>=parseInt(g)){a.src="/images/detail/nextphoto_disabled.gif"}else{a.src="/images/detail/nextphoto.gif"}var c=document.getElementById("collectionpreviousbtn");c.src="/images/detail/previousphoto_disabled.gif"}}$(document).ready(function(){try{InitSlider(640)}catch(a){}});function UpdateSlider(c,a,e,g){if(g==null||g<=0){g=205}var f=a.updatePosition();c.style.marginLeft=f+"px";if(f!=e){window.setTimeout(function(){UpdateSlider(c,a,e,g)},20)}else{g_bInMove=false;var d=document.getElementById("collectionpreviousbtn");if(e>=0){d.src="/images/detail/previousphoto_disabled.gif"}else{d.src="/images/detail/previousphoto.gif"}var b=document.getElementById("collectionnextbtn");if(Math.abs(e-g)>=parseInt(c.style.width)){b.src="/images/detail/nextphoto_disabled.gif"}else{b.src="/images/detail/nextphoto.gif"}}}function SwapMainImage(d,c){var b=document.getElementById("mainimageimg");if(b){b.src=d}var a=document.getElementById("mainimage_caption");if(a){a.innerHTML=c}return false}function MoveCollectionLeft(g){if(g_bInMove){return}if(g==null||g<=0){g=205}g_bInMove=true;var b=document.getElementById("photoselectioncontainer");if(b){var h=0;var e=0;if(!b.style.width||b.style.width==""){var d=b.getElementsByTagName("div");if(d&&d.length>0){for(var c=0;c<d.length;c++){e+=CyberCoreFindWidth(d[c])+8}}b.style.width=e+"px"}else{e=parseInt(b.style.width)}if(b.style.marginLeft!=null&&b.style.marginLeft!=""){h=parseInt(b.style.marginLeft)}b.style.marginLeft=h+"px";if(h<0){var f=h+g;var a=new SmoothMovement(h,f,-7);window.setTimeout(function(){UpdateCollectionSlide(b,a,f)},20)}else{g_bInMove=false}}}function MoveCollectionRight(e){if(g_bInMove){return}if(e==null||e<=0){e=205}g_bInMove=true;var j=document.getElementById("photoselectioncontainer");if(j){var g=0;var c=0;if(!j.style.width||j.style.width==""){var a=j.getElementsByTagName("div");if(a&&a.length>0){for(var f=0;f<a.length;f++){c+=CyberCoreFindWidth(a[f])+8}}j.style.width=c+"px"}else{c=parseInt(j.style.width)}if(j.style.marginLeft!=null&&j.style.marginLeft!=""){g=parseInt(j.style.marginLeft)}j.style.marginLeft=g+"px";var d=g-e;if(Math.abs(d)<c){var h=new SmoothMovement(g,d,7);window.setTimeout(function(){UpdateCollectionSlide(j,h,d)},20)}else{g_bInMove=false;var b=document.getElementById("collectionnextbtn");b.src="/images/detail/nextphoto_disabled.gif"}}}function InitCollectionSlide(c){if(c==null||c<=0){c=205}var b=document.getElementById("photoselectioncontainer");if(b){var a=document.getElementById("collectionnextbtn");if(c>=parseInt(b.style.width)){a.src="/images/detail/nextphoto_disabled.gif"}else{a.src="/images/detail/nextphoto.gif"}}}function UpdateCollectionSlide(c,a,e,g){if(g==null||g<=0){g=205}var f=a.updatePosition();c.style.marginLeft=f+"px";if(f!=e){window.setTimeout(function(){UpdateCollectionSlide(c,a,e)},20)}else{g_bInMove=false;var d=document.getElementById("collectionpreviousbtn");if(e>=0){d.src="/images/detail/previousphoto_disabled.gif"}else{d.src="/images/detail/previousphoto.gif"}var b=document.getElementById("collectionnextbtn");if(Math.abs(e-g)>=parseInt(c.style.width)){b.src="/images/detail/nextphoto_disabled.gif"}else{b.src="/images/detail/nextphoto.gif"}}}function CyberCoreFindWidth(b){var a=0;if(document.getElementById||document.all){a=b.offsetWidth}else{if(document.layers){a=b.width}}return a}function CyberCoreFindHeight(b){var a=0;if(document.getElementById||document.all){a=b.offsetHeight}else{if(document.layers){a=b.height}}return a}function CyberCoreFindPosX(a){var b=0;if(document.getElementById||document.all){while(a.offsetParent){b+=a.offsetLeft;a=a.offsetParent}}else{if(document.layers){b+=a.x}}return b}function CyberCoreFindPosY(b){var a=0;if(document.getElementById||document.all){if(!b.offsetParent){a+=b.offsetTop}while(b.offsetParent){a+=b.offsetTop;b=b.offsetParent}}else{if(document.layers){a+=b.y}}return a}function CyberCoreAddEvent(b,e,a,c){if(b.addEventListener){b.addEventListener(e,a,c);return true}else{if(b.attachEvent){var d=b.attachEvent("on"+e,a);return d}else{return false}}}function EmbedCyberFlashVideo(g,c,b,d,f,e){var a="&bigplay=false";if(e){a="&bigplay=true"}AC_FL_RunContent("codebase","/web/20160127041237/http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0","width",d,"height",f+10,"quality","high","pluginspage","/web/20160127041237/http://www.macromedia.com/go/getflashplayer","align","middle","play","true","loop","true","scale","noscale","wmode","transparent","devicefont","false","bgcolor","#ffffff","menu","false","allowFullScreen","false","allowScriptAccess","sameDomain","salign","tl","bigplay","false","id",g,"src",g,"name",g,"movie","/flash/C21EnhVP?autoplay=t&preview="+b+"&video="+c+"&id="+g+a)}function CyberUrlEncode(g){var c="";var a=0;g=g.toString();var f=/(^[a-zA-Z0-9_.]*)/;while(a<g.length){var d=f.exec(g.substr(a));if(d!=null&&d.length>1&&d[1]!=""){c+=d[1];a+=d[1].length}else{if(g[a]==" "){c+="+"}else{var b=g.charCodeAt(a);var e=b.toString(16);c+="%"+(e.length<2?"0":"")+e.toUpperCase()}a++}}return c}function SmoothMovement(c,b,a){c=Math.round(c);b=Math.round(b);a=(a?Math.round(a):0);this.updatePosition=function(){c+=a;if(a<0){if(c-a*(a-1)/2<b){a++}else{if(c-(a-1)*(a-2)/2>=b){a--}}}else{if(c+a*(a+1)/2>b){a--}else{if(c+(a+1)*(a+2)/2<=b){a++}}}return c};this.changeTarget=function(d){b=Math.round(d)};this.getPosition=function(){return c};this.getVelocity=function(){return a};this.hasStopped=function(){return(c==b&&a==0)}}(function(){var m_bLoaded=false;window.loadBingMaps=function(fnOnLoad){if($("#mappingHeader").length==1){return}var interval=setInterval(function(){var elBody=document.getElementsByTagName("body")[0];if((eval("typeof VEMap")!="undefined")&&(elBody.attachEvent!=undefined)){clearInterval(interval);m_bLoaded=true;if(typeof fnOnLoad=="function"){fnOnLoad()}}},1000);if(!m_bLoaded){var strUrl="/web/20160127041237/http://dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=6.2";if((window.websiteCode=="ESP")||(window.location.hostname.indexOf("espanol")==0)){strUrl="/web/20160127041237/http://dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=6.2&mkt=es-US"}$.ajax({url:strUrl,dataType:"script",success:function(){},cache:true})}};setTimeout(loadBingMaps,5000)}());var portalMapping=(function(){var b,h,a,j;var r,d,b;function q(w,x,A){var B="/mapping/directionsPopup.html",z={startAddress:w,endAddress:x,propBrandCd:A};if((window.websiteCode=="ESP")||(window.location.hostname.indexOf("espanol")==0)){B="/mapping/directionsPopup_esp.html"}var y=B+"?"+$.param(z);r=window.open(y,"Directions","location=1,status=1,scrollbars=1,width=800,height=600");return false}function t(A,x,B,w){var C="/mapping/directionsPopupOdp.html",z={startAddress:A,endAddress:x,officeLatitude:B,officeLongitude:w};if((window.websiteCode=="ESP")||(window.location.hostname.indexOf("espanol")==0)){C="/mapping/directionsPopupOdp_esp.html"}var y=C+"?"+$.param(z);r=window.open(y,"Directions","location=1,status=1,scrollbars=1,width=800,height=600");return false}function s(){b=new VEMap("map");b.LoadMap();b.Resize(650,400)}function e(){$("#loading").show();$("#options").hide();$("#directions").hide()}function o(){$("#loading").hide();$("#options").show();$("#directions").slideDown()}function l(z,y){e();var w=[z,y];var x=new VERouteOptions;x.DrawRoute=true;x.SetBestMapView=true;x.RouteCallback=p;x.DistanceUnit=VERouteDistanceUnit.Mile;x.ShowDisambiguation=true;b.GetDirections(w,x);$("#startAddress").text(z);$("#endAddress").text(y);$("#propertyBrandCd").val(j)}function u(z){if(z==null){return("")}if(z>60){var A=z%60;var y=z-A;y=y/60;if(y>60){var x=y%60;var w=y-x;w=w/60;return(w+" hour(s), "+x+" minute(s), "+A+" second(s)")}else{return(y+" minutes, "+A+" seconds")}}else{return(z+" seconds")}}function f(x){var w=x*5280;if(w<500){return w.toFixed(0)+" ft"}else{return x.toFixed(1)+" mi"}}function i(x,A,z,w){var y=$("#stepTemplate").clone();y.attr("id","");y.find(".title").text(x);y.find(".time").text(A);y.find(".distance").text(z);y.find(".hints").html(w.join("<br />"));$("#directions").append(y)}function p(x){m();var w=x.RouteLegs;var y=w[0];$("#totalDistance").text(f(y.Distance));$("#totalTime").text(u(y.Time));$.each(y.Itinerary.Items,function(D,B){var A=(B.Distance!=0)?"go "+f(B.Distance):"";var E=(B.Time)?u(B.Time):"";var C=[];if(B.Hints){$.each(B.Hints,function(F,G){C[F]=G.Text})}var z=(D+1).toString()+". "+B.Text;i(z,E,A,C)});$("#directions").find(".step:odd").addClass("altstep");o()}function m(){$("#directions").find(".step").not("#stepTemplate").remove()}function k(){var w=portalAjax.getParameters();h=w.startAddress;a=w.endAddress;j=w.propBrandCd}function c(){l(a,h)}function v(){l(h,a)}function g(){var w=h;h=a;a=w}function n(){k();loadBingMaps(function(){s();v();var w=false;$("#reverseDirections").click(function(){if(w){w=false;v()}else{w=true;c()}return false});$("#print").click(function(){window.print();return false})})}return{showDirectionsWindow:q,showOfficeDirectionsWindow:t,initializeDirections:n}})();$(document).ready(function(){$(".cityHeader, .countyHeader").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")});$(".stateContainer").hover(function(){var header=$(this).find(".stateHeader");$(this).addClass("hover");AreaDetails.showHoverState($(header).attr("id").substring($(header).attr("id").length-2))},function(){var header=$(this).find(".stateHeader");$(this).removeClass("hover");AreaDetails.hideHoverState()});$(".disabled a").each(function(){$(this).click(function(){return false}).attr("href","javascript:void(0);")});$(".disableLabelLink a").each(function(){$(this).click(function(){return false}).attr("href","javascript:void(0);")});$(".countyListing.disabled").each(function(){$(this).click(function(){return false}).attr("href","javascript:void(0);")});$(".countyLink").live({mouseenter:function(){$(this).addClass("hover")},mouseleave:function(){$(this).removeClass("hover")},click:function(){var jLink=$(this).find("a");if(jLink.attr("onclick")!=null){eval(jLink.attr("onclick"));if(jLink.attr("href").length>0){document.location.href=jLink.attr("href")}else{return false}}}});$(".cityLink").live({mouseenter:function(){$(this).addClass("hover")},mouseleave:function(){$(this).removeClass("hover")},click:function(){var jLink=$(this).find(".cityLinkLabel");if(jLink.attr("onclick")!=null){eval(jLink.attr("onclick"));if(jLink.attr("href").length>0){document.location.href=jLink.attr("href")}else{return false}}}});$(".stateLink").live({mouseenter:function(){$(this).addClass("hover")},mouseleave:function(){$(this).removeClass("hover")},click:function(event){var jLink=$(this).find(".stateLinkLabel");if(jLink.attr("onclick")!=null){eval(jLink.attr("onclick"));if(jLink.attr("href").length>0){document.location.href=jLink.attr("href")}else{return false}}}});$(".stateInfoCell").live({mouseenter:function(){$(this).addClass("hover")},mouseleave:function(){$(this).removeClass("hover")},click:function(){var jLink=$(this).find(".stateInfoCellLabel");if(jLink.attr("onclick")!=null){eval(jLink.attr("onclick"));if(jLink.attr("href").length>0){document.location.href=jLink.attr("href")}else{return false}}}})});var SiteMapDetail=new function(){this.getCitiesByLetter=function(b,a){if(a==null||a==""){a="Top 50"}Track.doEvent("Find a Home by State",$("#stateNameDisplay").val()+" Real Estate","Sort Cities: "+a);portalAjax.doViewEngineAjax("Sitemapdetailcitylistinformation","/findahomemapdetail.c21",$.param({letter:a,lid:b,submitted:"true"}))}};window.SiteMapFilter=function(){function b(e){var f=e.text();var d=f.indexOf("(");f=f.substring(0,d);var c=e.attr("id");Track.doEvent("Find a Home by State",$("#stateNameDisplay").val()+" Real Estate","View Location Information: "+c);portalAjax.doViewEngineAjax("Sitemapdetailcountyinformation","/findahomemapdetail.c21",$.param({location:f,LID:c,submitted:"true"}))}function a(e){var d=e.text();var c=d.indexOf("(");d=d.substring(0,c);var f=e.attr("id");Track.doEvent("Find a Home by State",$("#stateNameDisplay").val()+" Real Estate","View Location Information: "+f);portalAjax.doViewEngineAjax("Sitemapdetailcityinformation","/findahomemapdetail.c21",$.param({location:d,LID:f,submitted:"true"}))}this.initialize=function(){var c,h=$(".countyListing, .cityListing"),g=false;var f=$("<div />").qtip({content:{text:'<div style="width: 220px; padding: 10px;" id="qtipDiv"></div>'},position:{effect:false,target:"event",my:"center right",at:"center left",viewport:$(window),solo:true},style:{tip:{border:10,width:18,height:30,offset:10,mimic:"center"},classes:"ui-tooltip-shadow ui-tooltip-tipsy"},onUpdateCalled:function(l,k,j){if(k.y=="top"){j.top-=29}else{if(k.y=="bottom"){j.top+=29}}},events:{show:function(k,j){if(g){$("#qtipDiv").empty()}}},show:false,prerender:true,hide:{target:h,event:"unfocus",fixed:true,inactive:3000}});function d(){$(".disableLabelLink a").each(function(){$(this).click(function(){return false}).attr("href","javascript:void(0);")});$(".disabled a").each(function(){$(this).click(function(){return false}).attr("href","javascript:void(0);")});$(".cityLink").live({mouseenter:function(){$(this).addClass("hover")},mouseleave:function(){$(this).removeClass("hover")},click:function(){var j=$(this).find(".cityLinkLabel");if(j.attr("onclick")!=null){}else{if(j.attr("href")!=null&&j.attr("href").length>0){document.location.href=j.attr("href")}}}})}function i(){$(".disableLabelLink a").each(function(){$(this).click(function(){return false}).attr("href","javascript:void(0);")});$(".disabled a").each(function(){$(this).click(function(){return false}).attr("href","javascript:void(0);")});$(".countyLink").live({mouseenter:function(){$(this).addClass("hover")},mouseleave:function(){$(this).removeClass("hover")},click:function(){var j=$(this).find(".countyLinkLabel");if(j.attr("onclick")!=null){}else{if(j.attr("href")!=null&&j.attr("href").length>0){document.location.href=j.attr("href")}}}})}d();i();$("#countyInformationDiv, #cityInformationDiv").bind("portalAjaxLoadEvent",function(){d();i();var j=$("<div />");j.append($(this).children(":first"));$("#qtipDiv").empty().append(j);g=false;f.qtip("option","position.target",c);f.qtip("show")});function e(){$(".sortLink.useless").each(function(){$(this).click(function(){return false}).attr("href","javascript:void(0);")});$(".cityListing.disabled").each(function(){$(this).click(function(){return false}).attr("href","javascript:void(0);")});$("#sortLinkContainer .sortLink").click(function(){if(!$(this).hasClass("useless")){$("#sortLinkContainer .sortLink.active").each(function(){$(this).removeClass("active")});$(this).addClass("active")}});$("#listingLaneCities .cityListing").hoverIntent(function(){var j=$(this);g=true;c=j;a(j)},function(){})}e();$("#listingCitiesDiv").bind("portalAjaxLoadEvent",function(){e()});$("#listingLaneCounties .countyListing").hoverIntent(function(){var j=$(this);g=true;c=j;b(j)},function(){})}};var listHub=(function(){var c="M-2234";var a="M-1552";var f="M-1499";var e="M-1559";function d(g,h){if(window.disableListHubTracking==true){return}if(g!=null&&g.indexOf("3yd")==0){_listhub_tracker(g,a,h,$.cookie("ref_code"));return}if(g.indexOf("BHG")<0&&g.indexOf("CBR")<0&&g.indexOf("ERA")<0&&g.indexOf("LCE")<0){g=g.replace("C21","");_listhub_tracker(g,c,h,$.cookie("ref_code"))}}function b(h,g){if(window.disableListHubTracking==true){return}h=h.toUpperCase();_listhub_tracker(h,c,g,$.cookie("ref_code"))}return{doTracking:d,doTrackingC21:b}}());var doubleClick=(function(){function a(g,f,e,b){var d=Math.random()+"";var c=d*1000000000000000000;var h=new Image();h.src="http://"+g+"/activity;src="+f+";type="+e+";cat="+b+";ord=1;num="+c+"?"}return{callStaticFL:a}}());(function(){var a=function(){this.initialize=function(){this.showValidationErrors();this.expandLocationResults();this.singleLocationResultDisplay();$(".locationRow .disabled a").each(function(){$(this).attr("href","javascript:void(0);");$(this).attr("onclick","return false;")});if(!this.m_bIsBound){this.m_bIsBound=true;portalAjax.bindLoadEvent($("#dropdownContent"),function(){var b=document.getElementById("dropdownContent");b.style.display="none";b.style.display="block"})}$(".locationResultsDiv, .propertyResultsDiv, .officeResultsDiv, .agentResultsDiv").hover(function(){if($(this).find(".freetextsearchLabelNoData").length==0){$(this).addClass("parentHover")}},function(){$(this).removeClass("parentHover")})};this.singleLocationResultDisplay=function(){var b=$("#hasProperties").val();var c=$("#suggestType").val();if(c.length>0){if(c=="SINGLE_LOCATION"){if(b!="true"){$("#propertyResultsDiv").hide()}$("#officeResultsDiv").hide();$("#agentResultsDiv").hide()}}};this.expandLocationResults=function(){var b=$("#showMore").val();if(b.length>0&&b=="L"){$(".freeTxtResults.location").addClass("megaextended")}};this.showValidationErrors=function(){var b=$("#validationErrorCount").val(),c="";if(b>0){$("#searchValidationErrors .errordisplay").each(function(){var d=$(this).html();c+=d+"\r\n"});alert(c)}};this.searchRental=function(){$("#searchRental").val("Y")};this.searchOpenHouses=function(){$("#searchOpenHouses").val("Y")};this.searchRecentlyReduced=function(){$("#searchRecentlyReduced").val("Y")};this.searchNewlyListed=function(){$("#searchNewlyListed").val("Y")};this.searchForeclosures=function(){$("#searchForeclosures").val("Y")};this.gaTrackExactLocationMatch=function(b,c){if(b!=null&&b.length>0&&c!=null&&c.length>0){if(c=="C"){Track.doEvent("FTS Exact","City",b)}else{if(c=="S"){Track.doEvent("FTS Exact","State",b)}else{if(c=="Z"){Track.doEvent("FTS Exact","Zip",b)}else{if(c=="N"){Track.doEvent("FTS Exact","County",b)}else{if(c=="P"||c=="Q"||c=="R"){Track.doEvent("FTS Exact","Neighborhood",b)}}}}}}};this.gaTrackExactOfficeMatch=function(b){if(b!=null&&b.length>0){Track.doEvent("FTS Exact","Office Name",b)}};this.gaTrackExactAgentMatch=function(c,b){if(c!=null&&c.length>0){if(b!=null&&b==true){Track.doEvent("FTS Exact","Team Name",c)}else{Track.doEvent("FTS Exact","Agent Name",c)}}};this.gaTrackExactPropertyMatch=function(c,b){if(c!=null&&c.length>0){if(b!=null&&b=="true"){Track.doEvent("FTS Exact","Property MLS #",c)}else{Track.doEvent("FTS Exact","Property Address",c)}}};this.propertySearch=function(h,o,c){var n=$("#searchText").val(),q=$("#e").val(),g=$("#priceFrom").val(),j=$("#priceTo").val(),d=$("#bedroomsFrom").val(),s=$("#bedroomsTo").val(),f=$("#bathroomsFrom").val(),m=$("#bathroomsTo").val(),k=$("#structureSizeFrom").val(),b=$("#structureSizeTo").val();var l=$("#searchRental").val();var p=$("#searchOpenHouses").val();var i=$("#searchRecentlyReduced").val();var r=$("#searchNewlyListed").val();var t=$("#searchForeclosures").val();if((g!=null&&g.length>0)||(j!=null&&j.length>0)){Track.doEvent("Free Text Search","Search listings by price range")}if((d!=null&&d.length>0)||(s!=null&&s.length>0)){Track.doEvent("Free Text Search","Search listings by beds")}if((f!=null&&f.length>0)||(m!=null&&m.length>0)){Track.doEvent("Free Text Search","Search listings by baths")}if((k!=null&&k.length>0)||(b!=null&&b.length>0)){Track.doEvent("Free Text Search","Search listings by square feet")}if(c){q=1}portalAjax.doViewEngineAjax("FreeTextSearchListingsSearch","/freetextsearch.c21",$.param({q:n,e:q,showMore:o,locationLID:h,listtyperental:l,listtypeopenhouses:p,listtyperecentlyreduced:i,listtypenewlylisted:r,listtypeforeclosures:t,priceFrom:g,priceTo:j,bedroomsFrom:d,bedroomsTo:s,bathroomsFrom:f,bathroomsTo:m,structureSizeFrom:k,structureSizeTo:b,submitted:"true"}),{cache:true})};this.showMore=function(b){var d=$("#searchText").val(),c=$("#e").val();if(b==null||b.length==0){b="NONE"}portalAjax.doViewEngineAjax("FreeTextSearchShowMore","/freetextsearch.c21",$.param({q:d,e:c,showMore:b,submitted:"true"}),{cache:true})};this.viewAll=function(b){var c=$("#searchText").val(),d=$("#e").val();if(b.length==0){b="NONE"}portalAjax.doViewEngineAjax("FreeTextSearchViewAll","/freetextsearch.c21",$.param({q:c,e:d,viewAll:b,submitted:"true"}),{cache:true})}};window.freeTextSearch=new a()}());var locationSearchResults=(function(){});(function(c){var d=[];function b(){setTimeout(function(){c.each(d,function(f,h){var e="#"+h,g="."+h+"_input";if(c(g).length==0){c(e).remove()}})},800)}var a={init:function(f,e){return this.each(function(){var g=c(this),P=g.data("c21boxdropdown");if(!P){b();var p="generated_"+(Math.floor(Math.random()*1000)).toString();d.push(p);var r=c("<div />",{id:p,html:['<div class="dropdownHeader">','<div class="dropdownHeaderContainer">','<div class="background"></div>','<input type="text" class="foreground" />',"</div>","</div>",'<div class="dropdownOptionViewport">','<div class="dropdownOptionContainer">',"</div>","</div>"].join(""),"class":"dropdownBox"}),v=r.find(".dropdownHeader"),C=r.find(".dropdownHeaderContainer"),M=c(['<div class="selector smallSelector">',"<span></span>","</div>"].join("")),N=C.find("input.foreground"),n=C.find("div.background"),x=r.find(".dropdownOptionViewport"),I=r.find(".dropdownOptionContainer"),y=function(i){M.find("span").text(i)},j=function(i){y(i);N.val(i);if(g.val()!=i){H=true}g.val(i)},h=function(){var Q=x.find(".dropdownOptionSelected"),W=x.scrollTop(),V=x.height(),S=W+V,i=Q.position(),R=Q.outerHeight(),U=i.top,T=U+R;if(T>S){x.scrollTop(T-V)}if(U<W){x.scrollTop(U)}},L=function(){var i=r.find(".dropdownOptionSelected");i.removeClass("dropdownOptionSelected");if(i.hasClass("dropdownHeader")){var Q=r.find(".dropdownOptionViewport .dropdownOption:last")}else{var Q=i.prev();if(Q.length==0){if(r.find(".dropdownHeader.dropdownOption").length!=0){Q=r.find(".dropdownOption:first")}else{Q=r.find(".dropdownOption:last")}}}Q.addClass("dropdownOptionSelected");if(!Q.hasClass("dropdownHeader")){h()}},t=function(){var Q=r.find(".dropdownOptionSelected");Q.removeClass("dropdownOptionSelected");if(Q.hasClass("dropdownHeader")){var i=r.find(".dropdownOptionViewport .dropdownOption:first")}else{var i=Q.next();if(i.length==0){i=r.find(".dropdownOption:first")}}i.addClass("dropdownOptionSelected");if(!i.hasClass("dropdownHeader")){h()}},u=function(i){if(!K){return}var Q=i.keyCode;if((Q==13)||(Q==32)){O();return false}else{if(Q==38){L();return false}else{if(Q==39||Q==9){}else{if(Q==40){t();return false}}}}},w=function(Q){return{text:Q,minValue:Q};var i=parseInt(Q.replace(/[^0-9.]/gi,""),10);if(isNaN(i)){i=0}if(i==0){return{text:window.websiteCode=="ESP"?"Todos":"Any",minValue:""}}else{return{text:i.toString(),minValue:i.toString()}}},A=function(){var Q=N.val(),i=w;if(e&&e.formatter){i=e.formatter}if(Q!=""){r.find(".dropdownOptionSelected").removeClass("dropdownOptionSelected");r.find(".dropdownHeader").addClass("dropdownOption dropdownOptionSelected")}else{if(r.find(".dropdownHeader.dropdownOptionSelected").length>0){r.find(".dropdownHeader").removeClass("dropdownOption dropdownOptionSelected");t()}}},G=function(){n.addClass("dropdownHintHidden")},m=function(){n.removeClass("dropdownHintHidden")},K=false,H=false,l=function(){var S=7,Q=M.offset(),i=M.width(),R={top:Q.top-S+1,left:Q.left-S,right:i+S};if(Q.left==0){return}r.css({top:0,left:0});r.offset(R);K=true;r.attr("showing","true")},s=function(){var i=K;K=false;r.offset({top:-9999,left:-9999}).show();r.attr("showing","false");if(H){H=false;if(i&&e){if(e.onBlurAndChange){e.onBlurAndChange(g.val())}}}if(e){if(e.onBlur&&i){e.onBlur(g.val())}}},O=function(){var Q=x.find(".dropdownOptionSelected"),R=Q.attr("value"),i=Q.text();if(Q.length!==0){j(i);G()}else{y(N.val())}N.get(0).blur();s()},q=function(){var i=N.val();if(i==""){m()}else{G()}},B=false;if(e){if(e.dropdownClass){r.addClass(e.dropdownClass)}if(e.selectBoxClass){M.addClass(e.selectBoxClass)}n.text(e.textHint);N.keyup(function(Q){var R=N.val(),S=Q.keyCode;if((S==13)||(S==32)){return}else{if(S==38){return}else{if(S==40){return}}}A();var i=R.replace(/[^0-9,.$]/g,"");if(i!=R){j(i)}else{y(R);if(g.val()!=R){H=true}g.val(R)}});if(e.tabIndex){N.attr("tabindex",e.tabIndex)}}c(document.body).keydown(u);M.addClass(p+"_input");N.val(g.val());y(g.val());q();if(e&&e.maxLength){N.attr("maxlength",e.maxLength.toString())}s();var z=false,E=false;var o=function(){z=true;c(document).trigger("hideDropdowns");l();if(!E){E=true;N.focus();E=false}G()};N.focus(o);c(document).bind("hideDropdowns",function(){if(!z){s();q()}z=false});N.blur(function(){setTimeout(function(){if(!B){s()}B=false},15);q()});M.click(function(i){z=true;c(document).trigger("hideDropdowns");l();B=true});r.click(function(i){i.stopPropagation()});r.mousedown(function(i){B=true;i.stopPropagation()});c("html").mousedown(function(){setTimeout(function(){if(!B){s()}B=false},10)});var J=0;c.each(f,function(R,i){var Q=c("<div />",{"class":"dropdownOption",text:i,value:R});Q.disableSelection();I.append(Q);J++;if(J%2==0){Q.addClass("dropdownOptionOdd")}});c(window).resize(function(){if(K){l()}});g.after(M).hide();var D=r.find(".dropdownOption"),F=D.eq(0);D.mouseover(function(){var Q=r.find(".dropdownOption"),i=c(this);Q.removeClass("dropdownOptionSelected");i.addClass("dropdownOptionSelected")}).mouseup(O);v.click(function(){var R=c(this);if(R.hasClass("dropdownOption")){var Q=r.find(".dropdownOption"),i=c(this);Q.removeClass("dropdownOptionSelected");i.addClass("dropdownOptionSelected");A()}});var k=c(document.body);k.append(r);H=false;g.data("c21boxdropdown",{target:g,jDropdown:r,jOptionViewport:x,jOptionContainer:I,jOptions:D})}})},hidden:function(){var f=c(this).data("c21boxdropdown"),e=f.jDropdown;if(e.attr("showing")=="false"){return true}else{return false}},destroy:function(){return this.each(function(){var f=c(this),e=f.data("c21boxdropdown");c(window).unbind(".c21boxdropdown");e.c21boxdropdown.remove();f.removeData("c21boxdropdown")})}};c.fn.c21boxdropdown=function(e){if(a[e]){return a[e].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof e==="object"||!e){return a.init.apply(this,arguments)}else{c.error("Method "+e+" does not exist on jQuery.c21boxdropdown")}}}})(jQuery);(function(c){var d=[];function b(){setTimeout(function(){c.each(d,function(f,h){var e="#"+h,g="."+h+"_input";if(c(g).length==0){c(e).remove()}})},800)}var a={init:function(f,e){return this.each(function(){var g=c(this),N=g.data("c21textdropdown");if(!N){b();var o="generated_"+(Math.floor(Math.random()*1000)).toString();d.push(o);var q=c("<div />",{id:o,html:['<div class="dropdownHeader">','<div class="dropdownHeaderContainer">','<div class="background"></div>','<input type="text" class="foreground" />',"</div>","</div>",'<div class="dropdownOptionViewport">','<div class="dropdownOptionContainer">',"</div>","</div>"].join(""),"class":"dropdownBox"}),u=q.find(".dropdownHeader"),A=q.find(".dropdownHeaderContainer"),x=c(['<div class="c21textdropdown">','<div class="background"></div>','<input type="text" class="foreground" />',"</div>"].join("")),L=A.find("input.foreground"),m=A.find("div.background"),G=x.find("input.foreground"),O=x.find("div.background"),w=q.find(".dropdownOptionViewport"),I=q.find(".dropdownOptionContainer"),i=function(P){L.val(P);G.val(P);if(g.val()!=P){H=true}g.val(P)},h=function(){var Q=w.find(".dropdownOptionSelected"),W=w.scrollTop(),V=w.height(),S=W+V,P=Q.position(),R=Q.outerHeight(),U=P.top,T=U+R;if(T>S){w.scrollTop(T-V)}if(U<W){w.scrollTop(U)}},K=function(){var P=q.find(".dropdownOptionSelected");P.removeClass("dropdownOptionSelected");if(P.hasClass("dropdownHeader")){var Q=q.find(".dropdownOptionViewport .dropdownOption:last")}else{var Q=P.prev();if(Q.length==0){if(q.find(".dropdownHeader.dropdownOption").length!=0){Q=q.find(".dropdownOption:first")}else{Q=q.find(".dropdownOption:last")}}}Q.addClass("dropdownOptionSelected");if(!Q.hasClass("dropdownHeader")){h()}},s=function(){var Q=q.find(".dropdownOptionSelected");Q.removeClass("dropdownOptionSelected");if(Q.hasClass("dropdownHeader")){var P=q.find(".dropdownOptionViewport .dropdownOption:first")}else{var P=Q.next();if(P.length==0){P=q.find(".dropdownOption:first")}}P.addClass("dropdownOptionSelected");if(!P.hasClass("dropdownHeader")){h()}},t=function(P){if(!J){return}var Q=P.keyCode;if((Q==13)||(Q==32)){M();return false}else{if(Q==38){K();return false}else{if(Q==39||Q==9){}else{if(Q==40){s();return false}}}}},v=function(Q){return{text:Q,minValue:Q};var P=parseInt(Q.replace(/[^0-9.]/gi,""),10);if(isNaN(P)){P=0}if(P==0){return{text:window.websiteCode=="ESP"?"Todos":"Any",minValue:""}}else{return{text:P.toString(),minValue:P.toString()}}},y=function(){var Q=L.val(),P=v;if(e&&e.formatter){P=e.formatter}if(Q!=""){q.find(".dropdownOptionSelected").removeClass("dropdownOptionSelected");q.find(".dropdownHeader").addClass("dropdownOption dropdownOptionSelected")}else{if(q.find(".dropdownHeader.dropdownOptionSelected").length>0){q.find(".dropdownHeader").removeClass("dropdownOption dropdownOptionSelected");s()}}},F=function(){m.addClass("dropdownHintHidden");O.addClass("dropdownHintHidden")},l=function(){m.removeClass("dropdownHintHidden");O.removeClass("dropdownHintHidden")},J=false,H=false,k=function(){var S=7,Q=x.offset(),P=x.width(),R={top:Q.top-S+1,left:Q.left-S,right:P+S};if(Q.left==0){return}q.css({top:0,left:0});q.offset(R);J=true;q.attr("showing","true")},r=function(){var P=J;J=false;q.offset({top:-9999,left:-9999}).show();q.attr("showing","false");if(H){H=false;if(P&&e){if(e.onBlurAndChange){e.onBlurAndChange(g.val())}}}if(e){if(e.onBlur&&P){e.onBlur(g.val())}}},M=function(){var Q=w.find(".dropdownOptionSelected"),R=Q.attr("value"),P=Q.text();if(Q.length!==0){i(P);F()}else{G.val(L.val())}L.get(0).blur();r()},p=function(){var P=L.val();if(P==""){l()}else{F()}},z=false;if(e){if(e.dropdownClass){q.addClass(e.dropdownClass)}if(e.inputClass){x.addClass(e.inputClass)}m.text(e.textHint);O.text(e.textHint);L.keyup(function(Q){var R=L.val(),S=Q.keyCode;if((S==13)||(S==32)){return}else{if(S==38){return}else{if(S==40){return}}}y();var P=R.replace(/[^0-9,.$]/g,"");if(P!=R){i(P)}else{G.val(R);if(g.val()!=R){H=true}g.val(R)}});if(e.tabIndex){L.attr("tabindex",e.tabIndex)}}c(document.body).keydown(t);x.addClass(o+"_input");L.val(g.val());G.val(g.val());p();if(e&&e.maxLength){L.attr("maxlength",e.maxLength.toString())}r();var E=true,C=false;var n=function(){c(document).trigger("hideDropdowns");k();if(!C){C=true;L.focus();C=false}F();if(E){E=false}};G.focus(n);L.focus(n);G.mousedown(function(P){z=true});c(document).bind("hideDropdowns",function(){r();p()});L.blur(function(){setTimeout(function(){if(!z){r()}z=false},15);p()});q.click(function(P){P.stopPropagation()});q.mousedown(function(P){z=true;P.stopPropagation()});c("html").mousedown(function(){setTimeout(function(){if(!z){r()}z=false},10)});f.find("option").each(function(R,T){var S=c(T),U=S.attr("value"),P=S.text(),Q=c("<div />",{"class":"dropdownOption",text:P,value:U});Q.disableSelection();I.append(Q);if(R%2==0){Q.addClass("dropdownOptionOdd")}});c(window).resize(function(){if(J){k()}});g.after(x).hide();var B=q.find(".dropdownOption"),D=B.eq(0);B.mouseover(function(){var Q=q.find(".dropdownOption"),P=c(this);Q.removeClass("dropdownOptionSelected");P.addClass("dropdownOptionSelected")}).mouseup(M);u.click(function(){var R=c(this);if(R.hasClass("dropdownOption")){var Q=q.find(".dropdownOption"),P=c(this);Q.removeClass("dropdownOptionSelected");P.addClass("dropdownOptionSelected");y()}});var j=c(document.body);j.append(q);H=false;g.data("c21textdropdown",{target:g,jDropdown:q,jOptionViewport:w,jOptionContainer:I,jOptions:B})}})},hidden:function(){var f=c(this).data("c21textdropdown"),e=f.jDropdown;if(e.attr("showing")=="false"){return true}else{return false}},destroy:function(){return this.each(function(){var f=c(this),e=f.data("c21textdropdown");c(window).unbind(".c21textdropdown");e.c21textdropdown.remove();f.removeData("c21textdropdown")})}};c.fn.c21textdropdown=function(e){if(a[e]){return a[e].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof e==="object"||!e){return a.init.apply(this,arguments)}else{c.error("Method "+e+" does not exist on jQuery.c21textdropdown")}}}})(jQuery);(function(c){var d=[];function b(){setTimeout(function(){c.each(d,function(f,h){var e="#"+h,g="."+h+"_input";if(c(g).length==0){c(e).remove()}})},800)}var a={init:function(e){return this.each(function(){var h=c(this),P=h.data("c21dropdown");if(!P){b();var f="generated_"+(Math.floor(Math.random()*1000)).toString();d.push(f);var D=c("<div />",{id:f,html:['<div class="dropdownHeader">','<div class="dropdownHeaderContainer">','<div class="dropdownTo">to</div>','<div class="dropdownHeaderStart">','<div class="background"></div>','<input type="text" class="foreground" />',"</div>",'<div class="dropdownHeaderEnd">','<div class="background"></div>','<input type="text" class="foreground" />',"</div>","</div>","</div>",'<div class="dropdownOptionViewport">','<div class="dropdownOptionContainer">',"</div>","</div>"].join(""),"class":"dropdownBox"}),u=D.find(".dropdownHeader"),r=c(['<div class="selector smallSelector">',"<span></span>",'<input type="hidden" id="',e.baseName,'From" name="',e.baseName,'From" value="" />','<input type="hidden" id="',e.baseName,'To" name="',e.baseName,'To" value="" />',"</div>"].join("")),g=r.find("input").eq(0),p=r.find("input").eq(1),v=D.find(".dropdownHeaderStart input.foreground"),x=D.find(".dropdownHeaderStart div.background"),H=D.find(".dropdownHeaderEnd input.foreground"),I=D.find(".dropdownHeaderEnd div.background"),A=D.find(".dropdownOptionViewport"),l=D.find(".dropdownOptionContainer"),y=null,G=function(R,Q,S){r.find("span").text(R);var U=g.val(),T=p.val();if(U!=Q){k=true}if(T!=S){k=true}g.val(Q);p.val(S)},n=function(){var R=A.find(".dropdownOptionSelected"),X=A.scrollTop(),W=A.height(),T=X+W,Q=R.position(),S=R.outerHeight(),V=Q.top,U=V+S;if(U>T){A.scrollTop(U-W)}if(V<X){A.scrollTop(V)}},s=function(){v.val("");H.val("");x.removeClass("dropdownHintHidden");I.removeClass("dropdownHintHidden")},K=function(){var Q=D.find(".dropdownOptionSelected");Q.removeClass("dropdownOptionSelected");if(Q.hasClass("dropdownHeader")){var R=D.find(".dropdownOptionViewport .dropdownOption:last")}else{var R=Q.prev();if(R.length==0){if(D.find(".dropdownHeader.dropdownOption").length!=0){R=D.find(".dropdownOption:first")}else{R=D.find(".dropdownOption:last")}}}R.addClass("dropdownOptionSelected");if(!R.hasClass("dropdownHeader")){n()}},m=function(){var R=D.find(".dropdownOptionSelected");R.removeClass("dropdownOptionSelected");if(R.hasClass("dropdownHeader")){var Q=D.find(".dropdownOptionViewport .dropdownOption:first")}else{var Q=R.next();if(Q.length==0){Q=D.find(".dropdownOption:first")}}Q.addClass("dropdownOptionSelected");if(!Q.hasClass("dropdownHeader")){n()}},w=function(Q){if(!z){return true}var R=Q.keyCode;if((R==13)||(R==32)){F();return false}else{if(R==38){K();return false}else{if(R==39||R==9){}else{if(R==40){m();return false}}}}},j=function(U,R){var T=parseInt(U.replace(/[^0-9.]/gi,""),10),S=parseInt(R.replace(/[^0-9.]/gi,""),10);if(isNaN(T)){T=0}if(isNaN(S)){S=0}if((S!=0)&&(S<T)){var Q=S;S=T;T=Q}if(T==0){if(S==0){return{text:(y)?O(y):(window.websiteCode=="ESP"?"Todos":"Any"),minValue:"",maxValue:""}}else{return{text:"0 - "+S.toString(),minValue:"0",maxValue:S.toString()}}}else{if(S==0){return{text:T.toString()+"+",minValue:T.toString(),maxValue:""}}else{if(S==T){return{text:T.toString(),minValue:T.toString(),maxValue:S.toString()}}else{return{text:T.toString()+" - "+S.toString(),minValue:T.toString(),maxValue:S.toString()}}}}},q=function(T,R){var Q=j;if(e&&e.formatter){Q=e.formatter}var S=Q(T,R);G(S.text,S.minValue,S.maxValue)},L=function(){var R=v.val(),Q=H.val();if(R!=""||Q!=""){D.find(".dropdownOptionSelected").removeClass("dropdownOptionSelected");D.find(".dropdownHeader").addClass("dropdownOption dropdownOptionSelected")}else{D.find(".dropdownHeader").removeClass("dropdownOption dropdownOptionSelected");m()}q(R,Q)},N=function(S,R,Q){R.text(Q);S.blur(function(){if(S.val()==""){R.removeClass("dropdownHintHidden")}});S.focus(function(){R.addClass("dropdownHintHidden")});S.keyup(function(U){var V=S.val(),W=U.keyCode;if((W==13)||(W==32)){return}else{if(W==38){return}else{if(W==40){return}}}L();var T=V.replace(/[^0-9]/g,"");if(T!=V){S.val(T)}})},z=false,k=false,C=function(){var Q=r.offset(),R={top:Q.top+r.height(),left:Q.left};if(R.left==0){return}D.css({top:R.top,left:R.left,display:"block"});D.offset(R);D.attr("showing","true");z=true},o=function(){var Q=z;z=false;D.offset({top:-9999,left:-9999}).show();D.attr("showing","false");if(k){k=false;if(Q&&e){if(e.onBlurAndChange){e.onBlurAndChange(g.val(),p.val())}}}if(e){if(e.onBlur&&Q){e.onBlur(g.val(),p.val())}}},M=function(){if(z){o()}else{C()}},O=function(S){var R=S.attr("selectedDisplay"),Q=S.text(),T=(R)?R:Q;return T},F=function(){var Q=A.find(".dropdownOptionSelected"),R=Q.attr("value"),S=O(Q);if(Q.length!=0){if(e&&e.selectedVal=="max"){G(S,"",R)}else{G(S,R,"")}s()}o();v.get(0).blur();H.get(0).blur()},E=function(){t=true;c(document).trigger("hideDropdowns");C()},i=false;g.addClass(f+"_input");if(e){if(e.dropdownClass){D.addClass(e.dropdownClass)}if(e.selectBoxClass){r.addClass(e.selectBoxClass)}if(e.maxLength){v.attr("maxlength",e.maxLength.toString());H.attr("maxlength",e.maxLength.toString())}N(v,x,window.websiteCode=="ESP"?"Min":"Min");N(H,I,window.websiteCode=="ESP"?"Max":"Max");if(e.tabIndex){v.attr("tabindex",e.tabIndex);H.attr("tabindex",e.tabIndex+1)}}c(document.body).keydown(w);var t=false;v.focus(E);H.focus(E);r.click(function(Q){t=true;c(document).trigger("hideDropdowns");M();i=true});o();D.click(function(Q){Q.stopPropagation();i=false});c(document).bind("hideDropdowns",function(){if(!t){o()}t=false});c("html").click(function(){setTimeout(function(){if(!i){o()}i=false},10)});h.find("option").each(function(T,V){var U=c(V),X=U.attr("value"),Q=U.text(),S=U.attr("selectedDisplay"),W=U.attr("optionForAny"),R=c("<div />",{"class":"dropdownOption",text:Q,selectedDisplay:S,value:X});if(W=="true"){y=R}l.append(R);R.disableSelection();if(T%2==0){R.addClass("dropdownOptionOdd")}});h.after(r).hide();D.hover(function(){r.addClass("hover")},function(){r.removeClass("hover")}).mousedown(function(){r.addClass("active")}).mouseup(function(){r.removeClass("active")});var J=D.find(".dropdownOption"),B=J.eq(0);B.addClass("dropdownOptionSelected");F();J.mouseover(function(){var R=D.find(".dropdownOption"),Q=c(this);R.removeClass("dropdownOptionSelected");Q.addClass("dropdownOptionSelected")}).click(F);u.click(function(){var S=c(this);if(S.hasClass("dropdownOption")){var R=D.find(".dropdownOption"),Q=c(this);R.removeClass("dropdownOptionSelected");Q.addClass("dropdownOptionSelected");L()}});c(document.body).append(D);k=false;c(this).data("c21dropdown",{target:h,doFormat:q,jDropdown:D,jOptionViewport:A,jOptionContainer:l,jOptions:J})}})},hidden:function(){var f=c(this).data("c21dropdown"),e=f.jDropdown;if(e.attr("showing")=="false"){return true}else{return false}},setValue:function(h,f){var e=c(this),g=e.data("c21dropdown");g.doFormat(h,f)},destroy:function(){return this.each(function(){var f=c(this),e=f.data("c21dropdown");c(window).unbind(".c21dropdown");e.c21dropdown.remove();f.removeData("c21dropdown")})}};c.fn.c21dropdown=function(e){if(a[e]){return a[e].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof e==="object"||!e){return a.init.apply(this,arguments)}else{c.error("Method "+e+" does not exist on jQuery.c21dropdown")}}}})(jQuery);var c21feedback=(function(){var d=window.internationalization;function j(){$("#c21FeedbackOptions").find($("label.c21hoverstate")).each(function(){var r=$(this),p=r.attr("for"),q=r.find("#"+p);if(q.is(":checked")){r.addClass("checked")}else{r.removeClass("checked")}})}function i(){$("#c21FeedbackOptions").find($("label")).each(function(){var r=$(this),p=r.attr("for"),q;if(p){q=r.find("#"+p)}else{return}if(q.length==0){return}r.addClass("c21hoverstate");q.change(function(){j()});r.hover(function(){if(!q.attr("disabled")){r.addClass("hover")}},function(){r.removeClass("hover")})})}function b(){var r=$("#c21FeedbackRatingContent").val();var s=$("#c21FeedbackRatingDesign").val();var q=$("#c21FeedbackRatingEaseOfUse").val();var p=$("#c21FeedbackRatingOverall").val();$("#c21FeedbackRatingContentSlider .ctlSliderHandleText").mousedown(function(){r=$("#c21FeedbackRatingContent").val()});$("#c21FeedbackRatingContentSlider .ctlSliderHandleText").mouseleave(function(){if(r!=parseInt($(this).html())){Track.doEvent("Feedback","Change Ratings","Content",parseInt($(this).html()))}r=$("#c21FeedbackRatingContent").val()});$("#c21FeedbackRatingDesignSlider .ctlSliderHandleText").mousedown(function(){s=$("#c21FeedbackRatingDesign").val()});$("#c21FeedbackRatingDesignSlider .ctlSliderHandleText").mouseleave(function(){if(s!=parseInt($(this).html())){Track.doEvent("Feedback","Change Ratings","Design",parseInt($(this).html()))}s=$("#c21FeedbackRatingDesign").val()});$("#c21FeedbackRatingEaseOfUseSlider .ctlSliderHandleText").mousedown(function(){q=$("#c21FeedbackRatingEaseOfUse").val()});$("#c21FeedbackRatingEaseOfUseSlider .ctlSliderHandleText").mouseleave(function(){if(q!=parseInt($(this).html())){Track.doEvent("Feedback","Change Ratings","Ease of Use",parseInt($(this).html()))}q=$("#c21FeedbackRatingEaseOfUse").val()});$("#c21FeedbackRatingOverallSlider .ctlSliderHandleText").mousedown(function(){p=$("#c21FeedbackRatingOverall").val()});$("#c21FeedbackRatingOverallSlider .ctlSliderHandleText").mouseleave(function(){if(p!=parseInt($(this).html())){Track.doEvent("Feedback","Change Ratings","Overall",parseInt($(this).html()))}p=$("#c21FeedbackRatingOverall").val()})}function c(){var u="";var s="";var q=$("#c21FeedbackUserName").val();var y=$("#c21FeedbackUserEmail").val();var w=$("#c21FeedbackCommentsSubject").val();var v=$("#c21FeedbackComments").val();var t=$("#c21FeedbackPurpose").val();var r="";if($("#c21FeedbackRealtorCheckboxYes").attr("checked")){r="Y"}else{if($("#c21FeedbackRealtorCheckboxNo").attr("checked")){r="N"}}var A="";if($("#c21FeedbackSatisfactionCheckboxYes").attr("checked")){A="Y"}else{if($("#c21FeedbackSatisfactionCheckboxNo").attr("checked")){A="N"}}var x=$("#c21FeedbackRatingContent").val();var p=$("#c21FeedbackRatingDesign").val();var B=$("#c21FeedbackRatingEaseOfUse").val();var z=$("#c21FeedbackRatingOverall").val();if(x=="3"&&p=="3"&&B=="3"&&z=="3"){x="";p="";B="";z=""}if(q!=null&&q!=""){u="Name";s="Y"}if(y!=null&&y!=""){if(s){u=u+","}u=u+"Email";s="Y"}if(r!=null&&r!=""){if(s){u=u+","}u=u+"Real Estate Professional";s="Y"}if(w!=null&&w!=""){if(s){u=u+","}u=u+"Comments Subject";s="Y"}if(v!=null&&v!=""){if(s){u=u+","}u=u+"Comments";s="Y"}if(t!=null&&t!=""){if(s){u=u+","}u=u+"Purpose of Visit";s="Y"}if(A!=null&&A!=""){if(s){u=u+","}u=u+"Satisfaction";s="Y"}if(x!=null&&x!=""&&x!="3"){if(s){u=u+","}u=u+"Rating Content";s="Y"}if(p!=null&&p!=""&&p!="3"){if(s){u=u+","}u=u+"Rating Design";s="Y"}if(B!=null&&B!=""&&B!="3"){if(s){u=u+","}u=u+"Rating Ease of Use";s="Y"}if(z!=null&&z!=""&&z!="3"){if(s){u=u+","}u=u+"Rating Overall";s="Y"}if(u!=null&&u!=""){Track.doEvent("Feedback","Form Abandonment",u)}}function h(){$("#c21FeedbackOptions").find($("select, input:checkbox, input:radio")).uniform();i();j();b();$("#c21FeedbackCommentsSubject").change(function(){Track.doEvent("Feedback","Change Comment Subject",$(this).val())});$("#c21FeedbackPurpose").change(function(){Track.doEvent("Feedback","Change Purpose of Visit",$(this).val())})}function e(){var V=$.client.browser;var J=$.client.os;var y=$("#c21FeedbackUserName").val();var H=$("#c21FeedbackUserEmail").val();var A="";if($("#c21FeedbackRealtorCheckboxYes").attr("checked")){A="Y"}else{if($("#c21FeedbackRealtorCheckboxNo").attr("checked")){A="N"}}var O=$("#c21FeedbackCommentsSubject").val();var U=$("#c21FeedbackComments").val();var Z=$("#c21FeedbackPurpose").val();var C="";if($("#c21FeedbackSatisfactionCheckboxYes").attr("checked")){C="Y"}else{if($("#c21FeedbackSatisfactionCheckboxNo").attr("checked")){C="N"}}var M=$("#c21FeedbackRatingContent").val();var z=$("#c21FeedbackRatingDesign").val();var L=$("#c21FeedbackRatingEaseOfUse").val();var q=$("#c21FeedbackRatingOverall").val();if(M=="3"&&z=="3"&&L=="3"&&q=="3"){M="";z="";L="";q=""}var E="";var B="";var x=window.screen.width;var t=window.screen.height;var D=$.cookie("JSESSIONID");var w=$("#myc21Username").html();var Y=$.cookie("c21.loc.LAST_SEARCH_STRING");if(Y==null){Y=""}var s=window.location.host;var N=m("AGENTS");if(N!=null&&N!=""){N="http://"+s+N}else{N=""}var I=m("PROPERTIES");if(I!=null&&I!=""){I="http://"+s+I}else{I=""}var u=m("OFFICES");if(u!=null&&u!=""){u="http://"+s+u}else{u=""}var W="";var K="";var aa=new Date();var p=$.cookie("c21.loc.visited");if(p!=null&&p.length>0){p=Date.parse(p,"yyyy/MM/dd HH:mm:ss");W=aa.getTime()-(new Date(p)).getTime();K=o(W);W=n(W)}var X=navigator.userAgent;var S=window.navigator.userLanguage||window.navigator.language;var Q=window.location.href;var P=window.location.hash;var F=portalAjax.getCookie("LAST_LIST_VIEW");if(F==null||F==""){F="Never set"}var T=$.browser.version;var v="";if(V=="chrome"){v=parseInt(document.defaultView.getComputedStyle(document.documentElement,null).width,10)/document.documentElement.clientWidth}else{if(V=="Firefox"){v=document.documentElement.clientWidth/window.innerWidth}else{if(V=="Explorer"){if(T>=8){v=window.screen.deviceXDPI/window.screen.logicalXDPI}else{var G=document.body;var R=document.body.getBoundingClientRect();v=(R.left-R.right)/G.offsetWidth}}else{v=parseInt(document.defaultView.getComputedStyle(document.documentElement,null).width,10)/document.documentElement.clientWidth}}}if((O==null||O.length==0)&&(U==null||U.length==0)&&(Z==null||Z.length==0)&&(C==null||C.length==0)&&(A==null||A.length==0)&&(y==null||y.length==0)&&(H==null||H.length==0)&&(M==null||M.length==0)&&(z==null||z.length==0)&&(L==null||L.length==0)&&(q==null||q.length==0)){alert(d.getString("Please fill in the Feeback form."));return}portalAjax.doViewEngineAjax("SendComments","/feedback.c21",$.param({submitted:"true",userName:y,userEmail:H,realEstateProfessional:A,commentsSubject:O,comments:U,purposeOfVisit:Z,satisfaction:C,ratingContent:M,ratingDesign:z,ratingEaseOfUse:L,ratingOverall:q,clientBrowser:V,clientOS:J,clientIPAddress:E,clientscreenwidth:x,clientscreenheight:t,clientgeolocation:B,clientsessionid:D,myc21username:w,myc21email:"",clientlastsearch:Y,clientlastsearchagents:N,clientlastsearchproperties:I,clientlastsearchoffices:u,clienttimeonsite:W,clienttimeonsiteString:K,clientnavuseragent:X,clientnavlanguage:S,clientSourceDomain:s,clientSourceURL:Q,clientSourceHash:P,clientBrowserZoom:v,listviewcookie:F}),{cache:false});modalWindows.closeWindow()}function k(){if($("#c21FeedbackRealtorCheckboxYes").attr("checked")){$("#c21FeedbackRealtorCheckboxNo").attr("checked",false)}else{$("#c21FeedbackRealtorCheckboxNo").attr("checked",true)}j();$.uniform.update()}function a(){if($("#c21FeedbackRealtorCheckboxNo").attr("checked")){$("#c21FeedbackRealtorCheckboxYes").attr("checked",false)}else{$("#c21FeedbackRealtorCheckboxYes").attr("checked",true)}j();$.uniform.update()}function g(){if($("#c21FeedbackSatisfactionCheckboxYes").attr("checked")){$("#c21FeedbackSatisfactionCheckboxNo").attr("checked",false)}else{$("#c21FeedbackSatisfactionCheckboxNo").attr("checked",true)}j();$.uniform.update()}function f(){if($("#c21FeedbackSatisfactionCheckboxNo").attr("checked")){$("#c21FeedbackSatisfactionCheckboxYes").attr("checked",false)}else{$("#c21FeedbackSatisfactionCheckboxYes").attr("checked",true)}j();$.uniform.update()}function n(p){return Math.round(p/1000)}function o(r){var w=Math.round((r/1000)%60);var u=Math.round(((r/1000)/60)%60);var p=Math.round((((r/1000)/60)/60)%24);var q=Math.floor((w%31536000)/86400);var v=0;var t=0;var s=0;if(w<10){v="0"+w}else{v=""+w}if(u<10){t="0"+u}else{t=""+u}if(p<10){s="0"+p}else{s=""+p}if(q==0){if(p==0){return t+":"+v}else{return s+":"+t+":"+v}}else{return q+" days, "+s+":"+t+":"+v}}function m(t){var r=null;if(t==null||$.trim(t).length<=0){return null}r=portalAjax.getCookie("LAST_"+t);if(r==null||r=="null"||$.trim(r).length<=0){return null}r=r.replace(/__CANONICAL=[^&]+(&|$)/,"");r=r.replace(/SUBVIEW=[^&]+(&|$)/,"");if(r.indexOf("__HANDOFF")!=-1){r=r.replace("__HANDOFF=1","");return r}var q="/search.c21?"+r;var u="/search.c21?";var p={};var s=1;$.each(c21Helpers.queryToJSON(q.split("?")[1]),function(w,v){p[w.toLowerCase()]=v;if(s==1){u=u+w.toLowerCase()+"="+v}else{u=u+"&"+w.toLowerCase()+"="+v}s++});return u}function l(q,p){if(q.value.length>p){while(q.value.length>p){q.value=q.value.substring(0,4000)}alert("Your comment has been truncated!\nComment has a limit of 4000 char(s).")}}return{initialize:h,submitFeedback:e,realtorCheckboxYesClicked:k,realtorCheckboxNoClicked:a,satisfactionCheckboxYesClicked:g,satisfactionCheckboxNoClicked:f,gaTrackFormAbandonment:c,commentLimit:l}}());(function(d){function c(i,m){var k=i.handle.width(),g=i.slider.width()-5,l=parseInt(m)-1,h=i.settings.max-i.settings.min,f=l/h,j=(g*f)-(k/2);return j}function e(j,m){var l=m.originalEvent.changedTouches;if(l){var k=l[0].clientX}else{var k=m.pageX}var i=j.slider.offset(),o=i.left,q=j.slider.width()-5,n=o+q,r=j.handle.width(),h=j.settings.max-j.settings.min,g;if(k<o){g=o}else{if(k>n){g=n}else{g=k}}var f=1+((g-o)/q)*h,p=Math.round(f);return{value:p,freemousePosition:g-o-(r/2)}}function a(f,i,h){var g=c(f,i);f.handleText.text(i);if(h){f.handle.stop().animate({left:g},400)}else{f.handle.css({left:g})}f.target.val(i)}var b={init:function(f){return this.each(function(){var k=d(this),i=d.extend({value:null,min:1,max:5,freemouse:true,snap:true,animate:true},f),j=k.data("c21slider");if(!j){var j={target:k,settings:i};j.slider=d('<div class="ctlSliderContainer" />'),j.handle=d('<div class="ctlSliderHandle" />');j.handleText=d('<div class="ctlSliderHandleText" />');j.handle.append(j.handleText);j.slider.append(j.handle);var h=false,n=false,g=false;j.handle.on({"touchstart.c21slider mousedown.c21slider":function(o){h=true;o.preventDefault();return false},selectstart:function(){return false}});function m(o){var p=e(j,o);a(j,p.value,i.animate)}j.slider.on({"touchstart.c21slider":function(){n=true;g=true},"touchmove.c21slider":function(){if(!n){return}g=true},"touchend.c21slider":function(o){if(n){return}n=false;if(g){return}m(o)},"click.c21slider":function(o){m(o)}});d("body").on({"touchmove.c21slider mousemove.c21slider":function(o){if(!h){return}var p=e(j,o);if(i.freemouse){j.handleText.text(p.value);j.target.val(p.value);j.handle.css({left:p.freemousePosition})}else{a(j,p.value,i.animate)}},"touchend.c21slider mouseup.c21slider":function(o){if(!h){return}h=false;if(i.freemouse){if(i.snap){var p=k.val();a(j,p,i.animate)}}o.preventDefault();return false}});k.after(j.slider);var l=(i.value==null)?k.val():i.value;a(j,l);d(this).data("c21slider",j)}})},destroy:function(){return this.each(function(){var g=d(this),f=g.data("c21slider");d("body").unbind(".c21slider");f.c21slider.remove();g.removeData("c21slider")})}};d.fn.c21slider=function(f){if(b[f]){return b[f].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof f==="object"||!f){return b.init.apply(this,arguments)}else{d.error("Method "+f+" does not exist on jQuery.c21slider")}}}})(jQuery);(function(e,c,a,g){var d="badform",f={};function b(i,h){this.element=i;this.settings=e.extend({},f,h);this._defaults=f;this._name=d;this.init()}e.extend(b.prototype,{init:function(){var h=e(this.element),i=true;h.find("input, select").each(function(){var j=e(this),l=j.attr("type"),k=h.find(".btnSubmit");j.enter(function(){k.click()});if(i&&l!="hidden"){i=false}})}});e.fn[d]=function(h){this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))}});return this}})(jQuery,window,document);var g_MyPlaces=[];var myc21Places=new function(){var n=window.internationalization;function g(){$("#myPlacesWindow").find($("label.c21hoverstate")).each(function(){var x=$(this),v=x.attr("for"),w=x.find("#"+v);if(w.is(":checked")){x.addClass("checked")}else{x.removeClass("checked")}})}this.getPlaces=function(){return g_MyPlaces};function a(){$("#myPlacesWindow").find($("label")).each(function(){var x=$(this),v=x.attr("for"),w;if(v){w=x.find("#"+v)}else{return}if(w.length==0){return}x.addClass("c21hoverstate");w.change(function(){g()});x.hover(function(){if(!w.attr("disabled")){x.addClass("hover")}},function(){x.removeClass("hover")})})}function t(v){portalAjax.doViewEngineAjax("deletemyplace","/myc21.c21",$.param({itemId:v}),{cache:false})}function h(v){var w=$("#modalModalContainer");w.find(".address").text(v);$("#panelDeleteConfirm").hide();$("#panelValidationFailed").hide();$("#panelMaxPlacesMsg").hide();$("#panelAddressConfirm").hide();$("#panelDestinationNoMatch").show();$("#myPlacesContainer").css("opacity","0.5");w.fadeIn()}function s(){var v=$("#modalModalContainer");$("#panelDestinationNoMatch").hide();$("#panelDeleteConfirm").hide();$("#panelMaxPlacesMsg").hide();$("#panelAddressConfirm").hide();$("#panelValidationFailed").show();$("#myPlacesContainer").css("opacity","0.5");v.fadeIn()}function p(w){var x=$("#modalModalContainer");$("#deletePlaceID").val(w);var v=$("#savedPlaceRow_"+w+" .savedPlaceName").text()+" "+$("#savedPlaceRow_"+w+" .savedPlaceAddr").text();$("#panelDeleteConfirm .address").text(v);$("#panelDestinationNoMatch").hide();$("#panelValidationFailed").hide();$("#panelMaxPlacesMsg").hide();$("#panelAddressConfirm").hide();$("#panelDeleteConfirm").show();$("#myPlacesContainer").css("opacity","0.5");x.fadeIn()}function e(){var v=$("#modalModalContainer");$("#panelDestinationNoMatch").hide();$("#panelDeleteConfirm").hide();$("#panelValidationFailed").hide();$("#panelAddressConfirm").hide();$("#panelMaxPlacesMsg").show();$("#myPlacesContainer").css("opacity","0.5");v.fadeIn()}function l(w,y,v){var x=$("#modalModalContainer");$("#addressLatitude").val(w);$("#addressLongitude").val(y);$("#addressOkButton").removeAttr("disabled");$("#addressCancelButton").removeAttr("disabled");j(w,y);$("#panelDestinationNoMatch").hide();$("#panelValidationFailed").hide();$("#panelMaxPlacesMsg").hide();$("#panelDeleteConfirm").hide();$("#panelAddressConfirm").show();$("#addressConfirmLabel").text(v);$("#myPlacesContainer").css("opacity","0.5");x.fadeIn()}function j(z,A){var y=null;var B=Microsoft.Maps;var w=$("#currentPinNumber").val();B.loadModule("Microsoft.Maps.Overlays.Style",{callback:function(){y=new B.Map(document.getElementById("addressConfirmMap"),{credentials:Century21.Maps.bingmapCredentials,mapTypeId:"r",center:new B.Location(z,A),zoom:12,enableClickableLogo:false,enableSearchLogo:false,customizeOverlays:true,showBreadcrumb:false,showCopyright:false,showMapTypeSelector:false})}});var v=y.getCenter();var x=new Microsoft.Maps.Pushpin(v,{typeName:"IconMapPin savedPlaceColor  IconPin"+w+" mapPlace_"+w,text:" ",height:30,width:28,textOffset:new Microsoft.Maps.Point(0,0),anchor:new Microsoft.Maps.Point(9,27),offset:new Microsoft.Maps.Point(0,0),icon:"/images/clear.gif"});y.entities.push(x)}this.GeocodeCallbackSavePlace=function(v){if(v&&v.resourceSets&&v.resourceSets.length>0&&v.resourceSets[0].resources&&v.resourceSets[0].resources.length>0){var w=v.resourceSets[0].resources[0].point.coordinates;centerPoint=new Microsoft.Maps.Location(w[0],w[1]);l(w[0],w[1],v.resourceSets[0].resources[0].address.formattedAddress)}else{h($("#placeaddress").val());return}};function o(x){if(x!=null&&x!=""&&x.indexOf("<script>")!=-1&&x.indexOf("<\/script>")!=-1){h($("#placeaddress").val());return}var w=$("#placename").val();var v=$("#placeaddress").val();if(v==n.getString("Ex. 123 North Place, 85001")||w==n.getString("Ex. My Work, School, etc.")){s();return}if((v==$("#selectedAddress").val())&&($("#selectedLatitude").val()!="")&&($("#selectedLongitude").val()!="")){r($("#selectedLatitude").val(),$("#selectedLongitude").val());return}window.g_pageLiquidLayout.getMap().geocodeAddressAndSavePlace(x)}function r(z,A){var x=$("#placename").val();var C=$("#placeaddress").val();var v=$("#placeradius").val();var B=$("#selectedPlaceID").val();var w=$("#currentPinNumber").val();var y=$("#placeactive").val();portalAjax.doViewEngineAjax("savemyplace","/myc21.c21",$.param({itemid:B,addresstext:x,addressname:C,surroundingradius:v,pinnumber:w,active_yn:y,latitude:z,longitude:A}),{cache:false});modalWindows.closeWindow()}function m(){var x=$("#placename").val();var A=$("#placeaddress").val();var v=$("#placeradius").val();var z=$("#selectedPlaceID").val();var w=$("#currentPinNumber").val();var y=$("#placeactive").val();if((z==null||z=="")&&g_MyPlaces.length>=10){e();return}if(x==null||x==""||A==null||A==""||v==null||v==""||w==null||w==""){s();return}o(A)}function i(w){Track.doEvent("My Places Selector","Activate Place");portalAjax.doViewEngineAjax("activatemyplace","/myc21.c21",$.param({itemid:w}),{cache:false});$("#placeactive_"+w).val("Y");$("#savedPlaceRow_"+w+" .savedPlaceAddress").removeClass("inactive");$("#savedPlaceRow_"+w+" .savedPlaceColor").removeClass("IconPinGray");var v=$("#savedPlaceRow_"+w+" .placePinNumber").val();$("#savedPlaceRow_"+w+" .savedPlaceColor").addClass("IconPin"+v)}function u(w){Track.doEvent("My Places Selector","Deactivate Place");portalAjax.doViewEngineAjax("deactivatemyplace","/myc21.c21",$.param({itemid:w}),{cache:false});$("#placeactive_"+w).val("N");$("#savedPlaceRow_"+w+" .savedPlaceAddress").addClass("inactive");var v=$("#savedPlaceRow_"+w+" .placePinNumber").val();$("#savedPlaceRow_"+w+" .savedPlaceColor").removeClass("IconPin"+v);$("#savedPlaceRow_"+w+" .savedPlaceColor").addClass("IconPinGray")}function d(z,x){var v=1;if(x==null||x==""||parseInt(x)<=0||parseInt(x)>=11){v=1}else{v=parseInt(x)+1}portalAjax.doViewEngineAjax("changemyplacepincolor","/myc21.c21",$.param({itemid:z,pinnumber:v}),{cache:false});var w=$("#pincolor_"+z).val();$("#savedPlaceRow_"+z+" .savedPlaceColor").removeClass("IconPin"+w);$("#savedPlaceRow_"+z+" .savedPlaceColor").addClass("IconPin"+v);$("#pincolor_"+z).val(v);if($("#selectedPlaceID").val()==z){var w=$("#currentPinNumber").val();$(".addPlaceNextPin").removeClass("IconPin"+w);var y=parseInt(v);$(".addPlaceNextPin").addClass("IconPin"+y);$("#currentPinNumber").val(y)}}this.detectEnterKey=function(w){var v="";if(window.event){v=window.event.keyCode}else{if(w){v=w.which}}if(v==13){$(".submitButton").click()}};function q(){if($("#placename").hasClass("defaulttext")){$("#placename").val("");$("#placename").removeClass("defaulttext")}}function k(){if($("#placeaddress").hasClass("defaulttext")){$("#placeaddress").val("");$("#placeaddress").removeClass("defaulttext")}}this.initialize=function(){$("#myPlacesWindow").find($("select, input:radio")).uniform();a();g();if($("#myc21Username").text()!=null&&$("#myc21Username").text()!=""){$(".placesMyC21Info.inactive").hide();$(".placesMyC21Info.active").show();$(".myPlacesTitle").html(n.getString("My Places:"))}else{$(".placesMyC21Info.inactive").show();$(".placesMyC21Info.active").hide();$(".myPlacesTitle").html(n.getString("My Places"))}if($("#selectedPlaceID").val()==null||$("#selectedPlaceID").val()==""){$(".addPlaceButton").hide();b()}else{f($("#selectedPlaceID").val())}$(".savedPlaceDelete").click(function(){Track.doEvent("My Places Selector","Delete Place");var v=$(this).attr("id");aRecordParts=v.split("_"),strPlaceId=aRecordParts[1];if(strPlaceId!=null&&strPlaceId!=""){p(strPlaceId)}});$("#deleteCancelButton").click(function(){Track.doEvent("My Places Selector","Cancel Delete Place");$("#modalModalContainer").fadeOut();$("#myPlacesContainer").css("opacity","1")});$("#deleteOkButton").click(function(){Track.doEvent("My Places Selector","Confirm Delete Place");if($("#deletePlaceID").val()==null||$("#deletePlaceID").val()==""){return false}t($("#deletePlaceID").val());$("#modalModalContainer").fadeOut();$("#myPlacesContainer").css("opacity","1")});$(".savedPlaceEdit, .savedPlaceAddress").click(function(){Track.doEvent("My Places Selector","Edit Place")});$(".savedPlaceEdit, .savedPlaceAddress, .savedPlaceRow .savedPlaceColor").click(function(){var v=$(this).attr("id");aRecordParts=v.split("_"),strPlaceId=aRecordParts[1];c(strPlaceId)});$(".c21MyPlaceCheckbox").click(function(){var v=$(this).attr("id");aRecordParts=v.split("_"),strPlaceId=aRecordParts[1];if(strPlaceId!=null&&strPlaceId!=""){if($(this).attr("checked")){i(strPlaceId)}else{u(strPlaceId)}}});$(".savedPlaceRow .savedPlaceColor").click(function(){Track.doEvent("My Places Selector","Change Pin Color");var w=$(this).attr("id");if(w!=null&&w!=""){if($("#"+w).hasClass("IconPinGray")){return}}aRecordParts=w.split("_"),strPlaceId=aRecordParts[1];if(strPlaceId!=null&&strPlaceId!=""){var v=$("#pincolor_"+strPlaceId).val();d(strPlaceId,v)}});$(".submitButton").click(function(){Track.doEvent("My Places Selector","Save Place");m()});$("#closeModalModal").click(function(){$("#modalModalContainer").fadeOut();$("#myPlacesContainer").css("opacity","1")});if($("#placename").val()==""){$("#placename").addClass("defaulttext");$("#placename").val(n.getString("Ex. My Work, School, etc."))}if($("#placeaddress").val()==""){$("#placeaddress").addClass("defaulttext");$("#placeaddress").val(n.getString("Ex. 123 North Place, 85001"))}$("#placename").click(function(){q()});$("#placename").live("keypress",function(v){q()});$("#placeaddress").click(function(){k()});$("#placeaddress").live("keypress",function(v){k()});$("#addressCancelButton").click(function(){Track.doEvent("My Places Selector","Reject Geocoded Location");$("#addressOkButton").attr("disabled","disabled");$("#addressCancelButton").attr("disabled","disabled");$("#modalModalContainer").fadeOut();$("#myPlacesContainer").css("opacity","1")});$("#addressOkButton").click(function(){Track.doEvent("My Places Selector","Confirm/Save Geocoded Location");$("#addressOkButton").attr("disabled","disabled");$("#addressCancelButton").attr("disabled","disabled");r($("#addressLatitude").val(),$("#addressLongitude").val());$("#modalModalContainer").fadeOut();$("#myPlacesContainer").css("opacity","1")});document.onkeypress=this.detectEnterKey};this.refreshPlacesPinsOnMap=function(){this.getMyPlaces()};this.addPlace=function(w){var v=0;g_MyPlaces=[];$.each(w.mySavedPlaces,function(y,x){if(x.item_id==null||x.item_id==""){x.item_id="CART"+v}g_MyPlaces.push(x);v++});if(!window.g_pageLiquidLayout.getMap().isSurroundingAreaViewSelected()){$("#myPlacesToolInstructions").addClass("active").css("bottom",56+($("#bottomMapToolsDropDown").is(":visible")?160:0))}window.g_pageLiquidLayout.getMap().refreshMyC21Places();if((g_MyPlaces==null)||(g_MyPlaces!=null&&g_MyPlaces.length==0)){myc21Places.loadMyPlacesModal()}};this.addNewPlace=function(){myc21Places.loadMyPlacesModal()};this.getMyPlaces=function(){portalAjax.doViewEngineAjax("getmyplaces","/myc21.c21",$.param({}),{cache:false})};this.loadMyPlacesModal=function(v){if(v=="undefined"||v==null){v=""}portalAjax.doViewEngineAjax("loadmyplacesmodal","/myc21.c21",$.param({itemid:v}),{cache:false})};function c(w){$(".savedPlaceRow").each(function(){$(this).removeClass("selected")});if(w!=null&&w!=""){$("#savedPlaceRow_"+w).addClass("selected");var v=$("#currentPinNumber").val();$(".addPlaceNextPin").removeClass("IconPin"+v);var x=parseInt($("#pincolor_"+w).val());$(".addPlaceNextPin").addClass("IconPin"+x);$("#currentPinNumber").val(x);$(".addPlaceHeader").text(n.getString("Edit This Place:"));$(".addPlaceButton").show();$("#selectedPlaceID").val(w);$("#placename").val($("#addresstext_"+w).val());$("#placeaddress").val($("#addressname_"+w).val());$("#placeradius").val($("#radius_"+w).val());$("#placeactive").val($("#placeactive_"+w).val());$(".editPlaceName").text($("#addresstext_"+w).val());$("#placename").removeClass("defaulttext");$("#placeaddress").removeClass("defaulttext");$("#selectedAddress").val($("#addressname_"+w).val());$("#selectedLatitude").val($("#placelatitude_"+w).val());$("#selectedLongitude").val($("#placelongitude_"+w).val());$.uniform.update()}}function b(){var w=null;var x=$("#totalPlaces").val();if(x==null||x==""||parseInt(x)<=0||parseInt(x)>=11){w=1}else{var v=[false,false,false,false,false,false,false,false,false,false,false];$.each(g_MyPlaces,function(z,y){if(y.pincolor!=null&&y.pincolor!=""&&parseInt(y.pincolor)>0&&parseInt(y.pincolor)<=11){v[parseInt(y.pincolor)-1]=true}});$.each(v,function(y,z){if(z==false){if(w==null){w=y+1}}})}if(w==null||w==""){w=1}$(".addPlaceNextPin").addClass("IconPin"+w);$("#currentPinNumber").val(w)}function f(v){var w=parseInt($("#currentPinNumber").val());$(".addPlaceNextPin").addClass("IconPin"+w);$("#placeradius").val($("#selectedPlaceRadius").val());$("#savedPlaceRow_"+v).addClass("selected");$.uniform.update()}};(function(b){var a={init:function(c){return this.each(function(){var e=b(this),d=e.data("columns");if(!d){e.data("columns",{target:e,height:c.height||200,width:c.width||200});e.columns("update")}})},update:function(c){return this.each(function(){var h=b(this),g=h.data("columns"),d=h.find(".columnGroup"),i=b("<div />"),e=null;if(c){h.data("columns",c);g.height=c.height||200;g.width=c.width||200}function f(){var j=b("<div class='ui-column' style='float: left;' />");j.css({width:g.width});h.append(j);return j}i.append(d);h.find(".ui-column").remove();e=f();d.each(function(j,k){var l=b(k);e.append(l);if(e.height()>g.height){e=f();e.append(l)}});h.find(".ui-column").css({height:g.height})})}};b.fn.columns=function(c){if(a[c]){return a[c].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof c==="object"||!c){return a.init.apply(this,arguments)}else{b.error("Method "+c+" does not exist on jQuery.columns")}}}})(jQuery);(function(){var a=335;window.schoolSearch=new function(){var h=null,Z=window.internationalization,p=10,m=null,ac=null,q="";jQuery.fn.reverse=[].reverse;this.initialize=function(){if($("#drawTool").hasClass("selected")){$(".schoolsRefine").hide()}$(".schoolsRefine").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")});$(".schoolsRefine").find("#topRatedSchoolsRadio, #showYourSchoolsRadio").uniform();this.initSearchSchoolsButton();this.initTopRatedSchools();this.initYourSchools();T();U();l();window.g_pageLiquidLayout.onReady(function(){var al=$("#selectedSchoolIds"),am=al.val(),aq=ad(am);if(aq.length>0){var ap=$("#selectedSchoolBounds"),ao=ap.val().split(";"),ar=$("#selectedSchoolLocations"),an=ar.val().split(";"),at=[];$.each(aq,function(aw,az){var aC=ao[aw],aB=(aC=="null")?[]:t(aC),ax=an[aw],ay=ax.split(","),aA=parseFloat(ay[0]),av=parseFloat(ay[1]),au=new b(az,aA,av,aB);at.push(au)});g_pageLiquidLayout.getMap().setInitialSelectedSchools(at)}});$.uniform.update();if($("#SchoolsModalDiv").is(":visible")){G();if($("#modalTopRatedSchoolsRadio").attr("checked")){L()}else{N()}$.uniform.update();return}var aj=$("#schoolSearchInitialized"),ak=aj.attr("initialized");if(ak===undefined){R();$.uniform.update();aj.attr("initialized","Y")}this.initAttendanceRadiusBoundaryDialogs()};this.cleanPrograms=function(){var an=$("#programsFirstColumn"),al=$("#programsSecondColumn"),ak=$("#programsFirstColumn .programBox").reverse(),aj=an.outerHeight(true),am=aj/2,ao=0;ak.each(function(aq,at){var ap=$(at),ar=ap.outerHeight(true);if((ar+ao)<=am){ap.prependTo(al);ao+=ar}})};this.addLocation=function(aj){var ak=[];$.each(aj.points,function(ap,al){var ao=parseFloat(al[0]),an=parseFloat(al[1]),aq=al[2],am=new b(aq,ao,an);ak.push(am)});g_pageLiquidLayout.getMap().setSchools(ak)};this.editSchools=function(){if(!$("#SchoolsModalDiv").is(":visible")){if(!$("#topRatedSchoolsRadio").attr("checked")&&!$("#showYourSchoolsRadio").attr("checked")){L()}G();z("Y")}};this.removeAllSchools=function(al){var ak=$("#selectedSchoolIds"),aj=M(ak);$.each(aj,function(am,an){$("#schoolCheckbox_"+an).attr("checked",false)});ak.val("");$("#schoolRadiusSelector").val("1");$.uniform.update();ai(ak);if(al=="Y"){o()}};this.removeSchool=function(ak){if(ak==null||ak==""){return}var aj=$("#selectedSchoolIds");$("#schoolCheckbox_"+ak).attr("checked",false);E(aj,ak);ai(aj);$.uniform.update();o()};this.updateTooltipPosition=function(aj){var al=a+aj,am=$("#schoolSearchResults");if(am.length===0){return}var ap=am.position().top,ak=ap+am.height(),ao=$("#schoolsToolTip .contentTip"),an=ao.height();ao.stop().animate({top:al},{step:function(aq){if(aq>(ak-an)){ao.hide();return}if(aq<ap){ao.hide();return}ao.show()}})};function T(){var aj=a+parseInt($(".currentSrBox").css("height"))-parseInt($(".currentSrBox").css("min-height"));$("#schoolsToolTip .contentTip").animate({top:aj})}function ae(){$("#lqschooltypes").uniform({selectClass:"selector smallSelector"});var aj=false;function ak(){aj=true}function am(){Track.doEvent("Schools","School Results Dialog","Filter by Grades");an()}function al(){Track.doEvent("Schools","School Results Dialog","Filter by Total # of Students");an()}function ao(){Track.doEvent("Schools","School Results Dialog","Filter by Student/Teacher Ratio");an()}function an(){if(!aj){return}setTimeout(function(){var ap=false,aq=$("#lqschoolgrades");$.each(aq,function(ar,at){var au=$(at);if(!au.c21dropdown("hidden")){ap=true;return false}});if(ap){return}N();z("Y")},1000)}$("#lqschoolgrades").c21dropdown({maxLength:2,tabIndex:402,onBlurAndChange:ak,onBlur:am,dropdownClass:"lqdropdownCustomizations",selectBoxClass:"lqselectorCustomizations",baseName:"lqschoolgrades"});$("#lqschoolgrades").val($("#schoolgrade").val());$("#lqstudents").c21dropdown({maxLength:4,tabIndex:404,onBlurAndChange:ak,onBlur:al,dropdownClass:"lqdropdownCustomizations",selectBoxClass:"lqselectorCustomizations",baseName:"lqstudents",selectedVal:"max"});$("#lqstudentratio").c21dropdown({maxLength:3,tabIndex:406,onBlurAndChange:ak,onBlur:ao,dropdownClass:"lqdropdownCustomizations",selectBoxClass:"lqselectorCustomizations",baseName:"lqstudentratio",selectedVal:"max"})}this.initAttendanceRadiusBoundaryDialogs=function(){var al=$("#selectedSchoolIds").val();var aj=$("#schoolAttendanceRadius").val();var ak=$("#hasRadiusSchools").val();if(al!=null&&al.length>0){if((aj==null||aj=="")&&(ak!=null&&ak=="true")){window.schoolSearch.showRadiusSelectDialog();return}if(X()){I("Y");return}}};this.initTopRatedSchools=function(){$("#topRatedSchoolsRadio").click(function(){Track.doEvent("Schools","Mapping Page","Show Top Rated Schools");A();window.surroundingAreasMapping.closeWindow()})};this.initYourSchools=function(){$("#showYourSchoolsRadio").click(function(){Track.doEvent("Schools","Mapping Page","Show Your Schools");k();window.surroundingAreasMapping.closeWindow()})};function g(){$("#modalTopRatedSchoolsRadio").click(function(){Track.doEvent("Schools","School Results Dialog","Show Top Rated Schools");A()})}function af(){$("#modalShowYourSchoolsRadio").click(function(){Track.doEvent("Schools","School Results Dialog","Show Your Schools");k()})}function A(){S();if(!$(".schoolsRefine").hasClass("selected")){G()}z("Y");L()}function k(){S();if(!$(".schoolsRefine").hasClass("selected")){G()}z("Y");N()}function j(){var aj=$("#schoolName").val();if(aj==null||aj==""){$("#schoolName").val(Z.getString("School Name"));$("#schoolName").addClass("defaulttext");$("#schoolName").blur()}}function D(){if($("#schoolName").hasClass("defaulttext")){$("#schoolName").val("");$("#schoolName").removeClass("defaulttext")}}function O(al){var ak=$("#schoolName"),am=ak.val(),aj=am.length;if(al.type!="blur"){D()}if(am!=null&&(am!="School Name"&&am!=Z.getString("School Name"))){if(aj>2||aj==0||aj<q.length){N();if(am!=q){q=am;Track.doEvent("Schools","School Results Dialog","Filter by School Name");z("Y")}}}}function J(){var aj=$("#schoolName");q="";aj.click(D).bind("keyup blur",O);j()}function aa(){$("#lqschooltypes").change(function(){Track.doEvent("Schools","School Results Dialog","Filter by School Type",$("option:selected","#lqschooltypes").index());N();z("Y")})}function s(){$("#schoolSortTypes").uniform();$("#schoolSortTypes").change(function(){Track.doEvent("Schools","School Results Dialog","Change Sort by",$("option:selected","#schoolSortTypes").index());z("Y")})}function ah(){$(".schoolCheckbox:not(.uniformInit)").uniform().addClass("uniformInit")}function i(){$("#modalTopRatedSchoolsRadio, #modalShowYourSchoolsRadio").uniform();if($("#topRatedSchoolsRadio").attr("checked")){$("#modalTopRatedSchoolsRadio").attr("checked",true)}else{$("#modalShowYourSchoolsRadio").attr("checked",true)}$.uniform.update();if($("#topRatedSchoolsRadio").attr("checked")){$("#modalTopRatedSchoolsRadio").parent().parent().parent().addClass("selected")}else{$("#modalShowYourSchoolsRadio").parent().parent().parent().addClass("selected")}}function L(){$("#topRatedSchoolsRadio").attr("checked",true);$("#modalTopRatedSchoolsRadio").attr("checked",true);$.uniform.update();$("#modalTopRatedSchoolsRadio").parent().parent().parent().addClass("selected");$("#topRatedSchoolsRadio").parent().parent().parent().addClass("selected");$("#showYourSchoolsRadio").parent().parent().parent().removeClass("selected");$("#modalShowYourSchoolsRadio").parent().parent().parent().removeClass("selected");j()}function N(){$("#showYourSchoolsRadio").attr("checked",true);$("#modalShowYourSchoolsRadio").attr("checked",true);$.uniform.update();$("#showYourSchoolsRadio").parent().parent().parent().addClass("selected");$("#modalShowYourSchoolsRadio").parent().parent().parent().addClass("selected");$("#modalTopRatedSchoolsRadio").parent().parent().parent().removeClass("selected");$("#topRatedSchoolsRadio").parent().parent().parent().removeClass("selected");j()}function e(){$("#schoolsToolTip .moreSearchOptionsLink").click(function(){if($("#schoolsToolTip .moreSearchOptionsLink").hasClass("selected")){$("#schoolsToolTip .moreSearchOptionsLink").removeClass("selected");$("#schoolsToolTip .moreSearchOptionsSection").removeClass("selected");$("#schoolsToolTip .moreSearchOptionsLink").text(Z.getString("More School Options"));Track.doEvent("Schools","School Results Dialog","Hide More School Options")}else{$("#schoolsToolTip .moreSearchOptionsLink").addClass("selected");$("#schoolsToolTip .moreSearchOptionsSection").addClass("selected");$("#schoolsToolTip .moreSearchOptionsLink").text(Z.getString("Hide School Options"));Track.doEvent("Schools","School Results Dialog","Show More School Options");N()}});$("#schoolsToolTip .schoolFlagCheckbox").click(function(){Track.doEvent("Schools","School Results Dialog","Filter by Refined Search Options");N();var aj=$("#selectedSchoolFlags"),al=aj.val(),am=$(this).attr("id"),ak=am.substr(11);if(!$(this).attr("checked")){E(aj,ak)}else{u(aj,ak)}z("Y")});$("#schoolsToolTip .schoolFlagCheckbox").uniform();$.uniform.update()}this.hideMoreSearchOptions=function(){$("#schoolsToolTip .moreSearchOptionsLink").removeClass("selected");$("#schoolsToolTip .moreSearchOptionsSection").removeClass("selected");$("#schoolsToolTip .moreSearchOptionsLink").text(Z.getString("More School Options"))};function E(aj,am){var al=aj.val(),ak=f(al,am);aj.val(ak);return ak}function u(ak,aj){var am=ak.val(),al=V(am,aj);ak.val(al);return al}function M(ak){var al=ak.val(),aj=ad(al);return aj}function f(ak,aj){if(ak){if(ak.indexOf(aj+",")!=-1){ak=ak.replace(aj+",","")}else{if(ak.indexOf(","+aj)!=-1){ak=ak.replace(","+aj,"")}else{ak=ak.replace(aj,"")}}}return ak}function V(ak,aj){if(ak==null||ak==""){ak=aj}else{ak=ak+","+aj}return ak}function ad(aj){if((aj==null)||(aj=="")){return[]}else{return aj.split(",")}}function ai(ak){var aj=M(ak);g_pageLiquidLayout.getMap().setSelectedSchools(aj)}function n(){$(".viewSchoolDetailsLink").unbind(".schoolResults").bind("click.schoolResults",function(){var am=$(this).attr("id"),al=am.substr(22);Track.doEvent("Schools","School Results Dialog","View School Details");schoolSearch.loadSchoolDetails(al)});$(".schoolRecord").unbind(".schoolResults").bind("mouseenter.schoolResults",function(){$(this).addClass("hover")}).bind("mouseleave.schoolResults",function(){$(this).removeClass("hover")});$(".schoolCheckbox").unbind(".schoolResults").bind("click.schoolResults",function(){var al=$("#selectedSchoolIds"),an=al.val(),ao=$(this).attr("id"),am=ao.substr(15);if(!$(this).attr("checked")){E(al,am);ai(al);o()}else{u(al,am);ai(al);$("#currSelectedSchoolID").val(am);if(!ab(am)&&!X(am)){o();return}if(ab(am)){window.schoolSearch.showRadiusSelectDialog();return}if(X(am)){I("Y");return}}});var ak=$("#selectedSchoolIds"),aj=M(ak);$.each(aj,function(al,am){$("#schoolCheckbox_"+am).attr("checked",true)});$.uniform.update()}function ab(ak){var aj=$("#schoolAttendanceRadius").val();if((aj==null||aj=="")&&$("#schoolHasBoundary_"+ak).val()=="false"){return true}return false}function X(al){if($("#schoolLocationOverride").val()=="Y"||$("#schoolLocationOverride").val()=="N"){return false}if(al==null||al==""){var ak=$("#hasSchoolOutofBounds").val();if(ak!=null&&ak=="true"){return true}}else{var aj=$("#schoolOutOfBounds_"+al).val();if(aj=="true"){return true}}return false}function U(){$("#SchoolSearchBanner").click(function(){Track.doEvent("Schools","Mapping Page","Click Schools Flyout");L();G();z("Y")});var aj=a+parseInt($(".currentSrBox").css("height"))-parseInt($(".currentSrBox").css("min-height"));$("#SchoolSearchBanner").css({top:aj})}function Y(){var ak=new Date(),al=ak.getTime(),aj=$("#SchoolSearchBanner");portalAjax.setCookie("LAST_SCHOOLSEARCH_TS",al);if(aj.is(":visible")){$("#SchoolSearchBanner").animate({width:"0px"},function(){$(this).hide()})}}function l(){var aj=portalAjax.getCookie("LAST_SCHOOLSEARCH_TS");if(aj==null||aj==""){clearTimeout(ac);clearTimeout(m);ac=setTimeout(function(){$("#SchoolSearchBanner").css("width","0").show().animate({width:"184px"})},5000);m=setTimeout(Y,16000)}}this.showRadiusSelectDialog=function(){$("#SchoolModalRadiusSelect").show()};this.closeRadiusSelectDialog=function(){$("#SchoolModalRadiusSelect").hide();ag()};function ag(){var ak=$("#schoolRadiusSelector").val();$("#schoolAttendanceRadius").val(ak);$("#SchoolModalRadiusSelect").hide();Track.doEvent("Schools","Choose Attendance Radius Dialog","Select Radius",parseInt($("#schoolRadiusSelector option:selected").text()));var aj=parseInt(ak)*1.609344;g_pageLiquidLayout.getMap().setSchoolRadius(aj);var al=$("#currSelectedSchoolID").val();if(X(al)){I("Y")}else{o()}}function I(){$("#SchoolModalBoundary").show()}this.closeBoundarySelectDialog=function(aj){if(aj=="Y"){Track.doEvent("Schools","Use School Boundaries Dialog","Click 'Yes'")}else{Track.doEvent("Schools","Use School Boundaries Dialog","Click 'No'")}$("#SchoolModalBoundary").hide();d(aj)};function d(aj){$("#schoolLocationOverride").val(aj);$("#SchoolModalBoundary").hide();o()}this.showSchoolDeletionModal=function(){$("#SchoolModalDeletion").show()};this.closeDeletionSelectDialog=function(aj){$("#SchoolModalDeletion").hide();if(aj=="Y"){$("#selectedSchoolIds").val("");$("#schoolAttendanceRadius").val("");$("#schoolLocationOverride").val("");$("#currSelectedSchoolID").val("");S();F();if($("#searchWithinMap").attr("checked")){portalResults.changeLiquidMapSearchWithinMapFacet();g_pageLiquidLayout.getMap().clearSchools()}else{if($("#drawTool").hasClass("selected")){$(".schoolsRefine").hide();portalResults.changeSchools(null,null,null);g_pageLiquidLayout.getMap().clearSchools()}else{Track.doEvent("Hybrid Mapping","Left Lane","Refine and Update Location");portalResults.changeSearchLocation($("#refineText"))}}}else{if($("#searchWithinMap").attr("checked")){$("#searchWithinMap").attr("checked",false)}else{if($("#drawTool").hasClass("selected")){$("#drawTool").removeClass("selected");window.g_pageLiquidLayout.getMap().deselectDrawingTool()}}}};function o(){var ak=$("#selectedSchoolIds"),aj=M(ak),al=$("#schoolAttendanceRadius").val(),am=$("#schoolLocationOverride").val();portalResults.changeSchools(aj,al,am)}function z(aw){Y();var an=window.g_pageLiquidLayout.getMap(),ax=portalAjax.getParameters();if(aw==null){aw="N"}var au=$("#schoolName").val();if(au==null||au=="School Name"||au==Z.getString("School Name")){au=""}var ak=$("#schoolSortTypes").val();if(ak==null){ak=""}var ay=$("#lqschooltypes").val();if(ay==null){ay=""}var ao=$("#lqschoolgradesFrom").val(),ar=$("#lqschoolgradesTo").val(),az="";if(ao!=null&&ao!=""&&ar!=null&&ar!=""){az=ao+c21Helpers.GS2+ar}else{if(ao!=null&&ao!=""){if(ao.indexOf("_")==-1){az=ao+c21Helpers.GS2}else{az=ao}}else{if(ar!=null&&ar!=""){if(ar.indexOf("_")==-1){az=c21Helpers.GS2+ar}else{az=ar}}}}var aj=$("#lqstudentsFrom").val(),al=$("#lqstudentsTo").val(),aC="";if(aj!=null&&aj!=""&&al!=null&&al!=""){aC=aj+c21Helpers.GS2+al}else{if(aj!=null&&aj!=""){aC=aj+c21Helpers.GS2}else{if(al!=null&&al!=""){aC="0"+c21Helpers.GS2+al}}}var at=$("#lqstudentratioFrom").val(),av=$("#lqstudentratioTo").val(),aD="";if(at!=null&&at!=""&&av!=null&&av!=""){aD=at+c21Helpers.GS2+av}else{if(at!=null&&at!=""){aD=at+c21Helpers.GS2}else{if(av!=null&&av!=""){aD="0"+c21Helpers.GS2+av}}}var aA=$("#selectedSchoolIds").val();if(aA==null){aA=""}var aE=$("#selectedSchoolFlags").val();if(aE==null){aE=""}var aq="";if($("#showYourSchoolsRadio").attr("checked")){aq="UserSelected"}else{aq="TopRated"}var am=$("#schoolAttendanceRadius").val();if(am==null){am=""}var aB=$("#schoolLocationOverride").val();if(aB==null){aB=""}var ap="";if($("#searchLocationLIDS").val()!=null&&$("#searchLocationLIDS").val()!=""){ap=$("#searchLocationLIDS").val();if(ax.lid!=null&&ax.lid!=""&&ap!=ax.lid){if(ap.indexOf(ax.lid+",")==-1){ap=ap+","+ax.lid}}}else{ap=ax.lid}h=$.param({lid:ap,schoolname:au,sortby:ak,schooltype:ay,zoom:an.getZoom(),px:portalResults.getMapBoundaries(),rpp:p,grade:az,flags:aE,selectedschoolids:aA,searchtype:aq,schoolattendanceradius:am,schoollocationoverride:aB,numstudents:aC,studentratio:aD,submitted:true})+"&start=";portalAjax.doViewEngineAjax("loadschooldistrictmodal","/schoolsearch.c21",h+"0&geo="+aw,{cache:true,callback:function(){r();H();y()}})}function y(){x();$("#schoolSearchResults").scroll(function(){x()})}function x(){var am=$("#schoolSearchResults"),au=am.find(".schoolRecord"),ao=[];if(au.length>0){var ak=au.eq(0).outerHeight(),at=20,al=am.scrollTop()-at,an=(al<0)?0:al,aq=am.height(),aj=Math.floor(an/ak),av=an%ak,ar=Math.floor(aq/ak)+((av>40)?2:1),ap=au.splice(aj,ar);$.each(ap,function(ax,ay){var aw=$(ay),aA=aw.find("input.schoolID"),az=aA.val();ao.push(az)})}g_pageLiquidLayout.getMap().setSchoolsInView(ao)}function Q(al){var aj=(al)?al:$("#schoolSearchResults"),ak=aj.find(".schoolRecord").length;if(ak==0){return false}else{return((ak%p)==0)}}function W(){$("#schoolSearchResults").append("<div id='loadingMore'>Loading...</div>")}function B(){$("#loadingMore").remove()}function H(){if(!Q()){return}var aj=$("#schoolSearchResults").infinitescroll({triggerAt:300,page:1,dataHandler:function(ak){W();$.ajax({url:"/schoolsearch.c21",data:h+(ak.page*p).toString()+"&subView=loadschooldistrictmodal",dataType:"json",success:function(am){var al=$("<div />").html(am.window);aj.append(al);B();$("#noSchoolResults").hide();if(!Q(al)){ak.setReachedEnd()}else{ak.reset()}P();g_pageLiquidLayout.getMap().updateSchoolHoverState();x()}})}})}function R(){s();ae();aa();J();i();g();af();e();$.uniform.update()}function r(){var ak=$("#schoolsToolTip"),aj=$("#SchoolsModalDiv");if(ak.data("open")===undefined){ak.data("open",true);aj.show();ak.width(0).animate({width:370},{duration:500,easing:"easeInOutBack"})}P();g_pageLiquidLayout.getMap().showUnselectedSchools()}function P(){ah();n();$(".schoolCheckbox:not(.uniformInit)").uniform().addClass("uniformInit");$.uniform.update()}this.closeWindow=function(){F()};this.clearPropertySearchParams=function(){$("#selectedSchoolIds").val("");$("#schoolAttendanceRadius").val("");$("#schoolLocationOverride").val("")};function F(){var ak=$("#schoolsToolTip"),aj=$("#SchoolsModalDiv");ak.removeData("open");ak.animate({width:0},{duration:500,easing:"easeInOutBack",complete:function(){aj.hide()}});$(".schoolsRefine").removeClass("selected");g_pageLiquidLayout.getMap().hideUnselectedSchools()}this.clearSchoolSearchCriteria=function(){S()};function S(){$("#schoolName").val("");$(".schoolFlagCheckbox").attr("checked",false);$("#selectedSchoolFlags").val("");$("#lqschooltypes").val("");$("#schoolSortTypes").val("");$("#lqschoolgrades").val("");$("#lqschoolgradesFrom").val("");$("#lqschoolgradesTo").val("");$("#lqschoolgrades").c21dropdown("setValue","","");$("#lqstudents").val("");$("#lqstudentsFrom").val("");$("#lqstudentsTo").val("");$("#lqstudents").c21dropdown("setValue","","");$("#lqstudentratio").val("");$("#lqstudentratioFrom").val("");$("#lqstudentratioTo").val("");$("#lqstudentratio").c21dropdown("setValue","","")}function G(){$(".schoolsRefine").addClass("selected");$.uniform.update()}this.initSearchSchoolsButton=function(){$("#schoolsLiqMapButton").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")});$("#schoolsLiqMapButton").click(function(){if(!$(".schoolsRefine").hasClass("selected")){if(!$("#topRatedSchoolsRadio").attr("checked")&&!$("#showYourSchoolsRadio").attr("checked")){L()}window.surroundingAreasMapping.closeWindow();G();z("Y");Track.doEvent("Schools","Mapping Page","Search by Schools")}else{F()}})};this.loadSchoolDetails=function(aj){var ak=window.g_pageLiquidLayout.getMap();portalAjax.doViewEngineAjax("loadschooldetails","/schoolsearch.c21",$.param({sid:aj,zoom:ak.getZoom(),px:portalResults.getMapBoundaries(),submitted:true}),{cache:true,callback:function(){c()}})};function t(al){var aj=al.split("|"),ak=[];$.each(aj,function(an,am){var aq=am.split(","),ao=parseFloat(aq[1]),ap=parseFloat(aq[0]);ak.push([ao,ap])});return ak}this.parseBoundary=function(an,am){var al=$(am),ak=al.find("#schoolDetailBoundary_"+an).val(),aj=t(ak);return aj};function c(){$("#schoolSearchResults").hide();$("#searchTabsSection").hide();$(".searchCriteriaDiv").hide();$("#schoolDetailInformation").show();var aj=$("#totalSchoolPrograms").val();if(aj!=null&&aj!=""&&aj<=0){$("#schoolDetailsDiv .programsTab").hide();$("#schoolDetailsDiv .programstabHeader").hide();$("#schoolDetailsDiv .programstabHeader").removeClass("selected")}if(!$("#schoolDetailsDiv .overviewtabHeader").hasClass("selected")){$("#schoolDetailsDiv .overviewtabHeader").addClass("selected")}v();$("#schoolDetailsDiv .overviewtabHeader").click(function(){if(!$(this).hasClass("selected")){$(this).addClass("selected")}Track.doEvent("Schools","School Details Dialog","Show Overview Tab");v()});$("#schoolDetailsDiv .reviewstabHeader").click(function(){if(!$(this).hasClass("selected")){$(this).addClass("selected")}Track.doEvent("Schools","School Details Dialog","Show Reviews Tab");C()});$("#schoolDetailsDiv .ratingstabHeader").click(function(){if(!$(this).hasClass("selected")){$(this).addClass("selected")}Track.doEvent("Schools","School Details Dialog","Show Ratings Tab");K()});$("#schoolDetailsDiv .programstabHeader").click(function(){if(!$(this).hasClass("selected")){$(this).addClass("selected")}Track.doEvent("Schools","School Details Dialog","Show Programs Tab");w()});$("#schoolDetailsDiv .overviewtabHeader").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")});$("#schoolDetailsDiv .reviewstabHeader").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")});$("#schoolDetailsDiv .ratingstabHeader").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")});$("#schoolDetailsDiv .programstabHeader").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")});SchoolChartMaster.initialize()}this.showSearchResults=function(){$("#schoolSearchResults").show();$("#searchTabsSection").show();$(".searchCriteriaDiv").show();$("#schoolDetailInformation").hide();$("#programsTabAccessed").val("")};function v(){$("#schoolDetailsDiv .overviewTab").show();$("#schoolDetailsDiv .overviewtabHeader").addClass("selected");$("#schoolDetailsDiv .reviewsTab").hide();$("#schoolDetailsDiv .ratingsTab").hide();$("#schoolDetailsDiv .programsTab").hide();$("#schoolDetailsDiv .reviewstabHeader").removeClass("selected");$("#schoolDetailsDiv .ratingstabHeader").removeClass("selected");$("#schoolDetailsDiv .programstabHeader").removeClass("selected")}this.showOverviewTab=function(){v()};function C(){$("#schoolDetailsDiv .overviewTab").hide();$("#schoolDetailsDiv .reviewsTab").show();$("#schoolDetailsDiv .ratingsTab").hide();$("#schoolDetailsDiv .programsTab").hide();$("#schoolDetailsDiv .reviewstabHeader").addClass("selected");$("#schoolDetailsDiv .overviewtabHeader").removeClass("selected");$("#schoolDetailsDiv .ratingstabHeader").removeClass("selected");$("#schoolDetailsDiv .programstabHeader").removeClass("selected")}function K(){$("#schoolDetailsDiv .overviewTab").hide();$("#schoolDetailsDiv .reviewsTab").hide();$("#schoolDetailsDiv .ratingsTab").show();$("#schoolDetailsDiv .programsTab").hide();$("#schoolDetailsDiv .ratingstabHeader").addClass("selected");$("#schoolDetailsDiv .overviewtabHeader").removeClass("selected");$("#schoolDetailsDiv .reviewstabHeader").removeClass("selected");$("#schoolDetailsDiv .programstabHeader").removeClass("selected")}this.showRatingsTab=function(){K()};function w(){$("#schoolDetailsDiv .overviewTab").hide();$("#schoolDetailsDiv .reviewsTab").hide();$("#schoolDetailsDiv .ratingsTab").hide();$("#schoolDetailsDiv .programsTab").show();$("#schoolDetailsDiv .programstabHeader").addClass("selected");$("#schoolDetailsDiv .overviewtabHeader").removeClass("selected");$("#schoolDetailsDiv .reviewstabHeader").removeClass("selected");$("#schoolDetailsDiv .ratingstabHeader").removeClass("selected");var aj=$("#programsTabAccessed").val();if(aj==""){$("#programsTabAccessed").val("Y");schoolSearch.cleanPrograms()}}};var b=function(g,e,d,j){var c=g,f=e,i=d,h=j;this.getId=function(){return c};this.getLatitude=function(){return f};this.getLongitude=function(){return i};this.getBoundary=function(){return h}};window.SchoolRatingChart=new function(){var e,c,h=window.internationalization;function f(k){var j=e[k],i=parseInt(j);return i}function d(i,j){c.addBar(i,f(j))}function g(){c.resetData();c.setMinMaxHeight(0,50);c.setBarSameHeight(true);c.addLine(5);d(h.getString("Quality"),0);d(h.getString("Principal"),3);d(h.getString("Teachers"),1);d(h.getString("Activities"),5);d(h.getString("Parents"),2);d(h.getString("Safety"),4);c.autoAdjustViewport();c.setMinMaxValue(0,5);c.renderBars()}this.initialize=function(i){e=i;c=new VerticalChart($("#schoolRatingChart"));g()}};window.SchoolChartMaster=new function(){var e,d=false,f=false;function c(){if(!e){return}if(!f){return}if(d){return}d=true;SchoolRatingChart.initialize(e)}this.initialize=function(){d=false;f=true;c()};this.setData=function(g){e=g;c()}}}());(function(a){a.fn.infinitescroll=function(b){return a(this).each(function(){var c=a(this),d=a.extend({triggerAt:300,page:2,dataHandler:function(){}},b),g=false,e=false,f=function(){if(d.force||(d.triggerAt>=(c[0].scrollHeight-c.height()-c.scrollTop()))){d.force=false;g=true;d.dataHandler({setReachedEnd:function(){e=true},reset:function(){d.page++;g=false},page:d.page})}};c.bind("scrollpage",function(i,h){if(g){return}if(e){return}d.page=h;d.force=true;f()});c.unbind(".infinitescroll").bind("scroll.infinitescroll",function(h){if(g){return}if(!e){f()}});f()})}})(jQuery);
/*!
 * fancyBox - jQuery Plugin
 * version: 2.1.4 (Thu, 10 Jan 2013)
 * @requires jQuery v1.6 or later
 *
 * Examples at /web/20160127041237/http://fancyapps.com/fancybox/
 * License: www.fancyapps.com/fancybox/#license
 *
 * Copyright 2012 Janis Skarnelis - janis@fancyapps.com
 *
 */
(function(l,o,i,e){var d=i(l),a=i(o),p=i.fancybox=function(){p.open.apply(this,arguments)},k=navigator.userAgent.match(/msie/),c=null,f=o.createTouch!==e,j=function(q){return q&&q.hasOwnProperty&&q instanceof i},b=function(q){return q&&i.type(q)==="string"},m=function(q){return b(q)&&q.indexOf("%")>0},h=function(q){return(q&&!(q.style.overflow&&q.style.overflow==="hidden")&&((q.clientWidth&&q.scrollWidth>q.clientWidth)||(q.clientHeight&&q.scrollHeight>q.clientHeight)))},n=function(s,r){var q=parseInt(s,10)||0;if(r&&m(s)){q=p.getViewport()[r]/100*q}return Math.ceil(q)},g=function(q,r){return n(q,r)+"px"};i.extend(p,{version:"2.1.4",defaults:{padding:15,margin:20,width:800,height:600,minWidth:100,minHeight:100,maxWidth:9999,maxHeight:9999,autoSize:true,autoHeight:false,autoWidth:false,autoResize:true,autoCenter:!f,fitToView:true,aspectRatio:false,topRatio:0.5,leftRatio:0.5,scrolling:"auto",wrapCSS:"",arrows:true,closeBtn:true,closeClick:false,nextClick:false,mouseWheel:true,autoPlay:false,playSpeed:3000,preload:3,modal:false,loop:true,ajax:{dataType:"html",headers:{"X-fancyBox":true}},iframe:{scrolling:"auto",preload:true},swf:{wmode:"transparent",allowfullscreen:"true",allowscriptaccess:"always"},keys:{next:{13:"left",34:"up",39:"left",40:"up"},prev:{8:"right",33:"down",37:"right",38:"down"},close:[27],play:[32],toggle:[70]},direction:{next:"left",prev:"right"},scrollOutside:true,index:0,type:null,href:null,content:null,title:null,tpl:{wrap:'<div class="fancybox-wrap" tabIndex="-1"><div class="fancybox-skin"><div class="fancybox-outer"><div class="fancybox-inner"></div></div></div></div>',image:'<img class="fancybox-image" src="{href}" alt="" />',iframe:'<iframe id="fancybox-frame{rnd}" name="fancybox-frame{rnd}" class="fancybox-iframe" frameborder="0" vspace="0" hspace="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen'+(k?' allowtransparency="true"':"")+"></iframe>",error:'<p class="fancybox-error">The requested content cannot be loaded.<br/>Please try again later.</p>',closeBtn:'<a title="Close" class="fancybox-item fancybox-close" href="javascript:;"></a>',next:'<a title="Next" class="fancybox-nav fancybox-next" href="javascript:;"><span></span></a>',prev:'<a title="Previous" class="fancybox-nav fancybox-prev" href="javascript:;"><span></span></a>'},openEffect:"fade",openSpeed:250,openEasing:"swing",openOpacity:true,openMethod:"zoomIn",closeEffect:"fade",closeSpeed:250,closeEasing:"swing",closeOpacity:true,closeMethod:"zoomOut",nextEffect:"elastic",nextSpeed:250,nextEasing:"swing",nextMethod:"changeIn",prevEffect:"elastic",prevSpeed:250,prevEasing:"swing",prevMethod:"changeOut",helpers:{overlay:true,title:true},onCancel:i.noop,beforeLoad:i.noop,afterLoad:i.noop,beforeShow:i.noop,afterShow:i.noop,beforeChange:i.noop,beforeClose:i.noop,afterClose:i.noop},group:{},opts:{},previous:null,coming:null,current:null,isActive:false,isOpen:false,isOpened:false,wrap:null,skin:null,outer:null,inner:null,player:{timer:null,isActive:false},ajaxLoad:null,imgPreload:null,transitions:{},helpers:{},open:function(r,q){if(!r){return}if(!i.isPlainObject(q)){q={}}if(false===p.close(true)){return}if(!i.isArray(r)){r=j(r)?i(r).get():[r]}i.each(r,function(w,x){var v={},s,A,y,z,u,B,t;if(i.type(x)==="object"){if(x.nodeType){x=i(x)}if(j(x)){v={href:x.data("fancybox-href")||x.attr("href"),title:x.data("fancybox-title")||x.attr("title"),isDom:true,element:x};if(i.metadata){i.extend(true,v,x.metadata())}}else{v=x}}s=q.href||v.href||(b(x)?x:null);A=q.title!==e?q.title:v.title||"";y=q.content||v.content;z=y?"html":(q.type||v.type);if(!z&&v.isDom){z=x.data("fancybox-type");if(!z){u=x.prop("class").match(/fancybox\.(\w+)/);z=u?u[1]:null}}if(b(s)){if(!z){if(p.isImage(s)){z="image"}else{if(p.isSWF(s)){z="swf"}else{if(s.charAt(0)==="#"){z="inline"}else{if(b(x)){z="html";y=x}}}}}if(z==="ajax"){B=s.split(/\s+/,2);s=B.shift();t=B.shift()}}if(!y){if(z==="inline"){if(s){y=i(b(s)?s.replace(/.*(?=#[^\s]+$)/,""):s)}else{if(v.isDom){y=x}}}else{if(z==="html"){y=s}else{if(!z&&!s&&v.isDom){z="inline";y=x}}}}i.extend(v,{href:s,type:z,content:y,title:A,selector:t});r[w]=v});p.opts=i.extend(true,{},p.defaults,q);if(q.keys!==e){p.opts.keys=q.keys?i.extend({},p.defaults.keys,q.keys):false}p.group=r;return p._start(p.opts.index)},cancel:function(){var q=p.coming;if(!q||false===p.trigger("onCancel")){return}p.hideLoading();if(p.ajaxLoad){p.ajaxLoad.abort()}p.ajaxLoad=null;if(p.imgPreload){p.imgPreload.onload=p.imgPreload.onerror=null}if(q.wrap){q.wrap.stop(true,true).trigger("onReset").remove()}p.coming=null;if(!p.current){p._afterZoomOut(q)}},close:function(q){p.cancel();if(false===p.trigger("beforeClose")){return}p.unbindEvents();if(!p.isActive){return}if(!p.isOpen||q===true){i(".fancybox-wrap").stop(true).trigger("onReset").remove();p._afterZoomOut()}else{p.isOpen=p.isOpened=false;p.isClosing=true;i(".fancybox-item, .fancybox-nav").remove();p.wrap.stop(true,true).removeClass("fancybox-opened");p.transitions[p.current.closeMethod]()}},play:function(s){var q=function(){clearTimeout(p.player.timer)},u=function(){q();if(p.current&&p.player.isActive){p.player.timer=setTimeout(p.next,p.current.playSpeed)}},r=function(){q();i("body").unbind(".player");p.player.isActive=false;p.trigger("onPlayEnd")},t=function(){if(p.current&&(p.current.loop||p.current.index<p.group.length-1)){p.player.isActive=true;i("body").bind({"afterShow.player onUpdate.player":u,"onCancel.player beforeClose.player":r,"beforeLoad.player":q});u();p.trigger("onPlayStart")}};if(s===true||(!p.player.isActive&&s!==false)){t()}else{r()}},next:function(r){var q=p.current;if(q){if(!b(r)){r=q.direction.next}p.jumpto(q.index+1,r,"next")}},prev:function(r){var q=p.current;if(q){if(!b(r)){r=q.direction.prev}p.jumpto(q.index-1,r,"prev")}},jumpto:function(r,t,q){var s=p.current;if(!s){return}r=n(r);p.direction=t||s.direction[(r>=s.index?"next":"prev")];p.router=q||"jumpto";if(s.loop){if(r<0){r=s.group.length+(r%s.group.length)}r=r%s.group.length}if(s.group[r]!==e){p.cancel();p._start(r)}},reposition:function(t,q){var s=p.current,r=s?s.wrap:null,u;if(r){u=p._getPosition(q);if(t&&t.type==="scroll"){delete u.position;r.stop(true,true).animate(u,200)}else{r.css(u);s.pos=i.extend({},s.dim,u)}}},update:function(s){var q=(s&&s.type),r=!q||q==="orientationchange";if(r){clearTimeout(c);c=null}if(!p.isOpen||c){return}c=setTimeout(function(){var t=p.current;if(!t||p.isClosing){return}p.wrap.removeClass("fancybox-tmp");if(r||q==="load"||(q==="resize"&&t.autoResize)){p._setDimension()}if(!(q==="scroll"&&t.canShrink)){p.reposition(s)}p.trigger("onUpdate");c=null},(r&&!f?0:300))},toggle:function(q){if(p.isOpen){p.current.fitToView=i.type(q)==="boolean"?q:!p.current.fitToView;if(f){p.wrap.removeAttr("style").addClass("fancybox-tmp");p.trigger("onUpdate")}p.update()}},hideLoading:function(){a.unbind(".loading");i("#fancybox-loading").remove()},showLoading:function(){var r,q;p.hideLoading();r=i('<div id="fancybox-loading"><div></div></div>').click(p.cancel).appendTo("body");a.bind("keydown.loading",function(s){if((s.which||s.keyCode)===27){s.preventDefault();p.cancel()}});if(!p.defaults.fixed){q=p.getViewport();r.css({position:"absolute",top:(q.h*0.5)+q.y,left:(q.w*0.5)+q.x})}},getViewport:function(){var q=(p.current&&p.current.locked)||false,r={x:d.scrollLeft(),y:d.scrollTop()};if(q){r.w=q[0].clientWidth;r.h=q[0].clientHeight}else{r.w=f&&l.innerWidth?l.innerWidth:d.width();r.h=f&&l.innerHeight?l.innerHeight:d.height()}return r},unbindEvents:function(){if(p.wrap&&j(p.wrap)){p.wrap.unbind(".fb")}a.unbind(".fb");d.unbind(".fb")},bindEvents:function(){var r=p.current,q;if(!r){return}d.bind("orientationchange.fb"+(f?"":" resize.fb")+(r.autoCenter&&!r.locked?" scroll.fb":""),p.update);q=r.keys;if(q){a.bind("keydown.fb",function(u){var s=u.which||u.keyCode,t=u.target||u.srcElement;if(s===27&&p.coming){return false}if(!u.ctrlKey&&!u.altKey&&!u.shiftKey&&!u.metaKey&&!(t&&(t.type||i(t).is("[contenteditable]")))){i.each(q,function(v,w){if(r.group.length>1&&w[s]!==e){p[v](w[s]);u.preventDefault();return false}if(i.inArray(s,w)>-1){p[v]();u.preventDefault();return false}})}})}if(i.fn.mousewheel&&r.mouseWheel){p.wrap.bind("mousewheel.fb",function(x,y,t,s){var w=x.target||null,u=i(w),v=false;while(u.length){if(v||u.is(".fancybox-skin")||u.is(".fancybox-wrap")){break}v=h(u[0]);u=i(u).parent()}if(y!==0&&!v){if(p.group.length>1&&!r.canShrink){if(s>0||t>0){p.prev(s>0?"down":"left")}else{if(s<0||t<0){p.next(s<0?"up":"right")}}x.preventDefault()}}})}},trigger:function(r,t){var q,s=t||p.coming||p.current;if(!s){return}if(i.isFunction(s[r])){q=s[r].apply(s,Array.prototype.slice.call(arguments,1))}if(q===false){return false}if(s.helpers){i.each(s.helpers,function(v,u){if(u&&p.helpers[v]&&i.isFunction(p.helpers[v][r])){u=i.extend(true,{},p.helpers[v].defaults,u);p.helpers[v][r](u,s)}})}i.event.trigger(r+".fb")},isImage:function(q){return b(q)&&q.match(/(^data:image\/.*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp)((\?|#).*)?$)/i)},isSWF:function(q){return b(q)&&q.match(/\.(swf)((\?|#).*)?$/i)},_start:function(r){var s={},w,q,t,u,v;r=n(r);w=p.group[r]||null;if(!w){return false}s=i.extend(true,{},p.opts,w);u=s.margin;v=s.padding;if(i.type(u)==="number"){s.margin=[u,u,u,u]}if(i.type(v)==="number"){s.padding=[v,v,v,v]}if(s.modal){i.extend(true,s,{closeBtn:false,closeClick:false,nextClick:false,arrows:false,mouseWheel:false,keys:null,helpers:{overlay:{closeClick:false}}})}if(s.autoSize){s.autoWidth=s.autoHeight=true}if(s.width==="auto"){s.autoWidth=true}if(s.height==="auto"){s.autoHeight=true}s.group=p.group;s.index=r;p.coming=s;if(false===p.trigger("beforeLoad")){p.coming=null;return}t=s.type;q=s.href;if(!t){p.coming=null;if(p.current&&p.router&&p.router!=="jumpto"){p.current.index=r;return p[p.router](p.direction)}return false}p.isActive=true;if(t==="image"||t==="swf"){s.autoHeight=s.autoWidth=false;s.scrolling="visible"}if(t==="image"){s.aspectRatio=true}if(t==="iframe"&&f){s.scrolling="scroll"}s.wrap=i(s.tpl.wrap).addClass("fancybox-"+(f?"mobile":"desktop")+" fancybox-type-"+t+" fancybox-tmp "+s.wrapCSS).appendTo(s.parent||"body");i.extend(s,{skin:i(".fancybox-skin",s.wrap),outer:i(".fancybox-outer",s.wrap),inner:i(".fancybox-inner",s.wrap)});i.each(["Top","Right","Bottom","Left"],function(y,x){s.skin.css("padding"+x,g(s.padding[y]))});p.trigger("onReady");if(t==="inline"||t==="html"){if(!s.content||!s.content.length){return p._error("content")}}else{if(!q){return p._error("href")}}if(t==="image"){p._loadImage()}else{if(t==="ajax"){p._loadAjax()}else{if(t==="iframe"){p._loadIframe()}else{p._afterLoad()}}}},_error:function(q){i.extend(p.coming,{type:"html",autoWidth:true,autoHeight:true,minWidth:0,minHeight:0,scrolling:"no",hasError:q,content:p.coming.tpl.error});p._afterLoad()},_loadImage:function(){var q=p.imgPreload=new Image();q.onload=function(){this.onload=this.onerror=null;p.coming.width=this.width;p.coming.height=this.height;p._afterLoad()};q.onerror=function(){this.onload=this.onerror=null;p._error("image")};q.src=p.coming.href;if(q.complete!==true){p.showLoading()}},_loadAjax:function(){var q=p.coming;p.showLoading();p.ajaxLoad=i.ajax(i.extend({},q.ajax,{url:q.href,error:function(r,s){if(p.coming&&s!=="abort"){p._error("ajax",r)}else{p.hideLoading()}},success:function(r,s){if(s==="success"){q.content=r;p._afterLoad()}}}))},_loadIframe:function(){var q=p.coming,r=i(q.tpl.iframe.replace(/\{rnd\}/g,new Date().getTime())).attr("scrolling",f?"auto":q.iframe.scrolling).attr("src",q.href);i(q.wrap).bind("onReset",function(){try{i(this).find("iframe").hide().attr("src","//about:blank").end().empty()}catch(s){}});if(q.iframe.preload){p.showLoading();r.one("load",function(){i(this).data("ready",1);if(!f){i(this).bind("load.fb",p.update)}i(this).parents(".fancybox-wrap").width("100%").removeClass("fancybox-tmp").show();p._afterLoad()})}q.content=r.appendTo(q.inner);if(!q.iframe.preload){p._afterLoad()}},_preloadImages:function(){var v=p.group,u=p.current,q=v.length,s=u.preload?Math.min(u.preload,q-1):0,t,r;for(r=1;r<=s;r+=1){t=v[(u.index+r)%q];if(t.type==="image"&&t.href){new Image().src=t.href}}},_afterLoad:function(){var r=p.coming,t=p.current,y="fancybox-placeholder",v,w,x,s,q,u;p.hideLoading();if(!r||p.isActive===false){return}if(false===p.trigger("afterLoad",r,t)){r.wrap.stop(true).trigger("onReset").remove();p.coming=null;return}if(t){p.trigger("beforeChange",t);t.wrap.stop(true).removeClass("fancybox-opened").find(".fancybox-item, .fancybox-nav").remove()}p.unbindEvents();v=r;w=r.content;x=r.type;s=r.scrolling;i.extend(p,{wrap:v.wrap,skin:v.skin,outer:v.outer,inner:v.inner,current:v,previous:t});q=v.href;switch(x){case"inline":case"ajax":case"html":if(v.selector){w=i("<div>").html(w).find(v.selector)}else{if(j(w)){if(!w.data(y)){w.data(y,i('<div class="'+y+'"></div>').insertAfter(w).hide())}w=w.show().detach();v.wrap.bind("onReset",function(){if(i(this).find(w).length){w.hide().replaceAll(w.data(y)).data(y,false)}})}}break;case"image":w=v.tpl.image.replace("{href}",q);break;case"swf":w='<object id="fancybox-swf" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%"><param name="movie" value="'+q+'"></param>';u="";i.each(v.swf,function(z,A){w+='<param name="'+z+'" value="'+A+'"></param>';u+=" "+z+'="'+A+'"'});w+='<embed src="'+q+'" type="application/x-shockwave-flash" width="100%" height="100%"'+u+"></embed></object>";break}if(!(j(w)&&w.parent().is(v.inner))){v.inner.append(w)}p.trigger("beforeShow");v.inner.css("overflow",s==="yes"?"scroll":(s==="no"?"hidden":s));p._setDimension();p.reposition();p.isOpen=false;p.coming=null;p.bindEvents();if(!p.isOpened){i(".fancybox-wrap").not(v.wrap).stop(true).trigger("onReset").remove()}else{if(t.prevMethod){p.transitions[t.prevMethod]()}}p.transitions[p.isOpened?v.nextMethod:v.openMethod]();p._preloadImages()},_setDimension:function(){var T=p.getViewport(),P=0,V=false,X=false,B=p.wrap,N=p.skin,Y=p.inner,K=p.current,L=K.width,I=K.height,E=K.minWidth,x=K.minHeight,R=K.maxWidth,J=K.maxHeight,D=K.scrolling,v=K.scrollOutside?K.scrollbarWidth:0,H=K.margin,w=n(H[1]+H[3]),u=n(H[0]+H[2]),s,r,O,Q,G,F,M,z,y,U,t,W,q,A,C;B.add(N).add(Y).width("auto").height("auto").removeClass("fancybox-tmp");s=n(N.outerWidth(true)-N.width());r=n(N.outerHeight(true)-N.height());O=w+s;Q=u+r;G=m(L)?(T.w-O)*n(L)/100:L;F=m(I)?(T.h-Q)*n(I)/100:I;if(K.type==="iframe"){A=K.content;if(K.autoHeight&&A.data("ready")===1){try{if(A[0].contentWindow.document.location){Y.width(G).height(9999);C=A.contents().find("body");if(v){C.css("overflow-x","hidden")}F=C.height()}}catch(S){}}}else{if(K.autoWidth||K.autoHeight){Y.addClass("fancybox-tmp");if(!K.autoWidth){Y.width(G)}if(!K.autoHeight){Y.height(F)}if(K.autoWidth){G=Y.width()}if(K.autoHeight){F=Y.height()}Y.removeClass("fancybox-tmp")}}L=n(G);I=n(F);y=G/F;E=n(m(E)?n(E,"w")-O:E);R=n(m(R)?n(R,"w")-O:R);x=n(m(x)?n(x,"h")-Q:x);J=n(m(J)?n(J,"h")-Q:J);M=R;z=J;if(K.fitToView){R=Math.min(T.w-O,R);J=Math.min(T.h-Q,J)}W=T.w-w;q=T.h-u;if(K.aspectRatio){if(L>R){L=R;I=n(L/y)}if(I>J){I=J;L=n(I*y)}if(L<E){L=E;I=n(L/y)}if(I<x){I=x;L=n(I*y)}}else{L=Math.max(E,Math.min(L,R));if(K.autoHeight&&K.type!=="iframe"){Y.width(L);I=Y.height()}I=Math.max(x,Math.min(I,J))}if(K.fitToView){Y.width(L).height(I);B.width(L+s);U=B.width();t=B.height();if(K.aspectRatio){while((U>W||t>q)&&L>E&&I>x){if(P++>19){break}I=Math.max(x,Math.min(J,I-10));L=n(I*y);if(L<E){L=E;I=n(L/y)}if(L>R){L=R;I=n(L/y)}Y.width(L).height(I);B.width(L+s);U=B.width();t=B.height()}}else{L=Math.max(E,Math.min(L,L-(U-W)));I=Math.max(x,Math.min(I,I-(t-q)))}}if(v&&D==="auto"&&I<F&&(L+s+v)<W){L+=v}Y.width(L).height(I);B.width(L+s);U=B.width();t=B.height();V=(U>W||t>q)&&L>E&&I>x;X=K.aspectRatio?(L<M&&I<z&&L<G&&I<F):((L<M||I<z)&&(L<G||I<F));i.extend(K,{dim:{width:g(U),height:g(t)},origWidth:G,origHeight:F,canShrink:V,canExpand:X,wPadding:s,hPadding:r,wrapSpace:t-N.outerHeight(true),skinSpace:N.height()-I});if(!A&&K.autoHeight&&I>x&&I<J&&!X){Y.height("auto")}},_getPosition:function(s){var w=p.current,r=p.getViewport(),u=w.margin,t=p.wrap.width()+u[1]+u[3],q=p.wrap.height()+u[0]+u[2],v={position:"absolute",top:u[0],left:u[3]};if(w.autoCenter&&w.fixed&&!s&&q<=r.h&&t<=r.w){v.position="fixed"}else{if(!w.locked){v.top+=r.y;v.left+=r.x}}v.top=g(Math.max(v.top,v.top+((r.h-q)*w.topRatio)));v.left=g(Math.max(v.left,v.left+((r.w-t)*w.leftRatio)));return v},_afterZoomIn:function(){var q=p.current;if(!q){return}p.isOpen=p.isOpened=true;p.wrap.css("overflow","visible").addClass("fancybox-opened");p.update();if(q.closeClick||(q.nextClick&&p.group.length>1)){p.inner.css("cursor","pointer").bind("click.fb",function(r){if(!i(r.target).is("a")&&!i(r.target).parent().is("a")){r.preventDefault();p[q.closeClick?"close":"next"]()}})}if(q.closeBtn){i(q.tpl.closeBtn).appendTo(p.skin).bind("click.fb",function(r){r.preventDefault();p.close()})}if(q.arrows&&p.group.length>1){if(q.loop||q.index>0){i(q.tpl.prev).appendTo(p.outer).bind("click.fb",p.prev)}if(q.loop||q.index<p.group.length-1){i(q.tpl.next).appendTo(p.outer).bind("click.fb",p.next)}}p.trigger("afterShow");if(!q.loop&&q.index===q.group.length-1){p.play(false)}else{if(p.opts.autoPlay&&!p.player.isActive){p.opts.autoPlay=false;p.play()}}},_afterZoomOut:function(q){q=q||p.current;i(".fancybox-wrap").trigger("onReset").remove();i.extend(p,{group:{},opts:{},router:false,current:null,isActive:false,isOpened:false,isOpen:false,isClosing:false,wrap:null,skin:null,outer:null,inner:null});p.trigger("afterClose",q)}});p.transitions={getOrigPosition:function(){var t=p.current,r=t.element,w=t.orig,v={},q=50,x=50,u=t.hPadding,y=t.wPadding,s=p.getViewport();if(!w&&t.isDom&&r.is(":visible")){w=r.find("img:first");if(!w.length){w=r}}if(j(w)){v=w.offset();if(w.is("img")){q=w.outerWidth();x=w.outerHeight()}}else{v.top=s.y+(s.h-x)*t.topRatio;v.left=s.x+(s.w-q)*t.leftRatio}if(p.wrap.css("position")==="fixed"||t.locked){v.top-=s.y;v.left-=s.x}v={top:g(v.top-u*t.topRatio),left:g(v.left-y*t.leftRatio),width:g(q+y),height:g(x+u)};return v},step:function(r,s){var u,w,x,q=s.prop,t=p.current,v=t.wrapSpace,y=t.skinSpace;if(q==="width"||q==="height"){u=s.end===s.start?1:(r-s.start)/(s.end-s.start);if(p.isClosing){u=1-u}w=q==="width"?t.wPadding:t.hPadding;x=r-w;p.skin[q](n(q==="width"?x:x-(v*u)));p.inner[q](n(q==="width"?x:x-(v*u)-(y*u)))}},zoomIn:function(){var u=p.current,r=u.pos,s=u.openEffect,t=s==="elastic",q=i.extend({opacity:1},r);delete q.position;if(t){r=this.getOrigPosition();if(u.openOpacity){r.opacity=0.1}}else{if(s==="fade"){r.opacity=0.1}}p.wrap.css(r).animate(q,{duration:s==="none"?0:u.openSpeed,easing:u.openEasing,step:t?this.step:null,complete:p._afterZoomIn})},zoomOut:function(){var t=p.current,r=t.closeEffect,s=r==="elastic",q={opacity:0.1};if(s){q=this.getOrigPosition();if(t.closeOpacity){q.opacity=0.1}}p.wrap.animate(q,{duration:r==="none"?0:t.closeSpeed,easing:t.closeEasing,step:s?this.step:null,complete:p._afterZoomOut})},changeIn:function(){var v=p.current,s=v.nextEffect,r=v.pos,q={opacity:1},u=p.direction,w=200,t;r.opacity=0.1;if(s==="elastic"){t=u==="down"||u==="up"?"top":"left";if(u==="down"||u==="right"){r[t]=g(n(r[t])-w);q[t]="+="+w+"px"}else{r[t]=g(n(r[t])+w);q[t]="-="+w+"px"}}if(s==="none"){p._afterZoomIn()}else{p.wrap.css(r).animate(q,{duration:v.nextSpeed,easing:v.nextEasing,complete:p._afterZoomIn})}},changeOut:function(){var s=p.previous,r=s.prevEffect,q={opacity:0.1},t=p.direction,u=200;if(r==="elastic"){q[t==="down"||t==="up"?"top":"left"]=(t==="up"||t==="left"?"-":"+")+"="+u+"px"}s.wrap.animate(q,{duration:r==="none"?0:s.prevSpeed,easing:s.prevEasing,complete:function(){i(this).trigger("onReset").remove()}})}};p.helpers.overlay={defaults:{closeClick:true,speedOut:200,showEarly:true,css:{},locked:!f,fixed:true},overlay:null,fixed:false,create:function(q){q=i.extend({},this.defaults,q);if(this.overlay){this.close()}this.overlay=i('<div class="fancybox-overlay"></div>').appendTo("body");this.fixed=false;if(q.fixed&&p.defaults.fixed){this.overlay.addClass("fancybox-overlay-fixed");this.fixed=true}},open:function(r){var q=this;r=i.extend({},this.defaults,r);if(this.overlay){this.overlay.unbind(".overlay").width("auto").height("auto")}else{this.create(r)}if(!this.fixed){d.bind("resize.overlay",i.proxy(this.update,this));this.update()}if(r.closeClick){this.overlay.bind("click.overlay",function(s){if(i(s.target).hasClass("fancybox-overlay")){if(p.isActive){p.close()}else{q.close()}}})}this.overlay.css(r.css).show()},close:function(){i(".fancybox-overlay").remove();d.unbind("resize.overlay");this.overlay=null;if(this.margin!==false){i("body").css("margin-right",this.margin);this.margin=false}if(this.el){this.el.removeClass("fancybox-lock")}},update:function(){var r="100%",q;this.overlay.width(r).height("100%");if(k){q=Math.max(o.documentElement.offsetWidth,o.body.offsetWidth);if(a.width()>q){r=a.width()}}else{if(a.width()>d.width()){r=a.width()}}this.overlay.width(r).height(a.height())},onReady:function(q,r){i(".fancybox-overlay").stop(true,true);if(!this.overlay){this.margin=a.height()>d.height()||i("body").css("overflow-y")==="scroll"?i("body").css("margin-right"):false;this.el=o.all&&!o.querySelector?i("html"):i("body");this.create(q)}if(q.locked&&this.fixed){r.locked=this.overlay.append(r.wrap);r.fixed=false}if(q.showEarly===true){this.beforeShow.apply(this,arguments)}},beforeShow:function(q,r){if(r.locked){this.el.addClass("fancybox-lock");if(this.margin!==false){i("body").css("margin-right",n(this.margin)+r.scrollbarWidth)}}this.open(q)},onUpdate:function(){if(!this.fixed){this.update()}},afterClose:function(q){if(this.overlay&&!p.isActive){this.overlay.fadeOut(q.speedOut,i.proxy(this.close,this))}}};p.helpers.title={defaults:{type:"float",position:"bottom"},beforeShow:function(r){var t=p.current,v=t.title,q=r.type,u,s;if(i.isFunction(v)){v=v.call(t.element,t)}if(!b(v)||i.trim(v)===""){return}u=i('<div class="fancybox-title fancybox-title-'+q+'-wrap">'+v+"</div>");switch(q){case"inside":s=p.skin;break;case"outside":s=p.wrap;break;case"over":s=p.inner;break;default:s=p.skin;u.appendTo("body");if(k){u.width(u.width())}u.wrapInner('<span class="child"></span>');p.current.margin[2]+=Math.abs(n(u.css("margin-bottom")));break}u[(r.position==="top"?"prependTo":"appendTo")](s)}};i.fn.fancybox=function(s){var r,t=i(this),q=this.selector||"",u=function(y){var x=i(this).blur(),v=r,w,z;if(!(y.ctrlKey||y.altKey||y.shiftKey||y.metaKey)&&!x.is(".fancybox-wrap")){w=s.groupAttr||"data-fancybox-group";z=x.attr(w);if(!z){w="rel";z=x.get(0)[w]}if(z&&z!==""&&z!=="nofollow"){x=q.length?i(q):t;x=x.filter("["+w+'="'+z+'"]');v=x.index(this)}s.index=v;if(p.open(x,s)!==false){y.preventDefault()}}};s=s||{};r=s.index||0;if(!q||s.live===false){t.unbind("click.fb-start").bind("click.fb-start",u)}else{a.undelegate(q,"click.fb-start").delegate(q+":not('.fancybox-item, .fancybox-nav')","click.fb-start",u)}this.filter("[data-fancybox-start=1]").trigger("click");return this};a.ready(function(){if(i.scrollbarWidth===e){i.scrollbarWidth=function(){var r=i('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),s=r.children(),q=s.innerWidth()-s.height(99).innerWidth();r.remove();return q}}if(i.support.fixedPosition===e){i.support.fixedPosition=(function(){var r=i('<div style="position:fixed;top:20px;"></div>').appendTo("body"),q=(r[0].offsetTop===20||r[0].offsetTop===15);r.remove();return q}())}i.extend(p.defaults,{scrollbarWidth:i.scrollbarWidth(),fixed:i.support.fixedPosition,parent:i("body")})})}(window,document,jQuery));(function(){(function(e,c,a){var b,f,d;d="slidesjs";f={width:940,height:528,start:1,navigation:{active:true,effect:"slide"},pagination:{active:true,effect:"slide"},play:{active:false,effect:"slide",interval:5000,auto:false,swap:true,pauseOnHover:false,restartDelay:2500},effect:{slide:{speed:500},fade:{speed:300,crossfade:true}},callback:{loaded:function(){},start:function(){},complete:function(){}}};b=(function(){function g(i,h){this.element=i;this.options=e.extend(true,{},f,h);this._defaults=f;this._name=d;this.init()}return g})();b.prototype.init=function(){var h,l,g,k,i,j,m=this;h=e(this.element);this.data=e.data(this);e.data(this,"animating",false);e.data(this,"total",h.children().not(".slidesjs-navigation",h).length);e.data(this,"current",this.options.start-1);e.data(this,"vendorPrefix",this._getVendorPrefix());if(typeof TouchEvent!=="undefined"){e.data(this,"touch",true);this.options.effect.slide.speed=this.options.effect.slide.speed/2}h.css({overflow:"hidden"});h.slidesContainer=h.children().not(".slidesjs-navigation",h).wrapAll("<div class='slidesjs-container'>",h).parent().css({overflow:"hidden",position:"relative"});e(".slidesjs-container",h).wrapInner("<div class='slidesjs-control'>",h).children();e(".slidesjs-control",h).css({position:"relative",left:0});e(".slidesjs-control",h).children().addClass("slidesjs-slide").css({position:"absolute",top:0,left:0,width:"100%",zIndex:0,display:"none",webkitBackfaceVisibility:"hidden"});e.each(e(".slidesjs-control",h).children(),function(n){var o;o=e(this);return o.attr("slidesjs-index",n)});if(this.data.touch){e(".slidesjs-control",h).on("touchstart",function(n){return m._touchstart(n)});e(".slidesjs-control",h).on("touchmove",function(n){return m._touchmove(n)});e(".slidesjs-control",h).on("touchend",function(n){return m._touchend(n)})}h.fadeIn(0);this.update();if(this.data.touch){this._setuptouch()}e(".slidesjs-control",h).children(":eq("+this.data.current+")").eq(0).fadeIn(0,function(){return e(this).css({zIndex:10})});if(this.options.navigation.active){i=e("<a>",{"class":"slidesjs-previous slidesjs-navigation",href:"#",title:"Previous",text:"Previous"}).appendTo(h);l=e("<a>",{"class":"slidesjs-next slidesjs-navigation",href:"#",title:"Next",text:"Next"}).appendTo(h)}e(".slidesjs-next",h).click(function(n){n.preventDefault();m.stop(true);return m.next(m.options.navigation.effect)});e(".slidesjs-previous",h).click(function(n){n.preventDefault();m.stop(true);return m.previous(m.options.navigation.effect)});if(this.options.play.active){k=e("<a>",{"class":"slidesjs-play slidesjs-navigation",href:"#",title:"Play",text:"Play"}).appendTo(h);j=e("<a>",{"class":"slidesjs-stop slidesjs-navigation",href:"#",title:"Stop",text:"Stop"}).appendTo(h);k.click(function(n){n.preventDefault();return m.play(true)});j.click(function(n){n.preventDefault();return m.stop(true)});if(this.options.play.swap){j.css({display:"none"})}}if(this.options.pagination.active){g=e("<ul>",{"class":"slidesjs-pagination"}).appendTo(h);e.each(new Array(this.data.total),function(n){var p,o;p=e("<li>",{"class":"slidesjs-pagination-item"}).appendTo(g);o=e("<a>",{href:"#","data-slidesjs-item":n,html:n+1}).appendTo(p);return o.click(function(q){q.preventDefault();m.stop(true);return m._goto((e(q.currentTarget).attr("data-slidesjs-item")*1)+1)})})}e(c).bind("resize",function(){return m.update()});this._setActive();if(this.options.play.auto){this.play()}return this.options.callback.loaded(this.options.start)};b.prototype._setActive=function(h){var g,i;g=e(this.element);this.data=e.data(this);i=h>-1?h:this.data.current;e(".active",g).removeClass("active");return e("li:eq("+i+") a",g).addClass("active")};b.prototype.update=function(){var h,g,i;h=e(this.element);this.data=e.data(this);e(".slidesjs-control",h).children(":not(:eq("+this.data.current+"))").css({display:"none",left:0,zIndex:0});i=h.width();g=(this.options.height/this.options.width)*i;this.options.width=i;this.options.height=g;return e(".slidesjs-control, .slidesjs-container",h).css({width:i,height:g})};b.prototype.next=function(h){var g;g=e(this.element);this.data=e.data(this);e.data(this,"direction","next");if(h===void 0){h=this.options.navigation.effect}if(h==="fade"){return this._fade()}else{return this._slide()}};b.prototype.previous=function(h){var g;g=e(this.element);this.data=e.data(this);e.data(this,"direction","previous");if(h===void 0){h=this.options.navigation.effect}if(h==="fade"){return this._fade()}else{return this._slide()}};b.prototype._goto=function(i){var g,h;g=e(this.element);this.data=e.data(this);if(h===void 0){h=this.options.pagination.effect}if(i>this.data.total){i=this.data.total}else{if(i<1){i=1}}if(typeof i==="number"){if(h==="fade"){return this._fade(i)}else{return this._slide(i)}}else{if(typeof i==="string"){if(i==="first"){if(h==="fade"){return this._fade(0)}else{return this._slide(0)}}else{if(i==="last"){if(h==="fade"){return this._fade(this.data.total)}else{return this._slide(this.data.total)}}}}}};b.prototype._setuptouch=function(){var g,i,j,h;g=e(this.element);this.data=e.data(this);h=e(".slidesjs-control",g);i=this.data.current+1;j=this.data.current-1;if(j<0){j=this.data.total-1}if(i>this.data.total-1){i=0}h.children(":eq("+i+")").css({display:"block",left:this.options.width});return h.children(":eq("+j+")").css({display:"block",left:-this.options.width})};b.prototype._touchstart=function(i){var g,h;g=e(this.element);this.data=e.data(this);h=i.originalEvent.touches[0];this._setuptouch();e.data(this,"touchtimer",Number(new Date()));e.data(this,"touchstartx",h.pageX);e.data(this,"touchstarty",h.pageY);return i.stopPropagation()};b.prototype._touchend=function(n){var o,j,l,i,g,k,h,m=this;o=e(this.element);this.data=e.data(this);k=n.originalEvent.touches[0];i=e(".slidesjs-control",o);if(i.position().left>this.options.width*0.5||i.position().left>this.options.width*0.1&&(Number(new Date())-this.data.touchtimer<250)){e.data(this,"direction","previous");this._slide()}else{if(i.position().left<-(this.options.width*0.5)||i.position().left<-(this.options.width*0.1)&&(Number(new Date())-this.data.touchtimer<250)){e.data(this,"direction","next");this._slide()}else{l=this.data.vendorPrefix;h=l+"Transform";j=l+"TransitionDuration";g=l+"TransitionTimingFunction";i[0].style[h]="translateX(0px)";i[0].style[j]=this.options.effect.slide.speed*0.85+"ms"}}i.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(){l=m.data.vendorPrefix;h=l+"Transform";j=l+"TransitionDuration";g=l+"TransitionTimingFunction";i[0].style[h]="";i[0].style[j]="";return i[0].style[g]=""});return n.stopPropagation()};b.prototype._touchmove=function(l){var g,j,i,k,h;g=e(this.element);this.data=e.data(this);k=l.originalEvent.touches[0];j=this.data.vendorPrefix;i=e(".slidesjs-control",g);h=j+"Transform";e.data(this,"scrolling",Math.abs(k.pageX-this.data.touchstartx)<Math.abs(k.pageY-this.data.touchstarty));if(!this.data.animating&&!this.data.scrolling){l.preventDefault();this._setuptouch();i[0].style[h]="translateX("+(k.pageX-this.data.touchstartx)+"px)"}return l.stopPropagation()};b.prototype.play=function(h){var g,j,i,k=this;g=e(this.element);this.data=e.data(this);if(!this.data.playInterval){if(h){j=this.data.current;this.data.direction="next";if(this.options.play.effect==="fade"){this._fade()}else{this._slide()}}e.data(this,"playInterval",setInterval((function(){j=k.data.current;k.data.direction="next";if(k.options.play.effect==="fade"){return k._fade()}else{return k._slide()}}),this.options.play.interval));i=e(".slidesjs-container",g);if(this.options.play.pauseOnHover){i.unbind();i.bind("mouseenter",function(){return k.stop()});i.bind("mouseleave",function(){if(k.options.play.restartDelay){return e.data(k,"restartDelay",setTimeout((function(){return k.play(true)}),k.options.play.restartDelay))}else{return k.play()}})}e.data(this,"playing",true);e(".slidesjs-play",g).addClass("slidesjs-playing");if(this.options.play.swap){e(".slidesjs-play",g).hide();return e(".slidesjs-stop",g).show()}}};b.prototype.stop=function(h){var g;g=e(this.element);this.data=e.data(this);clearInterval(this.data.playInterval);if(this.options.play.pauseOnHover&&h){e(".slidesjs-container",g).unbind()}e.data(this,"playInterval",null);e.data(this,"playing",false);e(".slidesjs-play",g).removeClass("slidesjs-playing");if(this.options.play.swap){e(".slidesjs-stop",g).hide();return e(".slidesjs-play",g).show()}};b.prototype._slide=function(k){var r,m,p,j,l,n,i,g,h,q,o=this;r=e(this.element);this.data=e.data(this);if(!this.data.animating&&k!==this.data.current+1){e.data(this,"animating",true);m=this.data.current;if(k>-1){k=k-1;q=k>m?1:-1;p=k>m?-this.options.width:this.options.width;l=k}else{q=this.data.direction==="next"?1:-1;p=this.data.direction==="next"?-this.options.width:this.options.width;l=m+q}if(l===-1){l=this.data.total-1}if(l===this.data.total){l=0}this._setActive(l);i=e(".slidesjs-control",r);if(k>-1){i.children(":not(:eq("+m+"))").css({display:"none",left:0,zIndex:0})}i.children(":eq("+l+")").css({display:"block",left:q*this.options.width,zIndex:10});this.options.callback.start(m+1);if(this.data.vendorPrefix){n=this.data.vendorPrefix;h=n+"Transform";j=n+"TransitionDuration";g=n+"TransitionTimingFunction";i[0].style[h]="translateX("+p+"px)";i[0].style[j]=this.options.effect.slide.speed+"ms";return i.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(){i[0].style[h]="";i[0].style[j]="";i.children(":eq("+l+")").css({left:0});i.children(":eq("+m+")").css({display:"none",left:0,zIndex:0});e.data(o,"current",l);e.data(o,"animating",false);i.unbind("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd");i.children(":not(:eq("+l+"))").css({display:"none",left:0,zIndex:0});if(o.data.touch){o._setuptouch()}return o.options.callback.complete(l+1)})}else{return i.stop().animate({left:p},this.options.effect.slide.speed,(function(){i.css({left:0});i.children(":eq("+l+")").css({left:0});return i.children(":eq("+m+")").css({display:"none",left:0,zIndex:0},e.data(o,"current",l),e.data(o,"animating",false),o.options.callback.complete(l+1))}))}}};b.prototype._fade=function(j){var g,l,i,h,k,m=this;g=e(this.element);this.data=e.data(this);if(!this.data.animating&&j!==this.data.current+1){e.data(this,"animating",true);l=this.data.current;if(j){j=j-1;k=j>l?1:-1;i=j}else{k=this.data.direction==="next"?1:-1;i=l+k}if(i===-1){i=this.data.total-1}if(i===this.data.total){i=0}this._setActive(i);h=e(".slidesjs-control",g);h.children(":eq("+i+")").css({display:"none",left:0,zIndex:10});this.options.callback.start(l+1);if(this.options.effect.fade.crossfade){h.children(":eq("+this.data.current+")").stop().fadeOut(this.options.effect.fade.speed);return h.children(":eq("+i+")").stop().fadeIn(this.options.effect.fade.speed,(function(){h.children(":eq("+i+")").css({zIndex:0});e.data(m,"animating",false);e.data(m,"current",i);return m.options.callback.complete(i+1)}))}else{return h.children(":eq("+l+")").stop().fadeOut(this.options.effect.fade.speed,(function(){h.children(":eq("+i+")").stop().fadeIn(m.options.effect.fade.speed,(function(){return h.children(":eq("+i+")").css({zIndex:10})}));e.data(m,"animating",false);e.data(m,"current",i);return m.options.callback.complete(i+1)}))}}};b.prototype._getVendorPrefix=function(){var g,h,j,k,l;g=a.body||a.documentElement;j=g.style;k="transition";l=["Moz","Webkit","Khtml","O","ms"];k=k.charAt(0).toUpperCase()+k.substr(1);h=0;while(h<l.length){if(typeof j[l[h]+k]==="string"){return l[h]}h++}return false};return e.fn[d]=function(g){return this.each(function(){if(!e.data(this,"plugin_"+d)){return e.data(this,"plugin_"+d,new b(this,g))}})}})(jQuery,window,document)}).call(this);$("head").append("<style>.VE_Pushpin_Popup{position: absolute; z-index: 1000; display: none;}</style>");Microsoft.Maps.Map.prototype.AddInfobox=function(b,d){d._infobox=$('<div class="VE_Pushpin_Popup"></div>');var c=new Microsoft.Maps.Pushpin(b,d);this.entities._tryLocationToPixel=this.tryLocationToPixel;this.entities.push(c);if(!this.customInfoboxEntities){this.customInfoboxEntities=[]}this.customInfoboxEntities.push(c);var a=$(this.getRootElement());a.append(c._infobox);this._entityAdded({entity:c,collection:this.entities});return c};Microsoft.Maps.Map.prototype.ClearInfoboxes=function(){var a=this;if(this.customInfoboxEntities){$.each(this.customInfoboxEntities,function(c,b){b._infobox.remove();a.entities.remove(b)});a.customInfoboxEntities=[]}};Microsoft.Maps.Pushpin.prototype.ShowInfoBox=function(){var c=this,h=c.tryLocationToPixel(c._location,Microsoft.Maps.PixelReference.control);if(h){var b=Math.floor(h.x),g=Math.floor(h.y),a=Math.floor(c._infobox.height()/2),f=Math.floor(c._infobox.width()/2),e=b-f,d=g-a;if($.browser.msie&&parseInt($.browser.version,10)===7){}c._infobox.css({position:"absolute",left:e,top:d}).show()}else{this._infobox.hide()}this._infoboxShown=true};Microsoft.Maps.Pushpin.prototype._infoboxShown=false;Microsoft.Maps.Pushpin.prototype._infoboxToggle=function(a){a.target.ToggleInfoBox()};Microsoft.Maps.Pushpin.prototype._infoboxShow=function(a){a.target.ShowInfoBox()};Microsoft.Maps.Map.prototype._entityAdded=function(b){var a=b.entity;if(a._infobox){a.tryLocationToPixel=b.collection._tryLocationToPixel}};Microsoft.Maps.Map.prototype._entityRemoved=function(b){var a=b.target;if(a._infobox){a.tryLocationToPixel=null;a._infobox.remove()}};Microsoft.Maps.Pushpin.prototype._setOptions=Microsoft.Maps.Pushpin.prototype.setOptions;Microsoft.Maps.Pushpin.prototype.setOptions=function(a){this._setOptions(a);if(a.sticky){this.sticky=a.sticky}if(a.title){this.title=a.title}if(a.description){this.description=a.description}if(a._infobox){this._infobox=a._infobox}if(!a.infobox){a.infobox=$('<div class="Title">'+this.title+'</div><div class="Description">'+this.description+"</div>")}else{if(a.infobox&&this.infobox&&(a.infobox!=this.infobox)){this._infobox.remove(this.infobox)}}this.infobox=a.infobox;if(this._infobox){this._infobox.append(this.infobox)}};window.Ve7Infobox=function(a){Microsoft.Maps.Events.addHandler(a.entities,"entityAdded",a._entityAdded);Microsoft.Maps.Events.addHandler(a.entities,"entityRemoved",a._entityRemoved);Microsoft.Maps.Events.addHandler(a,"viewchange",function(){var e=this.target.customInfoboxEntities;if(!e){return}var b=e.length;for(var d=0;d<b;d++){var c=e[d];c.ShowInfoBox()}})};(function(){var e=window.jQuery,d=window.Microsoft.Maps,c=window.Century21=window.Century21||{},b=c.Maps={},a=function(){c.Internationalization=window.internationalization;c.Track=window.Track;c.Places=window.myc21Places;c.portalAjax=window.portalAjax;c.portalResults=window.portalResults;c.PortalParams=window.PortalParams;c.Helpers=window.c21Helpers;c.SchoolSearch=window.schoolSearch;c.ImageLazyLoader=window.ImageLazyLoader;c.ViewSession=window.ViewSession;c.Collapsasaurus=window.Collapsasaurus;c.SurroundingAreasMapping=window.surroundingAreasMapping;c.SurroundingAreasMappingDefault=window.surroundingAreasMappingDefault;c.Internationalization=window.internationalization};a();e(document).ready(a);b.bingmapCredentials="Aifo-Q0bU-2xqFafu5AzBNi5fz59f5ufmjxeulcOJc1DddNIqLLW5Sozv3EQ8dhn";c.Setup={mapModule:function(f){f(e,c,b,d)}}}());window.Century21.Setup.mapModule(function(d,b,a,c){a.POIMapLayer=function(k,j){var g=this,l=new c.EntityCollection({zIndex:3}),i=0,h=k,f=j,e=function(){h.entities.push(l)};e();g.addPushPin=function(n,p,o){i++;var m=new c.Pushpin(n,{typeName:"IconPoi"+p+"16 uniquePOI_"+i,height:16,width:16,anchor:new c.Point(8,8),icon:"/images/clear.gif"});l.push(m);d(".uniquePOI_"+i).attr("title",o);a.onPinHoverIntent(h,m,function(){b.Track.doEvent("Hybrid Mapping","Points of Interest Map","Hover over a point of interest on the map")},function(){});c.Events.addHandler(m,"click",function(q){b.Track.doEvent("Hybrid Mapping","Points of Interest Map","Click on a point of interest on the map")})};g.clearPOI=function(){l.clear()};g.render=function(o){if(o&&o.length>0){var n=h.getBounds(),m={xy:n.getNorth().toString(),mx:n.getWest().toString(),my:n.getSouth().toString(),xx:n.getEast().toString(),submitted:"true",ct:o,subView:"PointsOfInterestSearch"};d.ajax({dataType:"json",data:m,url:"/pointsofinterest.c21?",success:function(q){var p=q.locations;g.clearPOI();if(p.length>999){f.enable("poi");return}f.disable("poi");d.each(p,function(t,s){var u=new c.Location(s.latitude,s.longitude),r=s.type.toLowerCase().replace(/((^| )[a-z])/g,function(v){return d.trim(v.toUpperCase())}).split(" ")[0];g.addPushPin(u,r,s.name.replace("&amp;","&")+(s.phone?"   "+b.Internationalization.getString("Phone")+": "+s.phone:""))})}})}else{g.clearPOI()}}}});window.Century21.Setup.mapModule(function(d,b,a,c){a.MyPlacesMapLayer=function(h,f,j){var n=this,e=new c.EntityCollection({zIndex:1}),i=new c.EntityCollection({zIndex:5}),k=0,l=f,m=h,g=function(){l.entities.push(e);l.entities.push(i)};g();n.addPushPin=function(r,q,p,v,t,s){k++;var o=new c.Pushpin(p,{typeName:"IconMapPin savedPlaceColor IconPin IconPinLabel"+s+" IconPin"+v+" uniquePlace_"+k,text:" ",height:30,width:28,textOffset:new c.Point(0,0),anchor:new c.Point(9,27),offset:new c.Point(0,0),icon:"/images/clear.gif"});var u=new a.PinData(q,p.latitude,p.longitude,{card:d("#myPlaceMapHoverOverlay"),colorIndex:v});i.push(o);c.Events.addHandler(o,"click",function(w){b.Track.doEvent("Hybrid Mapping","My Places Map","Click on a place on the map");b.Places.loadMyPlacesModal(q)});a.onPinHoverIntent(l,o,function(){b.Track.doEvent("Hybrid Mapping","My Places Map","Hover over a place on the map");d("#myPlaceMapHoverOverlay .myPlaceName").text(r.addresstext);d("#myPlaceMapHoverOverlay .myPlaceAddress").text(r.addressname);if(r.surroundingradius>0){d("#myPlaceMapHoverOverlay .myPlaceRadius").text(b.Internationalization.getString("Showing Radius of")+" "+r.surroundingradius+" mi.")}else{d("#myPlaceMapHoverOverlay .myPlaceRadius").text(b.Internationalization.getString("Showing No Radius"))}j.showHoverTooltip(u)},function(){j.hideHoverTooltip()});a.onMapClick(l,function(w){j.clear()})};n.drawCircle=function(p,o,s){var q=["#f26c4f","#6dcff6","#c1d72e","#f7941d","#fff568","#bd8cbf","#f06eaa","#ffffff","#8393ca","#3cb878","#fdc689"],r=["#f26c4f","#6dcff6","#c1d72e","#f7941d","#fff568","#bd8cbf","#f06eaa","#cccccc","#8393ca","#3cb878","#fdc689"],t=m.getCircle(p,o*1.609344,750,r[s-1],1,0.7,q[s-1],0.5);e.push(t)};n.clearMyPlaces=function(){i.clear();e.clear();k=0};n.render=function(){n.clearMyPlaces();var p=b.Places.getPlaces();var o=0;d.each(p,function(r,q){if(q.latitude==null||q.latitude==""||q.latitude==0||q.longitude==null||q.longitude==""||q.longitude==0){window["myPlaceGeocodeCallback"+o]=function(s){if(s&&s.resourceSets&&s.resourceSets.length>0&&s.resourceSets[0].resources&&s.resourceSets[0].resources.length>0){var t=s.resourceSets[0].resources[0].point.coordinates;b.portalAjax.doViewEngineAjax("savemyplacegeocodes","/myc21.c21",d.param({itemid:q.item_id,latitude:t[0],longitude:t[1]}),{cache:false});if(q.active=="Y"){n.addPlaceToMap(q,t[0],t[1],r+1)}}};n.geocodeAddressAndSaveCoords(q,o);o++}else{if(q.active=="Y"){n.addPlaceToMap(q,q.latitude,q.longitude,r+1)}}})};n.addPlaceToMap=function(q,s,u,r){var t=new c.Location(s,u);var p=q.addresstext+" | "+q.addressname;var o=q.pincolor;n.addPushPin(q,q.item_id,t,o,p,r);n.drawCircle(t,q.surroundingradius,q.pincolor)};n.callGeocodeRESTService=function(q){var p=document.createElement("script");p.setAttribute("type","text/javascript");p.setAttribute("src",q);var o=document.getElementsByTagName("head").item(0);o.appendChild(p)};n.geocodeAddressAndSaveCoords=function(p,r){var o="myPlaceGeocodeCallback"+r;var q=a.bingmapCredentials;var s="/web/20160127041237/http://dev.virtualearth.net/REST/v1/Locations?q="+p.addressname+"&key="+q+"&jsonp="+o;n.callGeocodeRESTService(s)};n.geocodeAddressAndSavePlace=function(q){var o=a.bingmapCredentials,p="/web/20160127041237/http://dev.virtualearth.net/REST/v1/Locations?q="+q+"&key="+o+"&jsonp=myc21Places.GeocodeCallbackSavePlace";n.callGeocodeRESTService(p)}}});window.Century21.Setup.mapModule(function(d,b,a,c){a.HeatMapLayer=function(e,i){var l=this,k=i,m=[],j=function(p,n,o,s){var q=new c.Polygon(p,{fillColor:n,strokeColor:new c.Color(200,255,255,255),strokeThickness:0}),r=d(".overlayToolTip");k.push(q);m.push(q);c.Events.addHandler(q,"mouseover",function(x){var v=x.target.getFillColor(),w=140-s*84;r.find("#overlayToolTipText").html(o);if(o!=null&&o!=""){var u=o.substr(0,o.indexOf("<br>"));if(u!=null&&u!=""){b.Track.doEvent("Hybrid Mapping","Heat Map","Hover over "+u+" on map")}}w-=(parseInt(r.css("width"),10)/2);v.a=200;x.target.setOptions({strokeThickness:2,strokeColor:new c.Color(255,50,50,50),fillColor:v});clearTimeout(window.heatMapTimeout);var t="172px";if(!d("#bottomMapTools").hasClass("selected")){t="7px"}if(!r.hasClass("shown")){r.addClass("shown").show().css({right:w}).animate({opacity:1},1000)}else{r.css({display:"block",opacity:1,right:w,bottom:t})}});c.Events.addHandler(q,"mouseout",function(u){var t=u.target.getFillColor();t.a=130;u.target.setOptions({strokeThickness:0,strokeColor:new c.Color(50,50,50,50),fillColor:t});clearTimeout(window.heatMapTimeout);window.heatMapTimeout=setTimeout(function(){r.removeClass("shown").animate({opacity:0},function(){d(this).hide()})},2000)})},h=function(r,q,n,o){var p={start:r,end:q,pos:n,mid:o};if(o){if(n<0.5){return{r:Math.max(Math.min(parseInt((2*p.pos*(p.mid[0]-p.start[0]))+p.start[0],10),255),0),g:Math.max(Math.min(parseInt((2*p.pos*(p.mid[1]-p.start[1]))+p.start[1],10),255),0),b:Math.max(Math.min(parseInt((2*p.pos*(p.mid[2]-p.start[2]))+p.start[2],10),255),0)}}p.pos-=0.5;return{r:Math.max(Math.min(parseInt((2*p.pos*(p.end[0]-p.mid[0]))+p.mid[0],10),255),0),g:Math.max(Math.min(parseInt((2*p.pos*(p.end[1]-p.mid[1]))+p.mid[1],10),255),0),b:Math.max(Math.min(parseInt((2*p.pos*(p.end[2]-p.mid[2]))+p.mid[2],10),255),0)}}return{r:Math.max(Math.min(parseInt((p.pos*(p.end[0]-p.start[0]))+p.start[0],10),255),0),g:Math.max(Math.min(parseInt((p.pos*(p.end[1]-p.start[1]))+p.start[1],10),255),0),b:Math.max(Math.min(parseInt((p.pos*(p.end[2]-p.start[2]))+p.start[2],10),255),0)}},g=function(n,r,u){var s=u-r,v=(n-r)/s,t=[0,255,255],o=[255,0,0],p=[255,255,0],q=h(t,o,v,p);return new c.Color(130,q.r,q.g,q.b)},f=function(){};f();l.addMapLocation=function(p,t,r,q,o){var n=g(t,r,q),s=(t<=r?0:(t>=q?1:((t-r)/(q-r))));j(p,n,o,s)};l.clearHeatMap=function(){d(".heatMapLegend").hide();d.each(m,function(o,n){k.remove(n)})}}});window.Century21.Setup.mapModule(function(d,b,a,c){a.SurroundingAreaMapLayer=function(C,D,f){var s=new c.EntityCollection({zIndex:1}),g=null,r=[],m={},u={hover:1,selected:2,primary:3},t={1:"#3A7479",2:"#FFC400",3:"#000000"},z={},n=this,h=0,j=C,i,B=[],y=0,o={PROPERTIES:0,OFFICES:1,AGENTS:2},A,l,E,p=function(){A=new window.ImageCache();l=A.add("/images/surroundingarea/plus.png");E=A.add("/images/surroundingarea/ex.png");A.load()},x=function(G){var F=!!window.HTMLCanvasElement,J=17;if(F){var S=45,H=document.createElement("canvas");H.setAttribute("height",J);H.setAttribute("width",J);G.appendChild(H);if(window.G_vmlCanvasManager!=undefined){G_vmlCanvasManager.initElement(H)}var T=H.getContext("2d");var R=J,O=R/2,Q=true,P=false,N=d("<div style='position: absolute;' />");A.onLoad(function(){T.drawImage(l.img,0,0,R,R)});var I=function(U){T.save();T.setTransform(1,0,0,1,0,0);T.clearRect(0,0,R,R);T.translate(O,O);T.rotate(-U*Math.PI/180);T.drawImage(l.img,-O,-O);T.rotate(-U*Math.PI/180);T.globalAlpha=U/S;T.drawImage(E.img,-O,-O);T.restore()},M=function(){P=true;N.stop().animate({left:S},{duration:300,easing:"easeOutQuad",step:I,complete:function(){I(S,true);P=false;Q=false}})},K=function(){P=true;N.stop().animate({left:0},{duration:300,easing:"easeOutQuad",step:I,complete:function(){T.drawImage(l.img,0,0,R,R);P=false;Q=true}})}}else{var L=document.createElement("img");L.setAttribute("height",J);L.setAttribute("width",J);G.appendChild(L);A.onLoad(function(){L.src=l.img.src});var M=function(){L.src=E.img.src},K=function(){L.src=l.img.src}}return{open:M,close:K}},q=function(M,O){var ag=function(ai){var ak=0;for(var aj=ai.length;aj--;){ak+=Math.abs(ai[aj])^2}return Math.sqrt(ak)},L=function(aj,al){var ai=[];for(var ak=aj.length;ak--;){ai=ai.concat(aj[ak])}return ai},U=function(ai,aj){return[(ai[0][0]*aj[0])+(ai[0][1]*aj[1]),(ai[1][0]*aj[0])+(ai[1][1]*aj[1])]},P=function(ai){return[[Math.cos(ai),-Math.sin(ai)],[Math.sin(ai),Math.cos(ai)]]},ae=function(ai,aj){return ai[aj][0][0]},ad=function(ai,aj){return ai[aj][0][1]},ac=function(ai,aj){return ai[aj][1][0]},aa=function(ai,aj){return ai[aj][1][1]},V=function(ai,aj){return ai[aj][2]},N=function(al,an){var ar=-1,ap=al[an],aq=ap[0],ao=ap[1];for(var am=al.length;am--;){var ak=al[am],aj=ak[0],ai=ak[1];if((Math.max(aq[0],aj[0])<Math.min(aq[1],aj[1]))&&(Math.max(ao[0],ai[0])<Math.min(ao[1],ai[1]))){ar++}}return ar},Z=function(am,ai){var aq=-1,ap=ai[0],ao=ai[1];for(var an=am.length;an--;){var ak=am[an],al=ak[0],aj=ak[1];if((Math.max(ap[0],al[0])<Math.min(ap[1],al[1]))&&(Math.max(ao[0],aj[0])<Math.min(ao[1],aj[1]))){aq++}}return aq},J=function(aj){var ai=0,al=0;for(var ak=aj.length;ak--;){al=N(aj,ak);ai=Math.max(al,ai)}return ai},F=function(ai,aj){return[1/2*ad(ai,aj)+ae(ai,aj),1/2*aa(ai,aj)+ac(ai,aj)]},H=function(aj){var am=0,al=0,ai;for(var ak=0;ak<aj.length;ak++){ai=F(aj,ak);am+=ai[0];al+=ai[1]}return[am/aj.length,al/aj.length]},G=function(ak,aj){var ai=[];for(var al=ak.length;al--;){ai.push([[ae(ak,al)-aj,ad(ak,al)+aj],[ac(ak,al)-aj,aa(ak,al)+aj],V(ak,al)])}return ai},T=function(ak){var aj=[];for(var am=ak.length;am--;){aj.push([Z(ak,ak[am]),am])}var ai=aj.sort(function(ap,ao){return ao[0]-ap[0]});var al=[];for(var an=0;an<ai.length;an++){al.push(ak[ai[an][1]])}return al},af=function(aj,ao,ai,ar){var ap=window.g_matrixTmpCache[aj];if(!ap){ap=window.g_matrixTmpCache[aj]=P(aj)}var an=U(ap,ao),aq=ai*an[0],am=ai*an[1],al=ar[0],ak=ar[1];return[[al[0]+aq,al[1]+aq],[ak[0]+am,ak[1]+am],ar[2]]},M=G(M,O),Q=[],Y=Math.PI/12,I=Math.PI/4;window.g_matrixTmpCache={};while(J(M)>0){M=T(M);Q.unshift(M[0]);M.splice(0,1)}while(Q.length!=0){var ab=H(M);var R=F(Q,0);R[0]-=ab[0];R[1]-=ab[1];var W=L(Q.slice(0,1));Q.splice(0,1);var ah=1,S=O;var K=W;while(Z(M,K)!=-1){for(var X=0;X<I;X+=Y){K=af(X,R,S,W);if(Z(M,K)==-1){break}K=af(-X,R,S,W);if(Z(M,K)==-1){break}K=af(Math.PI+X,R,S,W);if(Z(M,K)==-1){break}K=af(Math.PI-X,R,S,W);if(Z(M,K)==-1){break}}ah++;S=ah*O}M.unshift(K)}return G(M,-O)},k=function(G,F){d.each(G,function(J,L){F.fillStyle="rgba(0,0,0,0.5)";var I=G[J][0][0],O=G[J][1][0],N=G[J][0][1],M=G[J][1][1],K=N-I,H=M-O;F.fillRect(I,O,K,H);F.strokeStyle="black";F.lineWidth=2;F.strokeRect(I,O,K,H)})},w=function(){var G=[];d.each(z,function(K,M){var O=M.width/2,J=M.height/2,L=new c.Location(M.lat,M.lon),I=j.tryLocationToPixel(L,c.PixelReference.control),H=I.x,N=I.y;G.push([[-O+H,O+H],[-J+N,J+N],{pin:M.rawPin,halfWidth:O,halfHeight:J}])});var F=q(G,0.05);d.each(F,function(M,O){var K=O[0][0],J=O[1][0],I=O[0][1],H=O[1][1],L=O[2],P=new c.Point(K+L.halfWidth,J+L.halfHeight),N=j.tryPixelToLocation(P,c.PixelReference.control);if(P!=null){L.pin.setLocation(N);L.pin.ShowInfoBox()}else{console.debug("got null for",P.x,P.y)}})},e=function(){j.entities.push(s);i=d("#bingMap");p();var F=false;c.Events.addHandler(j,"viewchangeend",function(){var G=j.getZoom();if(G!=y){F=true;y=G;setTimeout(function(){w()},50)}})},v=function(F){return"surroundingAreaPin_"+F};e();this.addSurroundingAreaPin=function(ak,Q){h++;var R=d("#lqSearchType").val(),S=o[R],M=d("#surroundingAreaSearchType").val(),N="",ag="",J=(ak.location==surroundingAreasMapping.getPrimaryAreaLocation()),ad=surroundingAreasMapping.isAreaSelected(ak.lid),K,F=v(ak.lid);switch(S){case o.PROPERTIES:ag="pid";N="Properties";K="propertycount";break;case o.OFFICES:ag="oid";N="Offices";K="officecount";break;default:case o.AGENTS:ag="aid";N="Agents";K="agentcount";break}var L=ak.displayName;if(M=="Neighborhood"&&L.length>0){var O=L.split(",");if(O!=null&&O.length>0){L=O[0]}}var al=['<div id="',F,'" class="surroundingArea ',J?"mainArea":"notSelected",'">','<span class="areasOnMap">',J?"&nbsp;":"Add &nbsp;<br />",b.Internationalization.getString(N),"</span>",'<span class="areaName">',L,"</span>","</div>"].join(""),aj=d(al);i.append(aj);var ae=aj.outerWidth();aj.remove();var P=j.AddInfobox(Q,{width:ae,height:10,infobox:aj,htmlContent:"&nbsp;"});B.push(P);P.ShowInfoBox();var ai=false,I=false,T=J?0:19,X=aj.width()+T,an=aj.find(".areasOnMap"),Y=aj.find(".areaName"),ab=J?null:x(Y.get(0)),V=-14,ac=an.width(),aa=function(){ak=surroundingAreasMapping.getSurroundingArea(ak.location);var ao=ak[K];an.html((ad||J)?ao:b.Internationalization.getString("Add")+" "+ao+"<br />"+b.Internationalization.getString(N))},Z=function(ao){if(J){return}n.setPolygonsVisible(ak,ao)},W=function(){I=true;ai=true;var ap=portalAjax.getParameters();var ao=ap.lid;ap.sa="";ap.s="";ap.rpp="";ap.ret=ag;ap.zoom=18;ap.bounds=1;ap.lid=ak.lid;ap.t=S;var aq=surroundingAreasMapping.getSelectedSurroundingAreas();if(aq&&aq.length>0){ao=ao+","+aq}if(ao){if(ao.indexOf(ap.lid+",")!=-1){ao=ao.replace(ap.lid+",","")}else{if(ao.indexOf(","+ap.lid)!=-1){ao=ao.replace(","+ap.lid,"")}else{ao=ao.replace(ap.lid,"")}}}ap.deltalid=ao;b.portalAjax.doViewEngineAjax(ak.lid,"/counts.c21",d.param(ap),{cache:true,callback:function(){ai=false;aa();Z(I)}});aj.addClass("hover");an.stop().animate({marginLeft:X+V},{duration:300,easing:"easeOutQuad"})},H=function(){I=false;if(!ai){Z(false)}aj.removeClass("hover");an.stop().animate({marginLeft:X+V-ac},{duration:300,easing:"easeOutQuad"})},af=function(ao){if(ao){aj.parent().css({zIndex:10000})}else{aj.parent().css({zIndex:""})}},am=function(ao){af(ao);if(aj.hasClass("selected")){return}if(ao){W()}else{H()}},U=function(){ad=true;aj.removeClass("notSelected");aj.addClass("selected");an.html("&nbsp;");W();ab.open()},G=function(){ad=false;aj.addClass("notSelected");aj.removeClass("selected");aa();Z(true);ab.close()},ah=function(ao){if(ao){U()}else{G()}};if(J){n.addLocationPolygons(surroundingAreasMapping.getPrimaryArea(),u.primary);W()}else{if(ad){U()}aj.hover(function(){z[ak.lid].doHover(true);surroundingAreasMapping.addHoverSurroundingAreaCheckbox(ak.lid)},function(){z[ak.lid].doHover(false);surroundingAreasMapping.removeHoverSurroundingAreaCheckbox(ak.lid)});aj.click(function(){var ao=surroundingAreasMapping.toggleSelectedSurroundingArea(ak.lid);z[ak.lid].doCheck(ao)})}return{doCheck:ah,doHover:am,lat:ak.lat,lon:ak.lon,height:Y.outerHeight(),width:Y.outerWidth(),rawPin:P}};this.addPolygon=function(F,G,H){var I=new c.Polygon(F,n.getPolygonOptions(G));s.push(I);r.push(I);m[H].push(I)};this.getPolygonOptions=function(I){if(I){var G=0.3,J=0.7,F=t[I],H=new Microsoft.Maps.Color.fromHex(F);H.a=G*255;return{fillColor:H,strokeColor:new c.Color(0,0,0,0),strokeThickness:0}}else{return{visible:false}}};this.clearSurroundingAreas=function(){s.clear();h=0;r=[];m={};d.each(r,function(G,F){s.remove(F)});B=[];j.ClearInfoboxes();if(g==null){g=d("<div id='surroundingAreasOverlay' style='position: absolute; left: 0; top: 0;'></div>");i.append(g)}else{g.empty()}z={}};this.createPins=function(){var G=surroundingAreasMapping.getSurroundingAreas(),H=surroundingAreasMapping.getSelectedSurroundingAreas(),F=[];d.each(G,function(J,K){var I=K.lid,L=new c.Location(K.lat,K.lon);z[I]=n.addSurroundingAreaPin(K,L);F.push(L)});d.each(H,function(J,I){z[I].doCheck(true)});D.setViewFromLocations(F)};this.render=function(){n.clearSurroundingAreas();n.createPins();w()};this.setPolygonsVisible=function(I,G){var L=m[I.location],F=I.lid,K=surroundingAreasMapping.isAreaSelected(F),J=(G)?(K)?u.selected:u.hover:false;if(L){var H=n.getPolygonOptions(J);H.visible=G;d.each(L,function(M,N){N.setOptions(H)})}else{n.addLocationPolygons(I,J)}};this.addLocationPolygons=function(G,F){m[G.location]=[];d.each(G.polygons,function(K,J){var I=J.split("|"),H=[];d.each(I,function(Q,O){var L=O.split(","),P=L[1],N=L[0],R=parseFloat(P),M=parseFloat(N),S=new c.Location(R,M);H.push(S)});n.addPolygon(H,F,G.location)})};this.setChecked=function(G,F){z[G].doCheck(F)};this.setHover=function(G,F){z[G].doHover(F)}}});window.Century21.Setup.mapModule(function(d,b,a,c){a.LocationBoundaryMapLayer=function(i){var f=this,h=new c.EntityCollection({zIndex:0.5}),k=[],g=i,j=function(p,m,q){var l=0.2,o=new c.Color.fromHex(m),n=new c.Color.fromHex("#ff0000");o.a=l*255;n.a=0;var r=new c.Polygon(p,{fillColor:o,strokeColor:n,strokeThickness:0});h.push(r);k.push(r)},e=function(){g.entities.push(h)};e();f.addMapLocation=function(m,n){var l="#003040";j(m,l,n)};f.clearLocationBoundaryMap=function(){d.each(k,function(m,l){h.remove(l)})}}});window.Century21.Setup.mapModule(function(d,b,a,c){a.TooltipManager=function(B,k){var v=this,n=B,u=d.extend({hoverOffset:{x:0,y:0,tip:0},clickOffset:{x:0,y:0,tip:0},initClickTooltip:function(){},initHoverTooltip:function(){},onShowTooltip:function(C){},onHideTooltip:function(C){},onShowClickTooltip:function(C){},onHideClickTooltip:function(C){},onShowHoverTooltip:function(C){},onHideHoverTooltip:function(C){}},k),e,A,s=true,h=true,m=d.Deferred(),z=d.Deferred(),w=u.hoverTemplate,j=u.clickTemplate,y,g=function(D,L,I,K){var M=n.tryLocationToPixel(D.getLocation(),c.PixelReference.control);if(!M){L.hide();return false}var E=L.outerWidth(),F=d("#panelToggleControl").hasClass("closed")?349:0,J=M.x-(E/2)+I.x-F,H=M.y-L.outerHeight()+I.y,G=L.find(".contentTip"),C=d("#mapContainer");if(M.y<0||M.x<0||M.x>C.width()||M.y>C.height()){K()}if(M.x+510-F+(E/2)+16>=d(window).width()){L.css({left:"auto",top:H,right:0});G.css({left:E-(d(window).width()-(M.x+510-F))-I.tip})}else{L.css({right:"auto",left:J,top:H});G.css({left:"50%"})}return{x:J,y:H}},o=function(){if(e){e.getCard().removeClass("hover")}},q=function(){if(m.state()!="resolved"){m.reject()}},l=function(){q();h=true;n.clickHidden=true;if(j!=null){j.hide()}u.onHideTooltip(A);u.onHideClickTooltip(A)},t=function(){if(!A){return}return g(A,j,u.clickOffset,l)},r=function(){if(!e){return}return g(e,w,u.hoverOffset,v.hideHoverTooltip)},x=function(){if(z.state()!="resolved"){z.reject();y=false}},i=function(C){u.initClickTooltip(j,C);j.find(".hoverCover").stop(true).show().css({opacity:1}).animate({opacity:0},500,function(){j.find(".hoverCover").hide()});if(C==e){v.hideHoverTooltip()}u.onShowTooltip(A);u.onShowClickTooltip(A)},p=function(F,H,G,E){var D;if(E){var C=w.css("top");D=r();w.css("top",C)}if(F){D=r();w.stop(true).show();D=r();if(!D){return}w.css({top:D.y+10}).animate({top:D.y},500)}if(H){w.find(".hoverCover").show().css({opacity:1})}if(G){w.find(".hoverCover").animate({opacity:0},500,function(){w.find(".hoverCover").hide()});u.onShowTooltip(e);u.onShowHoverTooltip(e)}},f=function(){var C=n.getRootElement().parentNode;d(C).append(w).append(j);c.Events.addHandler(n,"viewchange",function(){t();r()})};v.showClickTooltip=function(C){q();A=C;h=false;n.clickHidden=false;j.show().find(".hoverCover").stop(true).show().css({opacity:1});t();v.hideHoverTooltip();m=d.Deferred();u.getClickHtml(C).then(m.resolve);m.then(function(D){j.html(D);i(C)})};v.hideTooltipByPinData=function(C){if((A==C)&&(!h)){l()}if((e==C)&&(!s)){v.hideHoverTooltip()}};v.showHoverTooltip=function(C){if(!n.clickHidden){return}o();C.getCard().addClass("hover");if(C.Latitude===undefined){e=C;return}if(C==A){if(!h){return}}if((y)&&(C==e)){if(!s){return}p(true,true,true)}else{y=true;x();z=d.Deferred();u.getHoverHtml(C).then(z.resolve);e=C;s=false;p(true,true,false);z.then(function(D){w.html(D);u.initHoverTooltip(w,C);p(false,false,true,true)})}};v.hideHoverTooltip=function(){if(!(!h&&(e==A))){u.onHideTooltip(e);u.onHideHoverTooltip(e)}s=true;w.stop(true).hide();o();x()};v.clear=function(){v.hideHoverTooltip();l()};f()}});window.Century21.Setup.mapModule(function(d,b,a,c){a.getZindexFromLoc=function(h,g){var e=h,f=parseFloat(e);return Math.floor(100000-(f*1000))}});window.Century21.Setup.mapModule(function(d,b,a,c){a.HeatMapAjax=function(g){var e=this,f,i=function(n){n=Math.round(n).toString();var j=n.split("."),m=j[0],k=j.length>1?"."+j[1]:"",l=/(\d+)(\d{3})/;while(l.test(m)){m=m.replace(l,"$1,$2")}return"$"+m+k},h=function(j,k){g.clearHeatMap();d.each(j.locations,function(l,m){d.each(m.polygons,function(q,w){var u=w.split("|"),t=[],x=(m.meta)?m.meta[k]:null;d.each(u,function(D,B){var y=B.split(","),C=y[1],A=y[0],E=parseFloat(C),z=parseFloat(A),F=new c.Location(E,z);t.push(F)});if(x){var n=0,p=100,s=x,r="",o="";switch(k){case"medianAge":n=20;p=60;s=x.toFixed(1)+" "+b.Internationalization.getString("years old");r="< 20";o="60+";break;case"medianHomePrice":n=30000;p=500000;r="< $30K";o="$500K+";s=i(x);break;case"medianIncome":n=10000;p=200000;r="< $10K";o="$200K+";s=i(x);break}d(".heatMapLegend").show();d("#legendLowRange").text(r);d("#legendHighRange").text(o);var v=m.meta.name+", "+l+"<br>"+s;g.addMapLocation(t,x,n,p,v)}})})};e.getData=function(k,j){f=d.ajax({dataType:"json",data:{xy:k.xy,mx:k.mx,my:k.my,xx:k.xx,zoom:k.zoom,submitted:true,subView:"HeatMapSearch"},url:"/heatmap.c21?",success:function(l){h(l,j.meta);if(j.success){j.success()}},error:j.error})};e.cancel=function(){if(f){f.abort()}}}});window.Century21.Setup.mapModule(function(d,b,a,c){a.LocationBoundaryMapAjax=function(g){var e=this,f,h=function(i){var j=[];g.clearLocationBoundaryMap();if(i){d.each(i.locations,function(k,l){d.each(l.polygons,function(o,n){var m=n.split("|"),p=[];d.each(m,function(v,t){var q=t.split(","),u=q[1],s=q[0],w=parseFloat(u),r=parseFloat(s),x=new c.Location(w,r);p.push(x);j.push(x)});g.addMapLocation(p,k)})})}return j};e.getData=function(l,k,j){if(window.disableLocationBoundaryMap){return}var i=j||{},m=i.data||{};f=d.ajax({dataType:"json",data:d.extend({lids:k,zoom:l.zoom+3,px:b.portalResults.getMapBoundaries(l),submitted:true,subView:"LocationBoundaryMapSearch"},m),url:"/locationboundarymap.c21",success:function(n){var o=h(n);if(i.success){i.success(o)}},error:function(n,p,o){}})};e.cancel=function(){if(f){f.abort()}}}});window.Century21.Setup.mapModule(function(d,b,a,c){a.UniqueLocationStore=function(){var e=this,f={};e.has=function(h,i){var g=false;d.each(f,function(j,k){if(k.lat==h){if(k.lon==i){g=true;return false}}});return g};e.add=function(g,h){if(!e.has(g,h)){f.push({lat:g,lon:h});return true}return false};e.clear=function(){f=[]}}});window.Century21.Setup.mapModule(function(d,b,a,c){a.AgentPinLayer=function(i,g){var f=this,l=new c.EntityCollection({zIndex:4}),h=i,k=new a.UniqueLocationStore(),j=function(o){var p=o.getLocation(),m=new c.Pushpin(p,{icon:"/images/mapping/agent-pushpin-icon.png",width:42,height:61,typeName:"officePin",zIndex:a.getZindexFromLoc(o.getLatitude(),o.getLongitude()),anchor:new c.Point(20,59)}),n=new c.Pushpin(p,{icon:"/images/mapping/agent-pushpin-shadow.png",width:61,height:61,typeName:"officePin",zIndex:1,anchor:new c.Point(20,59)});a.onPinHoverIntent(h,m,function(){b.Track.doEvent("Hybrid Mapping","Agent Map","Hover over an office on the map");g.showHoverTooltip(o)},function(){g.hideHoverTooltip()});c.Events.addHandler(m,"click",function(q){b.Track.doEvent("Hybrid Mapping","Agent Map","Click on an office on the map");g.showClickTooltip(o)});l.push(m);l.push(n)},e=function(){h.entities.push(l);a.onMapClick(h,function(m){g.clear()})};f.setOffices=function(m){f.clearOffices();d.each(m,function(n,o){if(!k.add(o.getLatitude(),o.getLongitude())){return}j(o)})};f.clearOffices=function(){l.clear();k.clear();g.clear()};e()}});window.Century21.Setup.mapModule(function(d,b,a,c){a.OfficePinLayer=function(i,h){var f=this,l=new c.EntityCollection({zIndex:4}),g=i,k=new a.UniqueLocationStore(),j=function(o){var p=o.getLocation(),m=new c.Pushpin(p,{icon:"/images/mapping/office-pushpin-icon.png",width:42,height:60,typeName:"officePin",zIndex:a.getZindexFromLoc(o.getLatitude(),o.getLongitude()),anchor:new c.Point(20,59)}),n=new c.Pushpin(p,{icon:"/images/mapping/office-pushpin-shadow.png",width:63,height:60,typeName:"officePin",zIndex:1,anchor:new c.Point(20,59)});a.onPinHoverIntent(g,m,function(){b.Track.doEvent("Hybrid Mapping","Office Map","Hover over an office on the map");h.showHoverTooltip(o)},function(){h.hideHoverTooltip()});c.Events.addHandler(m,"click",function(q){b.Track.doEvent("Hybrid Mapping","Office Map","Click on an office on the map");h.showClickTooltip(o)});l.push(m);l.push(n)},e=function(){g.entities.push(l);a.onMapClick(g,function(m){h.clear()})};f.setOffices=function(m){f.clearOffices();d.each(m,function(n,o){if(!k.add(o.getLatitude(),o.getLongitude())){return}j(o)})};f.clearOffices=function(){l.clear();k.clear();h.clear()};e()}});window.Century21.Setup.mapModule(function(d,b,a,c){a.onMapClick=function(g,f){var e=false;c.Events.addHandler(g,"mousedown",function(h){e=false});c.Events.addHandler(g,"viewchangestart",function(h){e=true});c.Events.addHandler(g,"mouseup",function(h){if(e){return}f(h)})}});window.Century21.Setup.mapModule(function(d,b,a,c){a.onPinHoverIntent=function(j,f,i,g){var h=500,e=0;j.iTimeoutMouseOver=0;c.Events.addHandler(f,f.getTitle?"mouseenter":"mouseover",function(k){clearTimeout(j.iTimeoutMouseOver);clearTimeout(e);j.iTimeoutMouseOver=setTimeout(i,h)});c.Events.addHandler(f,f.getTitle?"mouseleave":"mouseout",function(k){clearTimeout(j.iTimeoutMouseOver);clearTimeout(e);e=setTimeout(g,h)})}});window.Century21.Setup.mapModule(function(d,b,a,c){a.SchoolPinLayer=function(f,L,H){var p=this,s={},B={},l={},D={},N={},g,h,G={},A=false,m={active:1,normal:2,gold:3},J=1.609344,t=new c.EntityCollection({zIndex:1}),r=new c.EntityCollection({zIndex:6}),v=new c.EntityCollection({zIndex:7}),K=L,z=f,C=function(Q,R){var S=Q.getId(),P=new c.Pushpin(R,{zIndex:a.getZindexFromLoc(R.latitude,R.longitude),icon:"/images/schoolsearch/pin-gold.png",width:63,height:63,anchor:new c.Point(5,18)});a.onPinHoverIntent(K,P,function(){Track.doEvent("Schools","Mapping Page","Hover over a school pushpin");H.showHoverTooltip(Q);p.setPinHighlighted(S,true)},function(){H.hideHoverTooltip();p.setPinHighlighted(S,false)});c.Events.addHandler(P,"click",function(T){Track.doEvent("Schools","Mapping Page","Click on a school pushpin");H.showClickTooltip(Q)});return P},i=function(R){var P=[];d.each(R,function(U,W){var T=W[0],S=W[1],V=new c.Location(T,S);P.push(V)});var Q=new c.Polygon(P,{fillColor:new c.Color(51,245,192,34),strokeColor:new c.Color(100,50,50,50),strokeThickness:3});return Q},M={},e={},q=function(Q){var P=D[Q];if(M[Q]){r.remove(P);delete M[Q]}if(!e[Q]){v.push(P);e[Q]=true}},k=function(Q){var P=D[Q];if(e[Q]){v.remove(P);delete e[Q]}if(!M[Q]){r.push(P);M[Q]=true}},E=function(Q){var P=D[Q];if(e[Q]){v.remove(P);delete e[Q]}if(M[Q]){r.remove(P);delete M[Q]}},y=function(){M={};e={};r.clear();v.clear()},o=function(R,P){var Q=B[R];B[R]=P;return(Q===P)},j=function(Q,P){if(o(Q,m.active)){return}q(Q);P.setOptions({icon:"/images/schoolsearch/apple-pin-active.png",width:63,height:63,visible:true,anchor:new c.Point(19,58)})},O=function(Q,P){if(o(Q,m.normal)){return}q(Q);P.setOptions({icon:"/images/schoolsearch/apple-pin-normal.png",width:63,height:63,visible:true,anchor:new c.Point(19,58)})},x=function(Q,P){if(o(Q,m.gold)){return}k(Q);P.setOptions({icon:"/images/schoolsearch/pin-gold.png",width:0,height:0,visible:false,anchor:new c.Point(5,18)})},w=function(Q,P){q(Q);P.setOptions({icon:"/images/schoolsearch/apple-pin-active.png",width:63,height:63,visible:true,anchor:new c.Point(19,58)})},I=function(R){var P=D[R],Q=(R==g);if(!A&&G[R]){w(R,P)}else{if(G[R]){j(R,P)}else{if(A){if(N[R]){if(Q){j(R,P)}else{O(R,P)}}else{x(R,P)}}else{E(R)}}}},u=function(R,Q){var P=l[R];if(!P){return}if(G[R]){Q=true}P.setOptions({visible:Q})},F=function(S){var V=S.getId();if(D[V]){return}var R=S.getLatitude(),Q=S.getLongitude(),T=new a.PinData(V,R,Q),U=T.getLocation(),P=C(T,U);D[V]=P;s[V]=T;I(V)},n=function(){var P=new b.PortalParams(),Q=P.get("sn");if(Q){J=(Q*1.609344);d("#schoolRadiusSelector").val(Q)}G={};H.setLayer(p);K.entities.push(t);K.entities.push(r);K.entities.push(v);a.onMapClick(K,function(R){H.clear()})};n();p.getSchools=function(){return s};p.setSchoolsInView=function(Q){var P={};d.each(Q,function(R,S){P[S]=true;if(!N[S]){N[S]=true;I(S)}});d.each(N,function(T,R){if(!P[T]){if(!G[T]){var S=s[T];H.hideTooltipByPinData(S);delete N[T];I(T)}}})};p.setSchools=function(P){A=true;d.each(D,function(S,R){if(!G[S]){E(S);var Q=l[S];if(Q){Q.setOptions({visible:false})}delete D[S];delete l[S];delete s[S];delete N[S];delete B[S]}});d.each(P,function(Q,R){F(R)})};p.setSchoolRadius=function(P){J=P};p.setInitialSelectedSchools=function(P){G={};d.each(P,function(R,S){var T=S.getId(),Q=S.getBoundary();G[T]=true;F(S);p.addShape(T,Q)})};p.setSelectedSchools=function(P){d.each(G,function(R,Q){delete G[R];I(R);u(R,false)});g=false;d.each(P,function(Q,R){G[R]=true;I(R);u(R,true)})};p.hideUnselectedSchools=function(){A=false;r.setOptions({visible:false});d.each(N,function(R,P){if(!G[R]){if(g!=R){var Q=D[R];Q.setOptions({visible:false})}}});d.each(s,function(Q,P){if(!G[Q]){H.hideTooltipByPinData(P)}})};p.showUnselectedSchools=function(){A=true;r.setOptions({visible:true});d.each(N,function(R,P){var Q=D[R];Q.setOptions({visible:true})})};p.setPinHighlighted=function(Q,P){if(h){return}g=(P)?Q:null;if(D[Q]){I(Q)}};p.addShape=function(U,T){var P,Q=s[U],S=Q.getLocation(),R=l[U];if(R){t.remove(R);delete l[U]}if(T.length<2){P=z.getCircle(S,J,750,"#323232",3,0.4,"#F5C022",0.2)}else{P=i(T)}t.push(P);l[U]=P};p.getPinData=function(P){return s[P]};p.setClickPin=function(Q,P){var R=Q.getId();if(P){g=R;h=R;I(R)}else{g=null;h=null;I(R)}};p.setShapeVisibility=function(R,P){var Q=R.getId();u(Q,P)};p.clearSchools=function(){B={};s={};l={};D={};N={};g=false;h=false;G={};A=false;t.clear();y();H.clear()}}});window.Century21.Setup.mapModule(function(d,b,a,c){a.ResultPropertyPinLayer=function(j,f){var g=this,i,l=new c.EntityCollection({zIndex:4}),h=j,k=function(n,o){var m=new c.Pushpin(o,{icon:"/images/mapping/property-pushpin-gold.png",width:49,height:32,text:n.getShortPrice(),typeName:"propertyPin",zIndex:a.getZindexFromLoc(o.latitude,o.longitude),anchor:new c.Point(11,31)});a.onPinHoverIntent(h,m,function(){b.Track.doEvent("Hybrid Mapping","Property Map","Hover over a property on the map");f.showHoverTooltip(n)},function(){f.hideHoverTooltip()});c.Events.addHandler(m,"click",function(p){b.Track.doEvent("Hybrid Mapping","Property Map","Click on a property on the map");f.showClickTooltip(n)});return m},e=function(){h.entities.push(l);a.onMapClick(h,function(m){f.clear()})};e();g.getProperties=function(){return i};g.setProperties=function(m){i=m;l.clear();d.each(m,function(o,p){var q=p.getLocation(),n=k(p,q);l.push(n)})};g.clearProperties=function(){l.clear();i=[];f.clear()}}});window.Century21.Setup.mapModule(function(d,b,a,c){a.BackgroundPropertyPinLayer=function(f,h){var m=this,j=f,n,e=false,l,k=function(p,o){var q=new c.Pushpin(o,{icon:"/images/mapping/property-pushpin-cluster.png",zIndex:a.getZindexFromLoc(o.latitude,o.longitude),width:27,height:32,text:p.length.toString(),typeName:"clusterPin",anchor:new c.Point(8,31)});c.Events.addHandler(q,"click",function(t){var r=[];d.each(p,function(u,w){var v=w.getLocation();r.push(v)});var s=c.LocationRect.fromLocations(r);j.setView({bounds:s})});return q},i=function(p){var o=new c.Pushpin(p._LatLong,{icon:"/images/mapping/grey-pushpin.png",zIndex:a.getZindexFromLoc(p.getLatitude(),p.getLongitude()),width:23,height:18,typeName:"propertyPin",anchor:new c.Point(6,18)});a.onPinHoverIntent(j,o,function(){b.Track.doEvent("Hybrid Mapping","Property Map","Hover over a property on the map");h.showHoverTooltip(p,true)},function(){h.hideHoverTooltip()});c.Events.addHandler(o,"click",function(q){b.Track.doEvent("Hybrid Mapping","Property Map","Click on a property on the map");h.showClickTooltip(p)});return o},g=function(){a.onMapClick(j,function(o){h.clear()})};g();m.setProperties=function(o){if(e){n.SetData(o)}else{l=function(){n.SetData(o)}}};m.clearProperties=function(){m.setProperties([]);h.clear()};m.onClusterModuleLoaded=function(){n=new window.ClusteredEntityCollection(j,{singlePinCallback:i,clusteredPinCallback:k});var o=n.GetLayer();o.setOptions({zIndex:3});e=true;if(l){l()}}}});window.Century21.Setup.mapModule(function(d,b,a,c){a.PropertyPinAjax=function(g,h){var e=this,f,i=function(j){h.setProperties(j)};e.getData=function(k,j){if(window.disablePropertySearchGeo){return}f=d.ajax({dataType:"json",data:d.extend({xy:k.xy,mx:k.mx,my:k.my,xx:k.xx},j.refine),url:"/csjson/propertysearchgeo",success:function(m){var n=[],l=g.getProperties();d.each(m.points,function(q,o){var t=o[0],u=o[1],p=o[2],s=new a.PinData(p,t,u);var r=false;d.each(l,function(v,w){if(w.getId()==p){r=true;return false}});if(!r){n.push(s)}});i(n)},error:function(l,n,m){if(n=="abort"){return}}})};e.cancel=function(){if(f){f.abort()}}}});window.Century21.Setup.mapModule(function(d,b,a,c){a.PinData=function(g,m,f,i){var o=this,h=g,j=m,n=f,l=i||{},k=l.card||d(),e=l.shortPrice;o.getId=function(){return h};o.getLatitude=function(){return j};o.getLongitude=function(){return n};o.getLocation=function(){return new c.Location(j,n)};o.getShortPrice=function(){return e};o.getCard=function(){return k};o.getData=function(p){return l[p]};o.Latitude=m;o.Longitude=f}});window.Century21.Setup.mapModule(function(d,b,a,c){a.Map=function(E,H){var r=this,u=true,L=false,K=new a.LassoTool("lassoTool",r),v=new c.EntityCollection({zIndex:2}),V=null,ap=new a.AreaOverlayUi(),T=E.get(0),y=d.extend({lockAutoZoomToPins:false},H||{}),Y=new c.Map(T,{credentials:a.bingmapCredentials,bounds:y.bounds,center:(y.center&&y.center.latitude)?y.center:undefined,zoom:y.zoom,mapTypeId:c.MapTypeId.auto,customizeOverlays:true,enableSearchLogo:false}),S,aa,z,af=y.lockAutoZoomToPins,U=new a.BackgroundPropertyTooltipManager(Y),P=new a.ResultPropertyTooltipManager(Y),Z=new a.OfficeTooltipManager(Y),x=new a.AgentTooltipManager(Y),al=new a.SchoolTooltipManager(Y),ai=new a.MyPlaceTooltipManager(Y),h=new a.SurroundingAreaTooltipManager(Y),X=new a.HeatMapLayer(Y,v),J=new a.HeatMapAjax(X),f=new a.LocationBoundaryMapLayer(Y),j=new a.LocationBoundaryMapAjax(f),ah=new a.SchoolPinLayer(r,Y,al),an=new a.SurroundingAreaMapLayer(Y,this,h),l=new a.ZoomErrorMessage(Y),s=new a.POIMapLayer(Y,l),ad=new a.MyPlacesMapLayer(r,Y,ai),Q=new a.ResultPropertyPinLayer(Y,P),am=new a.BackgroundPropertyPinLayer(Y,U),G=new a.PropertyPinAjax(Q,am),p=new a.OfficePinLayer(Y,Z),o=new a.AgentPinLayer(Y,x),e=false,aj=null,k=null,F=function(aq){var ar=(aq=="")?null:aq;b.portalAjax.setHash(b.portalAjax.getHash(),true,{poi:ar})},I=function(){var aq="";d(".pointOfInterestCheckbox").each(function(){if(d(this).attr("checked")){aq+=((aq.length>0?",":"")+d(this).val())}});return aq},M=function(){if(r.isSurroundingAreaViewSelected()){l.disable("poi");return}var aq=I();if(aq.length>0){if(l.inRange()){s.render(aq);F(aq)}else{l.enable("poi")}}else{l.disable("poi");s.render(aq);F(aq)}},ao=function(){if(!V){return}V.setOptions({visible:false});V.setOptions({visible:true})},W=function(){if(r.isSurroundingAreaViewSelected()){l.disable("heatmap");return}var ar=ap.getAreaOverlaySelection();if(ar){if(l.inRange()){l.disable("heatmap");var aq=r.getBounds();f.clearLocationBoundaryMap();J.getData(aq,{meta:ar,success:function(){ao()},error:function(at,av,au){if(av=="abort"){return}}})}else{l.enable("heatmap");f.clearLocationBoundaryMap()}}else{l.disable("heatmap");X.clearHeatMap();J.cancel();r.refreshLocationBoundaryMap()}},ae=function(){if(window.websiteCode=="IDX"){return}var ar=r.getBounds(),at=d("#cacheServerSearchURL").val(),aq=b.Helpers.queryToJSON(at);delete aq.rpp;delete aq.start;G.getData(ar,{refine:aq})},D=function(){am.onClusterModuleLoaded();e=true;ae()},B=function(){var ar=new b.PortalParams().getParam("poi"),aq=(ar)?ar.split(","):[];d(".pointOfInterestCheckbox").change(function(){if(d(this).attr("checked")){b.Track.doEvent("Hybrid Mapping","Points of Interest Tool","Select "+d(this).val())}else{b.Track.doEvent("Hybrid Mapping","Points of Interest Tool","Deselect "+d(this).val())}M()}).each(function(){var at=d(this);if(d.inArray(at.val(),aq)>=0){at.attr("checked","checked")}});d.uniform.update()},ac=function(){if(!V){return}v.remove(V);V=null},A=function(){var aq=d("#drawTool"),ar=d("#drawingToolInstructions");d("#saveSearchButton").css("display","inline");ac();K.stop();aq.removeClass("selected");ar.removeClass("active");r.refreshLocationBoundaryMap()},R=function(){var ar=d("#drawTool"),aq=d("#bottomMapToolsDropDown"),at=d("#drawingToolInstructions");ar.click(function(){if(ar.hasClass("selected")){b.Track.doEvent("Hybrid Mapping","Tool Bar","Deselect Drawing Tool");d("#saveSearchButton").css("display","inline");b.portalResults.removeLiquidMapDrawingToolFacet(null);ac();ar.removeClass("selected");at.removeClass("active");r.refreshLocationBoundaryMap()}else{if(l.inRange()){b.Track.doEvent("Hybrid Mapping","Tool Bar","Select Drawing Tool");d("#saveSearchButton").css("display","none");q();ar.addClass("selected");at.addClass("active").css("bottom",56+(aq.is(":visible")?160:0));var au=ar.offset(),ay=ar.height(),ax=ar.width(),aw=d("<div class='bob' />").css({position:"absolute",left:au.left.toString()+"px",top:au.top.toString()+"px",height:ay,zIndex:99999,width:ax,cursor:"pointer",backgroundColo:"green"});aw.show().click(function(){K.stop();ar.removeClass("selected");at.removeClass("active")});d(document.body).append(aw);K.start(function(){aw.hide()})}else{l.enableTemporarily("lasso")}var av=d("#selectedSchoolIds").val();if(av!=null&&av!=""){b.SchoolSearch.showSchoolDeletionModal();return}b.SchoolSearch.clearSchoolSearchCriteria();b.SchoolSearch.closeWindow()}})},O=function(){L=true;if(!r.isSurroundingAreaViewSelected()){b.Track.doEvent("Hybrid Mapping","Tool Bar","Select My Places Tool")}d("#saveSearchButton").css("display","none");d("#myPlacesTool").addClass("selected");d("#mapToolTip").hide();b.Places.getMyPlaces()},n=function(){L=false;if(!r.isSurroundingAreaViewSelected()){b.Track.doEvent("Hybrid Mapping","Tool Bar","Deselect My Places Tool")}d("#saveSearchButton").css("display","inline");d("#myPlacesTool").removeClass("selected");d("#myPlacesToolInstructions").removeClass("active");r.clearMyC21Places()},ak=function(){return L},ab=function(){var aq=d("#myPlacesTool");aq.click(function(){if(aq.hasClass("selected")){n()}else{O()}});d("#myPlacesToolInstructions .addPlaceLink").click(function(){b.Track.doEvent("Hybrid Mapping","Tool Bar","Add/Edit/View My Places");b.Places.loadMyPlacesModal()})},N=function(){return d("#searchWithinMap").attr("checked")},q=function(){d("#searchWithinMap").attr("checked",false);d("#searchWithinMap").attr("disabled","disabled")},ag=function(){if(N()){if(!l.inRange()){b.portalResults.removeLiquidMapSearchWithinMapFacet();l.enable("searchWithinMap");return}if(aj==Y.getZoom().toString()&&k.toString()==Y.getBounds().toString()){b.portalResults.changeLiquidMapSearchWithinMapFacet(true);l.disable("searchWithinMap");return}if(!l.inRange()){r.refreshLocationBoundaryMap()}if(l.inRange()){b.portalResults.changeLiquidMapSearchWithinMapFacet();l.disable("searchWithinMap")}else{b.portalResults.removeLiquidMapSearchWithinMapFacet();l.enable("searchWithinMap")}r.refreshLocationBoundaryMap();if(e){ae()}}else{l.disable("searchWithinMap")}},t=function(){l.addTool("searchWithinMap",b.Internationalization.getString("Can not use the Search Within Map feature at this level"));l.addTool("poi",b.Internationalization.getString("There are too many points of interest to show at once."));l.addTool("heatmap",b.Internationalization.getString("There are too many heatmap locations to show at once."));l.addTool("lasso",b.Internationalization.getString("Can not use draw tool at this level"))},m=function(){window.Ve7Infobox(Y);a.MapTypeOverlay(Y);r.updatePropertyPins();c.registerModule("clusterModule","/js/V7ClientSideClustering.js");c.loadModule("clusterModule",{callback:D});t();B();R();ab();Y.entities.push(v);ap.setClickEvent(W);aj=Y.getZoom().toString();k=Y.getBounds();c.Events.addThrottledHandler(Y,"viewchangeend",function(){l.refresh();M();W();ag();r.refreshLocationBoundaryMap()},250);W();ag()},w=function(av,aq,au,at){if(av.attr("hoverSet")==="y"){return}av.attr("hoverSet","y");var ar=av.hasClass("schoolRecord")?av:av.parent();ar.hover(function(){if(av.hasClass("schoolRecord")){Track.doEvent("Schools","School Results Dialog","Hover over a school")}else{var aw="Center Lane";var ax=d("#lqSearchType").val();if(ax=="PROPERTIES"){Track.doEvent("Hybrid Mapping","Property "+aw,at)}else{if(ax=="AGENTS"){Track.doEvent("Hybrid Mapping","Agent "+aw,at)}else{if(ax=="OFFICES"){Track.doEvent("Hybrid Mapping","Office "+aw,at)}}}}aq.showHoverTooltip(au)},function(){aq.hideHoverTooltip()})},g=function(){if(!u){return}if(!aa){return}if(!z){return}var aq=aa.concat(z);r.setViewFromLocations(aq);if(window.websiteCode=="IDX"){r.fixAfterShow()}u=false},i=function(ar,at){r.clearAll();ae();S=at;r.refreshLocationBoundaryMap();if(ar.length>0){var aq=[];d.each(ar,function(au,av){var aw=av.getLocation();if(aw.latitude){aq.push(aw)}});if(aq.length==0){return}if(N()){r.setViewFromLocations(aq);u=false}else{if(u){aa=aq;g()}}}};r.resetFirstViewLoad=function(){af=false;u=true;z=null;aa=null};r.lockAutoZoomToPins=function(){af=true};r.unlockAutoZoomToPins=function(){af=false};r.setViewFromLocations=function(aq){if(af){return}if(N()){return}var ar=c.LocationRect.fromLocations(aq);Y.setView({bounds:ar})};r.modifyZoom=function(ar){var aq=Y.getTargetZoom();Y.setView({zoom:aq+ar})};r.setMapView=function(aq,at){var ar=new c.LocationRect.fromCorners(new c.Location(at.xy,at.mx),new c.Location(at.my,at.xx));Y.setView({bounds:ar})};r.getPOI=function(){return s};r.getCircle=function(aB,au,aF,aA,ax,aq,av,aH){var aw=6371,ay=(aB.latitude*Math.PI)/180,at=(aB.longitude*Math.PI)/180,aJ=parseFloat(au)/aw,aG=[],az=parseInt(360/aF,10)||10,aC;for(aC=0;aC<=360;aC+=az){var ar=new c.Location(0,0);var aK=aC*Math.PI/180;ar.latitude=Math.asin(Math.sin(ay)*Math.cos(aJ)+Math.cos(ay)*Math.sin(aJ)*Math.cos(aK));ar.longitude=((at+Math.atan2(Math.sin(aK)*Math.sin(aJ)*Math.cos(ay),Math.cos(aJ)-Math.sin(ay)*Math.sin(ar.latitude)))*180)/Math.PI;ar.latitude=(ar.latitude*180)/Math.PI;aG.push(ar)}var aI=new c.Color.fromHex(av);aI.a=aH*255;var aE=new c.Color.fromHex(aA);aE.a=aq*255;var aD=new c.Polygon(aG,{fillColor:aI,strokeColor:aE,strokeThickness:ax});return aD};r.getBounds=function(){var ar=Y.getBounds(),aq={xy:ar.getNorth().toString(),mx:ar.getWest().toString(),my:ar.getSouth().toString(),xx:ar.getEast().toString(),zoom:Y.getZoom()};return aq};r.getZoom=function(){return Y.getZoom()};r.updateOfficePins=function(){var aq=[];d("#listContainer").find(".CardWrapper.officeCard").each(function(){var av=d(this),au=av.find("input.officeLatitude").val(),ar=av.find("input.officeLongitude").val(),at=av.find("input.officeId").val();var aw=new a.PinData(at,au,ar,{card:av});w(av,Z,aw,"Hover over an office in the search results");aq.push(aw)});i(aq,"office");p.setOffices(aq)};r.updateAgentPins=function(){var aq=[];d("#agentSearchMapHoverState").find(".agentsSearchMapOverlay").each(function(){var at=d(this),av=at.find("input.agentsOfficeLatitude").val(),ar=at.find("input.agentsOfficeLongitude").val(),au=at.find("input.officeId").val(),ax=d(".agentOffice"+au);var aw=new a.PinData(au,av,ar,{card:d()});w(ax,x,aw,"Hover over an agent in the search results");aq.push(aw)});i(aq,"agent");o.setOffices(aq)};r.refreshMyC21Places=function(){if(L){ad.render()}};r.enableMyC21Places=function(){O()};r.disableMyC21Places=function(){n()};r.isMyPlacesEnabled=function(){return ak()},r.clearMyC21Places=function(){ad.clearMyPlaces()};r.geocodeAddressAndSavePlace=function(aq){ad.geocodeAddressAndSavePlace(aq)};r.refreshSurroundingAreaPin=function(aq){an.refreshPin(aq)};r.renderSurroundingAreas=function(){an.render()};r.setSurroundingAreaChecked=function(ar,aq){an.setChecked(ar,aq)};r.setSurroundingAreaHover=function(ar,aq){an.setHover(ar,aq)};r.clearSurroundingAreas=function(){an.clearSurroundingAreas()};r.isSurroundingAreaViewSelected=function(){return d("#surroundingAreasLiqMap").hasClass("selected")};r.clearLocationBoundaryMap=function(){f.clearLocationBoundaryMap()};r.setSchoolRadius=function(aq){ah.setSchoolRadius(aq)};r.setInitialSelectedSchools=function(aq){ah.setInitialSelectedSchools(aq)};r.setSelectedSchools=function(aq){ah.setSelectedSchools(aq)};r.showUnselectedSchools=function(){ah.showUnselectedSchools()};r.hideUnselectedSchools=function(){ah.hideUnselectedSchools()};r.deselectDrawingTool=function(){A()};r.setSchools=function(aq){ah.setSchools(aq);r.updateSchoolHoverState()};r.clearSchools=function(){ah.clearSchools()};r.setSchoolsInView=function(aq){ah.setSchoolsInView(aq)};r.updateSchoolHoverState=function(){d("#schoolSearchResults").find(".schoolRecord").each(function(){var aq=d(this),av=aq.find(".clickForSchoolDetails"),ar=aq.find(".viewSchoolDetailsLink"),au=aq.find("input.schoolID").val(),at=ah.getPinData(au);if(aq.attr("hoverSet")!=="y"){ar.click(function(){al.showClickTooltip(at)});av.click(function(){ar.click()})}w(aq,al,at,"Hover over a school")})};r.refreshSearchWithinMap=function(){ag()};r.refreshLocationBoundaryMap=function(){var at=ap.getAreaOverlaySelection();if(N()||at||r.isSurroundingAreaViewSelected()){r.clearLocationBoundaryMap();return}var ar=r.getBounds(),aq=d("#searchLocationLIDS").val();if(aq==""){z=[];g()}else{j.getData(ar,aq,{success:function(au){z=au;g()}})}};r.updatePropertyPins=function(){var aq=[];d("#listContainer").find(".CardWrapper.propertyCard").each(function(){var ar=d(this),aw=ar.find("input[name=proplatitude]").val(),av=ar.find("input[name=proplongitude]").val(),au=ar.find("input[name=shortCurrency]").val(),at=ar.attr("id").replace(/property/,"");var ax=new a.PinData(at,aw,av,{shortPrice:au,card:ar});w(ar,P,ax,"Hover over a property in the search results");aq.push(ax)});i(aq,"property");Q.setProperties(aq)};r.clearAll=function(){p.clearOffices();o.clearOffices();Q.clearProperties();am.clearProperties();G.cancel();j.cancel()};r.clearTooltips=function(){U.clear();P.clear();Z.clear();x.clear();ai.clear();al.clear();h.clear()};r.clearHeatMap=function(){X.clearHeatMap();if(r.isSurroundingAreaViewSelected()){l.disable("heatmap")}};r.refreshHeatmap=function(){W()};r.clearPOI=function(){s.clearPOI()};r.refreshPOI=function(){M()};r.addLassoPoly=function(aq){var ar=new c.Polyline(aq,{fillColor:new c.Color(0,0,0,0),strokeColor:new c.Color(255,0,0,255)});d("#drawTool").addClass("selected");ac();v.push(ar);V=ar};var C=[];r.addLassoPolyByPixels=function(ar){var aq=Y.tryPixelToLocation(ar,c.PixelReference.control);C=[];d.each(aq,function(at,au){C.push(au.longitude);C.push(au.latitude)});aq.push(aq[0]);r.addLassoPoly(aq);b.portalResults.changeLiquidMapDrawingToolFacet(null,C)};r.fixAfterShow=function(){var aq=Y.getZoom();Y.setView({zoom:aq+1});setTimeout(function(){Y.setView({zoom:aq})},1000)};m()}});window.Century21.Setup.mapModule(function(d,b,a,c){a.ZoomErrorMessage=function(w){var r=this,k=w,n=d("#heatMapLabel"),j=10,l=12,v={},t=[],g=0,o=function(x){n.html(x+"<br/>"+b.Internationalization.getString("Please zoom in to see updated tools.")).show()},h=function(){var x=t[0],y=v[x];o(y)},s=function(x){var y=d.inArray(x,t);return y},m=function(x){return(s(x)!==-1)},i=function(x){var y=s(x);if(y>-1){t.splice(y,1)}},p=function(){o(b.Internationalization.getString("Map features you requested are not available at this zoom level."))},q=function(){n.hide()},e=function(){if(window.websiteCode=="IDX"){return(g>l)}return(g>j)},u=function(){if(t.length==0){q()}else{if(t.length==1){h()}else{p()}}},f=function(){};r.inRange=e;r.refresh=function(){g=k.getTargetZoom();u()};r.addTool=function(x,y){v[x]=y};r.enable=function(x){if(m(x)){return}t.push(x);u()};r.enableTemporarily=function(x){n.css({backgroundColor:"#fff",color:"black"}).animate({backgroundColor:"black",color:"white"},{easing:"easeInQuad",duration:500});r.enable(x);i(x)};r.disable=function(x){i(x);u()};f()}});window.Century21.Setup.mapModule(function(d,b,a,c){a.LassoTool=function(e,w){var o=this,f=d("#"+e),i=new window.Raphael(e),t=30,j=false,u=false,p=0,h=0,n,q,m,k=90,l=30,s;function g(y,A,x,z){var B=(x-y),C=(z-A);return Math.sqrt((B*B)+(C*C))}function v(y,x){if(q){q.remove()}q=i.path(y);q.attr({fill:"#000","fill-opacity":(x)?0:0.2,stroke:"#3b4449","stroke-dasharray":(x)?undefined:"- ","stroke-width":3,"stroke-linejoin":"round"})}function r(){j=false;q.remove();q=null}f.mousedown(function(x){if(u){return}j=true;n=null;m=[]});f.mouseup(function(){j=false;if(m.length<3){return}u=true;w.addLassoPolyByPixels(m);f.removeClass("drawing");v(n+" z",true);q.animate({opacity:0,transform:"s1.5"},500,">",function(){r();u=false;f.removeClass("showing");if(s){s()}})});f.mousemove(function(C){if(u){return}if(!j){return}var x=d(this).parent().offset(),D=C.pageX-x.left,B=C.pageY-x.top,z=D-p,G=B-h,y=g(D,B,p,h),A=" l "+z.toString()+" "+G.toString();if(n){v(n+A)}if(y>t){if(!n){n="M "+D.toString()+" "+B.toString()}else{n+=A}var F=new c.Point(D,B);m.push(F);p=D;h=B}var E=k;if(window.websiteCode=="IDX"){E=l}if(m.length>E){window.alert("Your shape is too complicated. Please try drawing a more simple shape.");r()}});d(window).resize(function(){var x=f.width(),y=f.height();i.setSize(x,y)});o.start=function(x){f.addClass("drawing showing");i=new window.Raphael(e);s=x};o.stop=function(){if(s){s()}j=false;f.removeClass("showing")}}});window.Century21.Setup.mapModule(function(d,b,a,c){a.AgentTooltipManager=function(k){var h=this,i=k,f=d("<div class='agentSummaryHoverOverlay'><div class='contentTip'></div></div>"),g=d("<div class='agentsSearchMapOverlay agentSummaryClickOverlay'><div class='contentTip'></div></div>"),j=false,l=new a.TooltipManager(i,{hoverTemplate:f,clickTemplate:g,initClickTooltip:function(m,n){m.on({mouseenter:function(){b.Track.doEvent("Hybrid Mapping","Agent Map","Hover over an agent in the office");var o=d(this);o.addClass("hover");d("#agent"+o.attr("agentId")).addClass("hover")},mouseleave:function(){var o=d(this);o.removeClass("hover");d("#agent"+o.attr("agentId")).removeClass("hover")},click:function(){if(j){return}j=true;document.location.href=d(this).find("a").eq(0).click().attr("href")}},".agentRow");b.ImageLazyLoader.loadImages()},getClickHtml:function(m){return d.Deferred(function(n){b.portalResults.getAgentSearchListForOffice(null,m.getId(),function(){var o=d("#agentsSearchMapOverlay").html();n.resolve(o)})}).promise()},getHoverHtml:function(m){return d.Deferred(function(n){var q=m.getId(),p="#agentsSearchMapHoverState_"+q,o=d(p).html();n.resolve(o)}).promise()},hoverOffset:{x:1+510,y:-70+147,tip:6},clickOffset:{x:1+510,y:-45+147,tip:5}}),e=function(){};h.showClickTooltip=l.showClickTooltip;h.showHoverTooltip=l.showHoverTooltip;h.hideHoverTooltip=l.hideHoverTooltip;h.clear=l.clear;e()}});window.Century21.Setup.mapModule(function(d,b,a,c){a.OfficeTooltipManager=function(j){var h=this,i=j,f=d("<div class='officeSummaryHoverOverlay'><div class='contentTip'></div></div>"),g=d("<div class='officeSearchMapOverlay officeSummaryClickOverlay'><div class='contentTip'></div></div>"),k=new a.TooltipManager(i,{hoverTemplate:f,clickTemplate:g,getClickHtml:function(l){return d.Deferred(function(m){var p=l.getId(),o="#officeSummaryClickOverlay_"+p,n=d(o).html();m.resolve(n)}).promise()},getHoverHtml:function(l){return d.Deferred(function(m){var p=l.getId(),o="#officeSummaryHoverOverlay_"+p,n=d(o).html();m.resolve(n)}).promise()},hoverOffset:{x:1+510,y:-70+147,tip:6},clickOffset:{x:1+510,y:-45+147,tip:5}}),e=function(){};h.showClickTooltip=k.showClickTooltip;h.showHoverTooltip=k.showHoverTooltip;h.hideHoverTooltip=k.hideHoverTooltip;h.clear=k.clear;e()}});window.Century21.Setup.mapModule(function(d,b,a,c){a.PropertyPaginator=function(q){var l=q.find(".propPhotos"),m=l.find(".slideImgBtnLeft"),g=l.find(".slideImgBtnRight"),r=l.find("img"),u=l.find(".photoLink"),f=u.attr("href"),t=q.find(".allPhotos"),o=q.find(".totalImagesText"),p=t.find(".propImageURL"),s=[],k=0,j=false,i=window.internationalization,n=new Image();n.src="/images/loading/snake-black-32x32.gif";function h(w){var v=i.getString("Image")+" "+(w+1).toString()+" "+i.getString("of")+" "+s.length.toString();o.text(v)}function e(x){if(j){return}var w=new Image(),v=s[x];r.src=n.src;j=true;w.onload=function(){k=x;r.attr("src",v);j=false;u.attr("href",f+"?g="+x);h(x)};w.src=v}p.each(function(v,x){var w=d(x),y=w.text();s.push(y)});e(0);m.click(function(){var v=(k+s.length-1)%s.length;e(v)});g.click(function(){var v=(k+1)%s.length;e(v)});if(s.length<=1){m.hide();g.hide()}}});window.Century21.Setup.mapModule(function(d,b,a,c){a.SchoolTooltipManager=function(g){var p=this,o=g,j,m=d("<div class='schoolSummaryHoverOverlay'><div class='contentTip'></div></div>"),h=d("<div class='schoolSummaryClickOverlay'><div class='contentTip'></div></div>"),l=function(u,s){var r=s.getId(),q=u.html(),t=b.SchoolSearch.parseBoundary(r,q);j.addShape(r,t)},i=function(q,r){b.portalAjax.doViewEngineAjax("SchoolSummaryOverlay","/schoolsearch.c21",d.param({sid:q}),{callback:r})},f=function(q,r){return d.Deferred(function(s){var t=q.getId();i(t,function(){var v=d(r),u=v.html();s.resolve(u)})}).promise()},n=function(s,q){if(!s){return}var r=s.getId();j.setShapeVisibility(s,q);j.setPinHighlighted(r,q);d("#schoolRecord_"+r).toggleClass("hover",q)},e=new a.TooltipManager(o,{hoverTemplate:m,clickTemplate:h,getClickHtml:function(q){return f(q,"#schoolSummaryClickOverlay")},onShowClickTooltip:function(q){if(!q){return}j.setClickPin(q,true);l(d("#schoolSummaryClickOverlay"),q);n(q,true)},onHideClickTooltip:function(q){if(!q){return}j.setClickPin(q,false);n(q,false)},onShowHoverTooltip:function(q){if(!q){return}l(d("#schoolSummaryHoverOverlay"),q);n(q,true)},onHideHoverTooltip:function(q){if(!q){return}n(q,false)},getHoverHtml:function(q){return f(q,"#schoolSummaryHoverOverlay")},hoverOffset:{x:1+510,y:-73+147,tip:-4},clickOffset:{x:9+510,y:-73+147,tip:-4}}),k=function(){};p.showClickTooltip=e.showClickTooltip;p.showHoverTooltip=e.showHoverTooltip;p.hideHoverTooltip=e.hideHoverTooltip;p.hideTooltipByPinData=e.hideTooltipByPinData;p.clear=e.clear;p.setLayer=function(q){j=q};k()}});window.Century21.Setup.mapModule(function(d,b,a,c){a.ResultPropertyTooltipManager=function(k){var h=this,i=k,f=d("<div class='propertySummaryHoverOverlay'><div class='contentTip'></div></div>"),g=d("<div class='propertySummaryClickOverlay'><div class='contentTip'></div></div>"),j=function(n,m){a.PropertyPaginator(n)},l=new a.TooltipManager(i,{hoverTemplate:f,clickTemplate:g,initClickTooltip:j,getClickHtml:function(m){return d.Deferred(function(n){var o=m.getId(),p=d("#propertySummaryClickOverlay_"+o);g.find(".contentTip").empty();d(".propertySummaryClickOverlay").removeClass("favorite");b.ViewSession.setFavoriteProperty(d(".propertySummaryClickOverlay"),o);n.resolve(p.html())}).promise()},getHoverHtml:function(m){return d.Deferred(function(n){var o=m.getId(),p=d("#propertySummaryHoverOverlay_"+o);n.resolve(p.html())}).promise()},hoverOffset:{x:11+510,y:-47+147,tip:-4},clickOffset:{x:10+510,y:-21+147,tip:-4}}),e=function(){};h.showClickTooltip=l.showClickTooltip;h.showHoverTooltip=l.showHoverTooltip;h.hideHoverTooltip=l.hideHoverTooltip;h.clear=l.clear;e()}});window.Century21.Setup.mapModule(function(d,b,a,c){a.BackgroundPropertyTooltipManager=function(f){var m=this,k=f,j=d("<div class='propertySummaryHoverOverlay'><div class='contentTip'></div></div>"),g=d("<div class='propertySummaryClickOverlay'><div class='contentTip'></div></div>"),l=function(o,n){a.PropertyPaginator(o)},h=function(n,o){b.portalAjax.doViewEngineAjax("PropertySummaryOverlay","/propertysummary.c21",d.param({pid:n}),{callback:o})},e=new a.TooltipManager(k,{hoverTemplate:j,clickTemplate:g,initClickTooltip:l,getClickHtml:function(n){return d.Deferred(function(o){var p=n.getId();g.find(".contentTip").empty();h(p,function(){var r=d("#propertySummaryClickOverlay"),q=r.html();o.resolve(q)})}).promise()},getHoverHtml:function(n){return d.Deferred(function(o){var p=n.getId();h(p,function(){var r=d("#propertySummaryHoverOverlay"),q=r.html();o.resolve(q)})}).promise()},hoverOffset:{x:2+510,y:-38+147,tip:-4},clickOffset:{x:10+510,y:-21+147,tip:-4}}),i=function(){};m.showClickTooltip=e.showClickTooltip;m.showHoverTooltip=e.showHoverTooltip;m.hideHoverTooltip=e.hideHoverTooltip;m.clear=e.clear;i()}});window.Century21.Setup.mapModule(function(d,b,a,c){a.MyPlaceTooltipManager=function(i){var g=this,h=i,f=d("<div class='myPlaceMapHoverOverlay'><div class='contentTip'></div></div>"),j=new a.TooltipManager(h,{hoverTemplate:f,getHoverHtml:function(k){return d.Deferred(function(l){var m=d("#myPlaceMapHoverOverlay");l.resolve(m.html())}).promise()},hoverOffset:{x:1+510,y:-45+147,tip:4},clickOffset:{x:10+510,y:-21+147,tip:-4}}),e=function(){};g.showHoverTooltip=function(k){f.attr("class","myPlaceMapHoverOverlay pinHover"+k.getData("colorIndex"));return j.showHoverTooltip(k)};g.hideHoverTooltip=j.hideHoverTooltip;g.clear=j.clear;e()}});window.Century21.Setup.mapModule(function(d,b,a,c){a.SurroundingAreaTooltipManager=function(i){var g=this,h=i,j,f=d("<div class='surroundingAreaMapHoverOverlay'><div class='contentTip'></div></div>"),j=new a.TooltipManager(h,{hoverTemplate:f,getHoverHtml:function(k){return d.Deferred(function(l){var m=k.getId(),n=d("#surroundingAreaMapHoverOverlay");l.resolve(n.html())}).promise()},hoverOffset:{x:1+510,y:-45+147,tip:4},clickOffset:{x:10+510,y:-21+147,tip:-4}}),e=function(){};this.showHoverTooltip=function(k){f.attr("class","surroundingAreaMapHoverOverlay pinHover"+k.getData("colorIndex"));return j.showHoverTooltip(k)};this.hideHoverTooltip=j.hideHoverTooltip;this.clear=j.clear;e()}});window.Century21.Setup.mapModule(function(d,b,a,c){a.MapTypeOverlay=function(e){var l=(this.constructor==a.MapTypeOverlay)?this:{},k=e,h=d("#bingMapTypeRoad"),m=d("#bingMapTypeAutomatic"),j=d("#bingMapTypeBE"),g=d("#bingMapTypeAerial"),i=function(n){n.preventDefault();n.data()},f=function(){var n=k.getMapTypeId();switch(n){case c.MapTypeId.road:l.setRoad();break;case c.MapTypeId.birdseye:l.setBirdsEye();break;case c.MapTypeId.Aerial:l.setAerial();break;default:l.setAutomatic();break}h.on("click",l.setRoad,i);m.on("click",l.clickAutomatic,i);j.on("click",l.setBirdsEye,i);g.on("click",l.setAerial,i)};l.setAutomatic=function(){k.setMapType(c.MapTypeId.auto);h.removeClass("selected").addClass("notSelected");m.addClass("selected").removeClass("notSelected");j.removeClass("selected").addClass("notSelected");g.removeClass("selected").addClass("notSelected")};l.clickAutomatic=function(){b.Track.doEvent("Hybrid Mapping","Tool Bar","Select Automatic Map View");l.setAutomatic()};l.setRoad=function(){b.Track.doEvent("Hybrid Mapping","Tool Bar","Select Road Map View");k.setMapType(c.MapTypeId.road);m.removeClass("selected").addClass("notSelected");h.addClass("selected").removeClass("notSelected");j.removeClass("selected").addClass("notSelected");g.removeClass("selected").addClass("notSelected")};l.setBirdsEye=function(){b.Track.doEvent("Hybrid Mapping","Tool Bar","Select Birds Eye Map View");k.setMapType(c.MapTypeId.birdseye);m.removeClass("selected").addClass("notSelected");h.removeClass("selected").addClass("notSelected");j.addClass("selected").removeClass("notSelected");g.removeClass("selected").addClass("notSelected")};l.setAerial=function(){b.Track.doEvent("Hybrid Mapping","Tool Bar","Select Aerial Map View");k.setMapType(c.MapTypeId.aerial);m.removeClass("selected").addClass("notSelected");h.removeClass("selected").addClass("notSelected");j.removeClass("selected").addClass("notSelected");g.addClass("selected").removeClass("notSelected")};f()}});window.Century21.Setup.mapModule(function(d,b,a,c){a.Paginator=function(i,f){var h=d("#pageSelector"),g=function(j,n){var o=h.get(0),l;h.empty();if(o.length==0){for(l=1;l<=j;l++){var m=document.createElement("option");m.text=l;m.value=l;if(n==l){m.selected=true}try{o.add(m,null)}catch(k){o.add(m)}}}},e=function(){g(i,f);h.change(function(){var k=h.val();if(d("body").hasClass("liquidLayout")){var j=d("#lqSearchType").val();if(j=="PROPERTIES"){Track.doEvent("Hybrid Mapping","Property Center Lane","Select Results Page",parseInt(k))}else{if(j=="AGENTS"){Track.doEvent("Hybrid Mapping","Agent Center Lane","Select Results Page",parseInt(k))}else{if(j=="OFFICES"){Track.doEvent("Hybrid Mapping","Office Center Lane","Select Results Page",parseInt(k))}}}}return b.portalResults.setPage(k,false)})};e()}});window.Century21.Setup.mapModule(function(d,b,a,c){a.AreaOverlayUi=function(){var g=this,h,i,f=d(".areaOverlay"),e=function(){f.click(function(){var j=d(this),k=j.hasClass("selected");if(k){j.removeClass("selected");i=j.attr("metaType");b.Track.doEvent("Hybrid Mapping","Heat Map Overlay Tool","Deselect "+i);i=null}else{f.removeClass("selected");j.addClass("selected");i=j.attr("metaType");b.Track.doEvent("Hybrid Mapping","Heat Map Overlay Tool","Select "+i)}if(h){h()}})};e();g.setClickEvent=function(j){h=j};g.getAreaOverlaySelection=function(){return i}}});window.Century21.Setup.mapModule(function(d,b,a,c){a.PaginatorButtons=function(){var f=this,h=d(".mapToolsArea .prevBtn"),g=d(".mapToolsArea .nextBtn"),i=0,e=function(){g.click(function(){if(g.hasClass("disabled")){return}b.Track.doEvent("Hybrid Mapping","Tool Bar","Select next button map paginator");b.portalResults.setPage(i+1,false)});h.click(function(){if(h.hasClass("disabled")){return}b.Track.doEvent("Hybrid Mapping","Tool Bar","Select previous button map paginator");b.portalResults.setPage(i-1,false)})};e();f.updatePaginatorButtons=function(){var l=d("#currentpage"),k=d("#maxpage"),j=parseInt(k.val(),10);i=parseInt(l.val(),10);if(i==j){g.addClass("disabled")}else{g.removeClass("disabled")}if(i==1){h.addClass("disabled")}else{h.removeClass("disabled")}}}});window.Century21.Setup.mapModule(function(d,b,a,c){a.Page=function(){var q=this,J,H,f=[],p=false,i=false,R=window.internationalization,s=function(){var W=d("#BodyLeftLane").height()-d("#currentSrBox").outerHeight()-d("#stdSearchFields").outerHeight()-parseInt(d("#morePropSearchOptionsSection").css("margin-top"))-parseInt(d("#morePropSearchOptionsSection").css("margin-bottom"));d("#morePropSearchOptionsSection").css("height",W+"px");d(".allOrNothing").each(function(Z,ab){var X=30;var Y=d("#BodyLeftLane").height()+d("#BodyLeftLane").offset().top-d("#refineFeaturesLink").height()-parseInt(d("#refineFeaturesLink").css("margin-top"))-X;var aa=d(ab);aa.removeClass("hideAllOrNothing");if(aa.offset().top+aa.height()>Y){aa.addClass("hideAllOrNothing")}else{aa.removeClass("hideAllOrNothing")}});var V=120;if(W<=V){d("#morePropSearchOptionsSection").hide();d("#refineFeaturesButton").show()}else{d("#morePropSearchOptionsSection").show();d("#refineFeaturesButton").hide()}},l=function(){var V=d("#LiquidBodySubsection").width(),W=d("#BodyCenterLane.fullList");W.find("#PropertyRowContainer > .propertyRow").width(V-36);W.width(V);s()},N=function(){var ab=d("#PropertyRowContainer"),V=ab.height(),Z=0,ac=V,Y=ab.children(".propertyRow"),W=d("#extendedListCountsTitle"),aa=W.is(":visible"),X=d();Y.each(function(ai,ag){var al=d(ag),af=al.height(),aj=al.position(),ah=aj.top,ad=ah+af,am=(ad<ac)&&(ad>Z),ae=(ah<ac)&&(ah>Z);if(am||ae){X=X.add(al.find("img.fullListMain"));if(aa){var ak=al.find(".photoFlow");ak.each(function(){var ap=d(this),aq=ap.find("img");if(aq.data("preloaded")==true){return}var ao=ap.parents(".propertyRow").find(".CardThumb img"),an=ao.attr("rel");aq.hover(function(){ao.attr("src",d(this).attr("src"))},function(){ao.attr("src",an)});if(ap.parent().position().top-ah<10){aq.data("preloaded",true);X=X.add(aq)}})}}});if(X.length>0){b.ImageLazyLoader.loadImages(X)}},j=function(){if(d("#listContainer").hasClass("propertyList")&&d("#BodyCenterLane").hasClass("fullList")){var V=d("#PropertyRowContainer"),W=V.children(".propertyRow");W.each(function(Z,X){var Y=d(X),ae="#"+Y.attr("id"),ab=d(ae+"propertyDescCollapse"),ac=d(ae+"propertyFeatures"),af=d(ae+"propertyDetailPhotos"),ag=af.children(".photoFlow"),aa=ag.children(".landscapeThumbContainer");if(ab.length>0){if(!ab.hasClass("collapsed")){var ad=ab.attr("expandLink");ab.addClass("collapsed");b.Collapsasaurus(ab,7,{expandText:"&hellip;"+R.getString("Read More"),expandURL:ad,expandCallback:function(){Track.doEvent("Hybrid Mapping","Property List View","Read More Description")}})}}ac.columns({width:200,height:110});aa.hover(function(){d(this).addClass("hover")},function(){d(this).removeClass("hover")});ag.last().addClass("last")})}},m=function(){if(d("#listContainer").hasClass("officeList")&&d("#BodyCenterLane").hasClass("fullList")){d(".officeProfile .paragraphsCollapse").each(function(){if(!d(this).hasClass("collapsed")){var V=d(this).find(".officeLink").val();d(this).addClass("collapsed");b.Collapsasaurus(d(this),5,{expandText:"&hellip;"+R.getString("Read More"),expandURL:V})}})}},K=function(){if(d("#listContainer").hasClass("agentList")&&d("#BodyCenterLane").hasClass("fullList")){d(".agentProfile .paragraphsCollapse").each(function(){if(!d(this).hasClass("collapsed")){var V=d(this).find(".agentLink").val();d(this).addClass("collapsed");b.Collapsasaurus(d(this),5,{expandText:"&hellip;"+R.getString("Read More"),expandURL:V})}})}},B=function(){i=true;var aa=d("#BodyCenterLane"),Z=d("#LiquidBodyMain"),Y=d("#listContainer"),X=aa.width(),ac=Z.width(),ab=function(){if(Y.hasClass("propertyList")){j()}else{if(Y.hasClass("officeList")){m()}else{if(Y.hasClass("agentList")){K()}}}};if(d.browser.msie&&d.browser.version<9){setTimeout(function(){aa.css({width:ac+X});ab()},400)}else{aa.animate({width:ac+X},{duration:400,easing:"easeOutQuad",complete:ab})}aa.addClass("fullList");Z.css({"z-index":-1});d("#extendedListCountsTitle").show();d("#FullListViewTopPagination").show();b.Track.doEvent("Hybrid Mapping","Collapse/Expand","Show List View");b.portalAjax.setCookie("LAST_LIST_VIEW","Open");N();var V=d("#PropertyRowContainer"),W=V.children(".propertyRow");W.each(function(ae,ag){var ah=d(ag),ai="#"+ah.attr("id"),af=d(ai+"propertyDetailPhotos"),aj=af.children(".photoFlow"),ad=aj.children().length;if(ad.length==0){d(ai+"propertyDescription").addClass("noImages")}});if(d.browser.msie&&d.browser.version<9){Z.css({opacity:0})}else{Z.animate({opacity:0},{duration:400,easing:"easeOutQuad",complete:function(){}})}l()},Q=function(V,Y){i=false;var X=d("#BodyCenterLane"),W=d("#LiquidBodyMain");d("#extendedListCountsTitle").hide();d("#FullListViewTopPagination").hide();b.Track.doEvent("Hybrid Mapping","Collapse/Expand","Hide List View");b.portalAjax.setCookie("LAST_LIST_VIEW","Closed");if(d.browser.msie&&d.browser.version<9){X.css({width:349});W.css({opacity:1})}else{X.animate({width:349},{duration:400,easing:"easeOutQuad"});W.animate({opacity:1},{duration:400,easing:"easeOutQuad"})}X.removeClass("fullList");d.when(X.promise(),W.promise()).then(function(){W.css({"z-index":""});if(!Y){J.fixAfterShow()}l();if(V){V()}})},L=function(){var Y=d("#panelToggleControl"),V=d("#fullListToggleControl"),aa=d("#BodyCenterLane"),W=d("#LiquidBodyMain"),ad=d("#listContainer"),ac=aa.width(),ab=W.width(),Z=W.position(),ae=this;var X=b.portalAjax.getCookie("LAST_LIST_VIEW");if(X=="Open"){B();z()}ad.on("click","#fullListHideToggleControl",function(){Q()});V.click(function(){B();z()});ae.open=function(){if(!Y.hasClass("opened")){return}if(!J.isSurroundingAreaViewSelected()){b.Track.doEvent("Hybrid Mapping","Collapse/Expand","Show Map View")}W.animate({width:ab+ac,left:Z.left-ac},{duration:400,easing:"easeOutQuad"});W.removeClass("mapNormal").addClass("mapLarge");Y.removeClass("opened").addClass("closed");V.hide();l()};ae.close=function(){if(Y.hasClass("opened")){return}if(!J.isSurroundingAreaViewSelected()){b.Track.doEvent("Hybrid Mapping","Collapse/Expand","Hide Map View")}W.animate({width:ab,left:Z.left},{duration:400,easing:"easeOutQuad"});W.removeClass("mapLarge").addClass("mapNormal");Y.removeClass("closed").addClass("opened");V.show();l()};Y.click(function(){if(Y.hasClass("opened")){ae.open()}else{ae.close()}})},D=function(){p=true;d.each(f,function(V,W){W()})},E=function(){var V=d("#searchWithinMap"),W=d("#searchWithinMapEnabled").val();if(window.disableSearchWithinMap){V.hide();d("#BodyRightLane .searchMap").hide()}if(W==="true"){V.attr("checked",true)}else{V.attr("checked",false)}if(d("#drawTool").hasClass("selected")){V.attr("checked",false);V.attr("disabled","disabled")}V.click(function(){var Y=d(this).attr("checked");if(Y){b.Track.doEvent("Hybrid Mapping","Search Within Map","Select");J.lockAutoZoomToPins();var X=d("#selectedSchoolIds").val();if(X!=null&&X!=""){b.SchoolSearch.showSchoolDeletionModal();return}b.SchoolSearch.clearSchoolSearchCriteria();b.SchoolSearch.closeWindow();b.portalResults.changeLiquidMapSearchWithinMapFacet();J.refreshSearchWithinMap()}else{b.Track.doEvent("Hybrid Mapping","Search Within Map","Deselect");J.unlockAutoZoomToPins();J.refreshLocationBoundaryMap();b.portalResults.removeLiquidMapSearchWithinMapFacet()}})},o=function(){c.loadModule("Microsoft.Maps.Overlays.Style",{callback:function(){var aa=d("#bingMap");var ah=new b.PortalParams(),X=ah.get("px"),Y,V,aj,Z,ai=false;if(X==""||X==null){ai=true}else{var af=X.split(","),ad=parseFloat(af[1],10),ag=parseFloat(af[0],10),ac=parseFloat(af[3],10),ae=parseFloat(af[2],10);if(isNaN(ad)||isNaN(ag)||isNaN(ac)||isNaN(ae)){ai=true}else{Y=new c.LocationRect.fromCorners(new c.Location(ad,ag),new c.Location(ac,ae));Z=true}}if(ai){var W=d("#searchLocationLatitude").val(),ab=d("#searchLocationLongitude").val();V=new c.Location(W,ab);aj=8;Z=false}J=new a.Map(aa,{bounds:Y,center:V,zoom:aj,lockAutoZoomToPins:Z});D();b.portalAjax.bindLoadEvent(d("#BodyRightLane"),function(){E()})}})},M=function(){d("#refineLanguageFeaturesButton").click(function(){var V=d("#lqSearchType").val();if(V=="AGENTS"){b.Track.doEvent("Hybrid Mapping","Left Lane","View Agent Language Options")}else{if(V=="OFFICES"){b.Track.doEvent("Hybrid Mapping","Left Lane","View Office Language Options")}}b.portalResults.loadLanguageSearchOptions()})},U=function(){d("#listContainer").removeClass("propertyList").addClass("agentList").removeClass("officeList");M();K();d("#ecoSiteFlyout").hide()},x=function(){d("#listContainer").removeClass("propertyList").removeClass("agentList").addClass("officeList");M();m();d("#ecoSiteFlyout").hide()},t=function(X){var V=d("#rightNavLiquidMap").data("count");var W=X.searchCount;if(W>V){y()}},T=function(){d("#listContainer").addClass("propertyList").removeClass("agentList").removeClass("officeList");j();var ad=d("#ecoSiteFlyout");var ac=false;if(ad.length>0&&d("#lqSearchType").val()=="PROPERTIES"&&((new PortalParams()).getParams().lid===(new PortalParams(true)).getParams().lid)){ac=true}else{d("#ecoSiteFlyout").hide(100)}if(ac&&!ad.hasClass("active")){var Z=ad.data("ecosite");d.support.cors=true;var ab="http://"+Z+"/idxsearchcount.c21?lid="+(new PortalParams(true)).getParams().lid;if(d.browser.msie&&parseInt(d.browser.version)<11){var Y=new XDomainRequest();Y.onprogress=function(){};Y.ontimeout=function(){};Y.onerror=function(){};Y.onload=function(){var ae=JSON.parse(Y.responseText);t(ae)};Y.timeout=10000;Y.open("get",ab);setTimeout(function(){Y.send()},0)}else{d.getJSON(ab,t)}ad.addClass("active")}var W=false;function X(){W=true}function V(){if(!W){return}setTimeout(function(){var ae=false,ag=d("#lqbedrooms, #lqbathrooms, #lqstructureSize"),af=d("#lqpriceFrom, #lqpriceTo");d.each(ag,function(ah,ai){var aj=d(ai);if(!aj.c21dropdown("hidden")){ae=true;return false}});if(ae){return}b.portalResults.updateLiquidFacets()},1000)}d("#lqbedrooms").c21dropdown({maxLength:2,tabIndex:402,onBlurAndChange:X,onBlur:V,dropdownClass:"lqdropdownCustomizations",selectBoxClass:"lqselectorCustomizations",baseName:"lqbedrooms"});d("#lqbathrooms").c21dropdown({maxLength:2,tabIndex:404,onBlurAndChange:X,onBlur:V,dropdownClass:"lqdropdownCustomizations",selectBoxClass:"lqselectorCustomizations",baseName:"lqbathrooms"});d("#lqstructureSize").c21dropdown({maxLength:7,tabIndex:406,onBlurAndChange:X,onBlur:V,dropdownClass:"lqdropdownCustomizations",selectBoxClass:"selectorSquareFeet",baseName:"lqstructureSize"});var aa={"":(window.websiteCode=="ESP"?"Todos":"Any"),"10000":"$10,000","20000":"$20,000","30000":"$30,000","50000":"$50,000","75000":"$75,000","100000":"$100,000","125000":"$125,000","150000":"$150,000","175000":"$175,000","200000":"$200,000","225000":"$225,000","250000":"$250,000","300000":"$300,000","350000":"$350,000","400000":"$400,000","450000":"$450,000","500000":"$500,000","600000":"$600,000","700000":"$700,000","800000":"$800,000","1000000":"$1,000,000","1250000":"$1,250,000","1500000":"$1,500,000","1750000":"$1,750,000","2000000":"$2,000,000","2500000":"$2,500,000","3000000":"$3,000,000"};d("#lqMinPriceHidden").c21boxdropdown(aa,{maxLength:7,tabIndex:400,onBlurAndChange:X,onBlur:V,dropdownClass:"lqPriceDropdown",selectBoxClass:"lqselectorCustomizations"});d("#lqMaxPriceHidden").c21boxdropdown(aa,{maxLength:7,tabIndex:400,onBlurAndChange:X,onBlur:V,dropdownClass:"lqPriceDropdown",selectBoxClass:"lqselectorCustomizations lqselectorCustomizationsPriceMax"});d("#lqbedrooms").c21dropdown("setValue",d("#lqMinBedHidden").val(),d("#lqMaxBedHidden").val());d("#lqbathrooms").c21dropdown("setValue",d("#lqMinBathHidden").val(),d("#lqMaxBathHidden").val());d("#lqstructureSize").c21dropdown("setValue",d("#lqMinSqftHidden").val(),d("#lqMaxSqftHidden").val());d("#refineFeaturesButton, #refineFeaturesLink").click(function(){b.Track.doEvent("Hybrid Mapping","Left Lane","View More Property Search Options");b.portalResults.loadMoreSearchOptions()});if(d("#schSearch").length===0){d("#refineSearch").addClass("noSchools")}if(d("#refineSearch").hasClass("noSchools")){d("#morePropSearchOptionsSection").removeClass("sch");d("#refineFeaturesButton").removeClass("sch")}s();setTimeout(s,200)},r=function(){var V=d("#seoFooterPanel");V.click(function(){if(V.hasClass("opened")){V.removeClass("opened").addClass("closed");d("#PageFooter").hide()}else{V.removeClass("closed").addClass("opened");d("#PageFooter").show()}});d(".expandoFooterContainer").each(function(aa,ab){var W=d(ab),Z=W.find("a"),Y=W.parent().find("div");if(Y!=null&&Y.length>0){Y.splice(-1,1)}if(Y.length>5){var X=Y.slice(-1*(Y.length-5)),ac=true;X.hide().find("a").css({color:"#f3f3f3"});W.show();Z.click(function(ad){ad.preventDefault();ac=!ac;if(ac){Z.text(b.Internationalization.getString("Show More"));Z.attr("title",b.Internationalization.getString("Show More"));X.find("a").animate({color:"#f3f3f3"},300);setTimeout(function(){X.slideUp()},300)}else{Z.text(b.Internationalization.getString("Hide"));Z.attr("title",b.Internationalization.getString("Hide"));X.slideDown(300);setTimeout(function(){X.find("a").animate({color:"#898989"},300,function(){d(this).css({color:""})})},300)}})}else{d(this).hide()}})},I=function(){d("#listContainer").animate({scrollTop:0},1000,"easeOutQuart");r();H.updatePaginatorButtons();if(d("#BodyCenterLane").hasClass("fullList")){d("#extendedListCountsTitle").show();d("#FullListViewTopPagination").show()}else{d("#FullListViewTopPagination").hide()}N();j();m();K();var V=d("#lqSearchType").val();if(V==="AGENTS"){O()}},g=function(){if(window.disableSurroundingAreas){d("#surroundingAreasLiqMap").hide();return}b.SurroundingAreasMapping.initialize()},F=function(){b.SchoolSearch.initialize()},G=function(){if(window.disableHeatMap){d("#areaOverlaysDiv .mapToolTitle").html("");d("#areaOverlaysDiv .mapToolTitle").css("height","16px");d("#bottomMapToolsDropDown .areaOverlayOptions").hide()}},k=function(){if(window.disablePointsOfInterest){d("#pointsOfInterestDiv .mapToolTitle").html("");d("#pointsOfInterestDiv .mapToolTitle").css("height","16px");d("#bottomMapToolsDropDown #pointsOfInterestLeftDiv").hide();d("#bottomMapToolsDropDown #pointsOfInterestRightDiv").hide()}},S=function(){if(window.disableDrawTool){d("#drawTool").css("visibility","hidden")}},P=function(){if(window.disableHeatMap&&window.disablePointsOfInterest){d("#bottomMapTools").css("visibility","hidden")}if(window.databaseAvailable&&(window.sessionAvailable||(!window.sessionAvailable&&window.sessionAuthenticated))){d("#myPlacesTool").show()}else{d("#myPlacesTool").css("visibility","hidden")}var Y=false,Z=300,V=d(".mapToolsArea .panelToggleButton"),W=d(".mapToolsArea"),X=d("#bottomMapToolsDropDown"),aa=function(ab){d("#bottomMapToolsDropDown").hide();ab.show()};V.click(function(){if(Y){return}d("#myPlacesToolInstructions").removeClass("active");var ac=d(this),ad=ac.hasClass("selected"),ab=ac.attr("href"),ae=d(ab);Y=true;V.removeClass("selected");if(ad){b.Track.doEvent("Hybrid Mapping","Tool Bar","Collapse");X.slideUp(Z,function(){Y=false});W.animate({bottom:0},Z)}else{b.Track.doEvent("Hybrid Mapping","Tool Bar","Expand");V.removeClass("selected");ac.addClass("selected");X.slideDown(Z,function(){aa(ae);Y=false});W.animate({bottom:160},Z)}if(!d("#bottomMapTools").hasClass("selected")){d(".overlayToolTip").hide();d(".overlayToolTip").removeClass("shown")}})},v=function(Z){var ab=Z.split(","),W=[],V,ac,aa,X,Y=false;for(X=0;X<ab.length;X=X+2){ac=parseFloat(ab[X+1],10);aa=parseFloat(ab[X],10);if(isNaN(ac)||isNaN(aa)){return false}V=new c.Location(ac,aa);W.push(V)}V=new c.Location(ab[1],ab[0]);W.push(V);return W},e=function(){var W=new b.PortalParams(),X=W.get("dt");if(X!=null){var V=v(X);if(V===false){return}J.addLassoPoly(V)}},u=function(){var ag=d("#currentSearch"),ab=d(".currentSrBox"),X=ab.find(".LaneTitle"),Y=ag.find(".LaneText"),af=d(".currentSearchSlider"),W=100,ac=10,V=Y.height()+(ac*2),Z=V>W,ai=X.height(),ae=W+ai,ah=V+ai,ad=false;af.toggle(Z);ab.off(".initRefinement").css("height","");if(!Z){return}ab.css({height:ae});function aa(){ad=true;setTimeout(function(){ad=false},500)}function aj(){if(ab.hasClass("expanded")){ab.trigger("mouseleave.initRefinement")}else{ab.trigger("mouseenter.initRefinement")}}af.click(aj);ab.on({"touchstart.initRefinement":function(ak){if(d(ak.target).prop("tagName")==="A"){return}aj();aa()},"click.initRefinement":function(ak){if(d(ak.target).prop("tagName")==="A"){return}aj()},"mouseenter.initRefinement":function(){var ak;if(ad){return}ab.stop(true).animate({height:ah}).addClass("expanded");ag.css({maxHeight:99999});ak=ah-ae;b.SchoolSearch.updateTooltipPosition(ak);b.SurroundingAreasMapping.updateTooltipPosition(ak)},"mouseleave.initRefinement":function(){if(ad){return}ab.stop(true).animate({height:ae}).removeClass("expanded");b.SchoolSearch.updateTooltipPosition(0);b.SurroundingAreasMapping.updateTooltipPosition(0)}})},O=function(){d(".CenterLaneCardBg.CardWrapper").each(function(V,W){var Y=d(this),X=Y.parent();X.hover(function(){Y.addClass("hover")},function(){Y.removeClass("hover")})});if(J){J.refreshLocationBoundaryMap()}},y=function(){var W=d("#ecoSiteFlyout"),Y=d("#ecoSiteFlyout .moreListings"),X=d("#ecoSiteFlyout .searchListings"),V=305,Z=40,aa=500;if(!W.hasClass("closed")){return}W.show(100);setTimeout(function(){W.stop(true).animate({width:V},{duration:aa,specialEasing:{width:"linear",height:"easeOutCubic"}});W.addClass("opened");W.removeClass("closed")},500)},z=function(){var W=d("#ecoSiteFlyout"),Y=d("#ecoSiteFlyout .moreListings"),X=d("#ecoSiteFlyout .searchListings"),V=305,Z=40,aa=500;W.stop(true).animate({width:Z},{duration:aa,specialEasing:{width:"linear",height:"easeInCubic"}});W.addClass("closed");W.removeClass("opened")},h=function(){var V=d("#ecoSiteFlyout"),X=d("#ecoSiteFlyout .moreListings"),W=d("#ecoSiteFlyout .searchListings");X.click(function(){if(V.hasClass("closed")){y()}else{z()}})},w,C=function(){d("#areaOverlayAge, #areaOverlayPrice, #areaOverlayIncome").hover(function(){d(this).addClass("hover")},function(){d(this).removeClass("hover")});d("#pointsOfInterestDiv").find(".pointOfInterestCheckbox").uniform();H=new a.PaginatorButtons();w=new L();o();P();k();G();S();h();H.updatePaginatorButtons();var ab=d("#mapToolTip"),V=d("#mapToolTipText"),Z=d("#drawingToolInstructions"),Y=d("#myPlacesToolInstructions"),X=d("#bottomMapToolsDropDown"),aa=d("#bottomMapTools");aa.click(function(){Z.removeClass("active");Y.removeClass("active")});d("#myPlacesTool").hover(function(){Z.removeClass("active");if(!d(this).hasClass("selected")){V.text(b.Internationalization.getString("MY PLACES"));ab.show().css({bottom:56+(X.is(":visible")?160:0),left:-93,width:94})}else{Y.addClass("active").css("bottom",56+(d("#bottomMapToolsDropDown").is(":visible")?160:0))}},function(){ab.hide()});d("#drawTool").hover(function(){if(!Z.hasClass("active")){Y.removeClass("active");V.text(b.Internationalization.getString("DRAWING TOOL"));ab.show().css({bottom:56+(X.is(":visible")?160:0),left:-66,width:94})}},function(){ab.hide()});d("#prevBtn").hover(function(){Z.removeClass("active");Y.removeClass("active");V.text(b.Internationalization.getString("PREVIOUS PAGE"));ab.show().css({bottom:56+(X.is(":visible")?160:0),left:-43,width:100})},function(){ab.hide()});d("#nextBtn").hover(function(){Z.removeClass("active");Y.removeClass("active");V.text(b.Internationalization.getString("NEXT PAGE"));ab.show().css({bottom:56+(X.is(":visible")?160:0),left:-8,width:76})},function(){ab.hide()});var W=d("#refineSearch");b.portalAjax.bindLoadEvent(W,function(){u();F();g();setTimeout(function(){var ac=d("#lqSearchType").val();if(ac==="PROPERTIES"){T()}else{if(ac==="AGENTS"){U()}else{if(ac==="OFFICES"){x()}}}O()},10)});b.portalAjax.bindLoadEvent(d("#BodyCenterLane, #listContainer"),I);d(window).resize(N);d("#listContainer").scroll(N);d(document.body).click(function(){J.unlockAutoZoomToPins()})},A=function(){var Z=window.responsiveMode.getMode(),W=portalAjax.getParameters(),V=parseInt(W.v),Y,X;if((V!==0)&&(Z===1)){W.v=0;Y=d.param(W);X=[location.protocol,"//",location.host,location.pathname,"?",Y].join("");window.location.href=X;return true}else{return false}},n=function(){if(A()){return}d(document).ready(C);d(window).resize(l);q.onReady(e)};q.closeCenterLane=function(V,W){if(i){Q(function(){w.open();if(V){V()}},W)}else{w.open();if(V){V()}}};q.openCenterLane=function(){w.close()};q.getMap=function(){return J};q.onReady=function(V){if(p){V()}else{f.push(V)}};n()}});